define("services/catchmentService",["app","services/getHttpService","services/globalService"],function(a){a.config(["$httpProvider",function(a){"use strict";delete a.defaults.headers.common["X-Requested-With"]}]).factory("CatchmentService",["$http","GlobalService","GetHttpService",function(a,b,c){"use strict";var d={"Content-Type":"application/json"},e=b.getAPIURL("data/v1/entity/user/catchment"),f=function(b,c,f,g,h,i){var j,k,l={},m="POST";if(!angular.isString(c)||!c.trim())return{status:"error",msg:"Please provide a valid name"};if(!f||!f.length)return{status:"error",msg:"Please include a project to create a valid catchment"};if(b)for(m="PUT",l.id=b,l.name=c.trim(),l.catchmentProjects=[],j=0,k=f.length;k>j;j++)l.catchmentProjects.push({projectId:f[j]});else for(l.name=c.trim(),l.catchmentProjects=[],j=0,k=f.length;k>j;j++)l.catchmentProjects.push({projectId:f[j]});l.status=g?g:"Active",h&&_.isObject(h)&&(l.metaAttributes=h),a({method:m,url:e,data:l,headers:d}).then(function(a){i(a)})},g=function(a,c){var d="data/v1/entity/user/catchment?filters=id=="+a;return b.makeGetCall(d,"application/json",!0,!0).then(function(a){200===a.status&&c(a.data.data)})},h=function(a,c,d,e){var f="";f+="?sort=-id",a&&(f+="&rows="+a,f+=c?"&start="+c:"&start=0"),d&&(f+="&filters=status=="+d);var g="data/v1/entity/user/catchment"+f;return b.makeGetCall(g,"application/json",!0,!0).then(function(a){200===a.status&&e(a.data.data)})};return{updateCatchment:f,getCatchment:g,getAllCatchment:h}}])}),define("text!views/directives/filters/budget.html",[],function(){return'<div class="dropdown-toggle searchDropInfo">\n    <span data-ng-if=\'filter.active\' ng-bind-html="filter.tempLabel">\n    </span>\n    <span data-ng-if=\'!filter.active\'> {{filter.label}} </span>\n    <i class="pt pt-icon-angle-down iconArrow" data-ng-if=\'filter.dropdown\'></i>\n</div>\n<div data-ga-event="gaEvent" pt-rangemanager data-ga-category="gaCategory" filter="filter"></div>'}),define("text!views/directives/common/pt-rangemanager.html",[],function(){return'<ul class="rightTopClick" ng-click="$event.stopPropagation()" data-ng-class="{\'clickListInfo\' : filter.dropdown, \'disable\' : filter.fromurl}">\n    <li>\n        <div class="dualBoxInfo">\n            <div class="budgetBoxInfo">\n                <i data-ng-if="filter.key == \'primaryOrResaleBudget\'" class="pt pt-icon-inr"></i>\n                <input ng-readonly="filter.fromurl" data-ng-model="filter.tmpFrom" data-ng-keyup="onMinValueEnter(filter.tmpFrom, $event)" data-ng-focus="showMaxRange=false" type="text" placeholder="Min">\n            </div>\n            <div class="budgetLineInfo">&nbsp;</div>\n            <div class="budgetBoxInfo">\n                <i data-ng-if="filter.key == \'primaryOrResaleBudget\'" class="pt pt-icon-inr"></i>\n                <input ng-readonly="filter.fromurl" data-ng-model="filter.tmpTo" ng-keydown="sendRequest($event)" data-ng-keyup="onMaxValueEnter(filter.tmpTo, $event)" data-ng-focus="showMax()" type="text" placeholder="Max">\n            </div>\n        </div>\n        <div class="dualBoxInfo switContInfo">\n            <div class="switDataContInfo minContInfo" data-ng-class="{\'selected\': !showMaxRange}">\n                <div class="switRowContInfo"\n                     data-ng-click="minRangeSelected(item.value)"\n                     data-ng-class="{\'active\' : item.value==from}"\n                     data-ng-repeat="item in filter.range.min">\n                    <i data-ng-if="filter.key == \'primaryOrResaleBudget\'" class="pt pt-icon-inr"></i> {{item.value | priceFormat : null:null:\' L\':null:2}}</div>\n            </div>\n            <div class="switDataContInfo maxContInfo" data-ng-class="{\'selected\': showMaxRange}">\n                <div class="switRowContInfo"\n                     data-ng-class="{\'active\' : item.value==to}"\n                     data-ng-click="maxRangeSelected(item.value)"\n                     data-ng-repeat="item in filter.range.max">\n                    <div ng-if="item.value != \'Any\'">\n                        <i data-ng-if="filter.key == \'primaryOrResaleBudget\'" class="pt pt-icon-inr"></i>\n                        {{item.value | priceFormat : null:null:\' L\':null:2}}\n                    </div>\n                    <div ng-if="item.value == \'Any\'">{{item.value}}</div>\n                </div>\n            </div>\n        </div>\n    </li>\n</ul>\n'}),define("directives/common/pt-rangemanager",["app","text!views/directives/common/pt-rangemanager.html","formatters/common"],function(a,b){a.directive("ptRangemanager",["$timeout","GoogleAnalyticsService",function(a,c){return{restrict:"A",template:b,scope:{filter:"=",gaCategory:"=",gaEvent:"="},controller:["$scope","$rootScope","Formatter",function(b,d,e){b.showMax=function(){b.filter.fromurl||(b.showMaxRange=!0)},b.disabled=!0,b.from=b.filter.from,b.to=b.filter.to,b.amountAny=!1,b.amountZero=!1,b.$on("budgetFilterReset",function(){b.from=b.filter.from,b.to=b.filter.to});var f=function(a,b){switch(a){case 75:b=b.replace(/[k|K]/,"000");break;case 76:b=b.replace(/[l|L]/,"00000");break;case 67:b=b.replace(/[c|C]/,"0000000")}return b};b.onMinValueEnter=function(c,g){b.filter.fromurl||(b.amountZero=0==c?!0:!1,g&&(c=f(g.keyCode,c)),0!==c&&""!==c&&(c=parseInt(c.toString().split(",").join(""))),0===c?(b.filter.from="0",b.filter.tmpFrom="0"):isNaN(c)?(b.filter.from="",b.filter.tmpFrom="",b.filter.active=!0):(b.filter.from=""==c?"":parseInt(c.toString().split(",").join("")),b.filter.tmpFrom=e.formatPriceWithComma(b.filter.from),""!=b.filter.to&&parseInt(b.filter.from)>parseInt(b.filter.to)&&b.onMaxValueEnter("Any",!0)),d.$broadcast("minRangeSelected",b.filter)),g&&13==g.keyCode&&a(function(){angular.element('input[data-ng-model="filter.tmpTo"]').focus(),b.showMaxRange=!0})},b.onMaxValueEnter=function(a,g){b.filter.fromurl||("Any"==a?(b.amountAny=!0,b.filter.amountAny=!0):(b.amountAny=!1,b.filter.amountAny=!1),g&&g.keyCode&&(a=f(g.keyCode,a)),"Any"!==a&&""!==a&&(a=parseInt(a.toString().split(",").join(""))),"Any"===a?(b.filter.to="",b.filter.tmpTo="Any"):isNaN(a)&&""!=a?(b.filter.to="",b.filter.tmpTo="",b.filter.active=!0):(b.filter.to=""==a?"":parseInt(a.toString().split(",").join("")),b.filter.tmpTo=e.formatPriceWithComma(b.filter.to)),d.$broadcast("maxRangeSelected",b.filter)),g||(""!==b.filter.to&&parseInt(b.filter.from)>parseInt(b.filter.to)&&b.onMaxValueEnter("Any"),b.applyFilter()),c.gaEventSelectPropertyType(b.filter,b.gaCategory,b.gaEvent)},b.minRangeSelected=function(c){b.filter.fromurl||a(function(){angular.element('input[data-ng-model="filter.tmpTo"]').focus(),b.showMaxRange=!0,b.onMinValueEnter(c)})},b.maxRangeSelected=function(a){b.filter.fromurl||b.onMaxValueEnter(a)},b.applyFilter=function(){b.filter.to==b.to&&b.filter.from==b.from||!(b.filter.tmpTo||b.filter.tmpFrom||b.amountAny||b.amountZero)||(b.filter.active=!1,b.filter.scrollAmount=!1,a(function(){angular.element(".flitClickInfo.open").length>0&&$(document).trigger("click")}),b.from=b.filter.from,b.to=b.filter.to,b.disabled=!0,b.amountAny=!1,b.amountZero=!1,d.$broadcast("filterChanged",null,b.filter),b.showMaxRange=!1)},b.sendRequest=function(a){(9==a.keyCode||13==a.keyCode)&&(""!==b.filter.to&&parseInt(b.filter.from)>parseInt(b.filter.to)&&b.onMaxValueEnter("Any"),b.applyFilter())}}]}}])}),define("directives/filters/budget",["app","text!views/directives/filters/budget.html","directives/common/pt-rangemanager"],function(a,b){a.directive("budget",["$rootScope","$location",function(a,c){return{restrict:"A",scope:{filter:"=",gaCategory:"@?",gaEvent:"@?"},template:b}}])}),!function(deparam){if("function"==typeof require&&"object"==typeof exports&&"object"==typeof module){var jquery=require("jquery");module.exports=deparam(jquery)}else if("function"==typeof define&&define.amd)define("jqueryDeParam",["jquery"],function(a){return deparam(a)});else{var global=eval("this");global.deparam=deparam(jQuery)}}(function(a){return function(b,c){var d={},e={"true":!0,"false":!1,"null":null};return a.each(b.replace(/\+/g," ").split("&"),function(b,f){var g,h=f.split("="),i=decodeURIComponent(h[0]),j=d,k=0,l=i.split("]["),m=l.length-1;if(/\[/.test(l[0])&&/\]$/.test(l[m])?(l[m]=l[m].replace(/\]$/,""),l=l.shift().split("[").concat(l),m=l.length-1):m=0,2===h.length)if(g=decodeURIComponent(h[1]),c&&(g=g&&!isNaN(g)?+g:"undefined"===g?void 0:void 0!==e[g]?e[g]:g),m)for(;m>=k;k++)i=""===l[k]?j.length:l[k],j=j[i]=m>k?j[i]||(l[k+1]&&isNaN(l[k+1])?{}:[]):g;else a.isArray(d[i])?d[i].push(g):void 0!==d[i]?d[i]=[d[i],g]:d[i]=g;else i&&(d[i]=c?void 0:"")}),d}}),function(a,b){function c(b,c){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,b.href&&f&&"map"===e.nodeName.toLowerCase()?(g=a("img[usemap=#"+f+"]")[0],!!g&&d(g)):!1):(/input|select|textarea|button|object/.test(h)?!b.disabled:"a"===h?b.href||c:c)&&d(b)}function d(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}var e=0,f=/^ui-id-\d+$/;a.ui=a.ui||{},a.extend(a.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({focus:function(b){return function(c,d){return"number"==typeof c?this.each(function(){var b=this;setTimeout(function(){a(b).focus(),d&&d.call(b)},c)}):b.apply(this,arguments)}}(a.fn.focus),scrollParent:function(){var b;return b=a.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.css(this,"position"))&&/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length)for(var d,e,f=a(this[0]);f.length&&f[0]!==document;){if(d=f.css("position"),("absolute"===d||"relative"===d||"fixed"===d)&&(e=parseInt(f.css("zIndex"),10),!isNaN(e)&&0!==e))return e;f=f.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})},removeUniqueId:function(){return this.each(function(){f.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),e&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var f="Width"===d?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return"number"!=typeof b?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),a.support.selectstart="onselectstart"in document.createElement("div"),a.fn.extend({disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c){var d,e=a.plugins[b];if(e&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(d=0;e.length>d;d++)a.options[e[d][0]]&&e[d][1].apply(a.element,c)}},hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)}})}(jQuery),define("jqueryCore",["jquery"],function(){}),function(a,b){var c=0,d=Array.prototype.slice,e=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(f){}e(b)},a.widget=function(c,d,e){var f,g,h,i,j={},k=c.split(".")[0];c=c.split(".")[1],f=k+"-"+c,e||(e=d,d=a.Widget),a.expr[":"][f.toLowerCase()]=function(b){return!!a.data(b,f)},a[k]=a[k]||{},g=a[k][c],h=a[k][c]=function(a,c){return this._createWidget?(arguments.length&&this._createWidget(a,c),b):new h(a,c)},a.extend(h,g,{version:e.version,_proto:a.extend({},e),_childConstructors:[]}),i=new d,i.options=a.widget.extend({},i.options),a.each(e,function(c,e){return a.isFunction(e)?(j[c]=function(){var a=function(){return d.prototype[c].apply(this,arguments)},b=function(a){return d.prototype[c].apply(this,a)};return function(){var c,d=this._super,f=this._superApply;return this._super=a,this._superApply=b,c=e.apply(this,arguments),this._super=d,this._superApply=f,c}}(),b):(j[c]=e,b)}),h.prototype=a.widget.extend(i,{widgetEventPrefix:g?i.widgetEventPrefix||c:c},j,{constructor:h,namespace:k,widgetName:c,widgetFullName:f}),g?(a.each(g._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,h,c._proto)}),delete g._childConstructors):d._childConstructors.push(h),a.widget.bridge(c,h)},a.widget.extend=function(c){for(var e,f,g=d.call(arguments,1),h=0,i=g.length;i>h;h++)for(e in g[h])f=g[h][e],g[h].hasOwnProperty(e)&&f!==b&&(c[e]=a.isPlainObject(f)?a.isPlainObject(c[e])?a.widget.extend({},c[e],f):a.widget.extend({},f):f);return c},a.widget.bridge=function(c,e){var f=e.prototype.widgetFullName||c;a.fn[c]=function(g){var h="string"==typeof g,i=d.call(arguments,1),j=this;return g=!h&&i.length?a.widget.extend.apply(null,[g].concat(i)):g,h?this.each(function(){var d,e=a.data(this,f);return e?a.isFunction(e[g])&&"_"!==g.charAt(0)?(d=e[g].apply(e,i),d!==e&&d!==b?(j=d&&d.jquery?j.pushStack(d.get()):d,!1):b):a.error("no such method '"+g+"' for "+c+" widget instance"):a.error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+g+"'")}):this.each(function(){var b=a.data(this,f);b?b.option(g||{})._init():a.data(this,f,new e(g,this))}),j}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e,f,g,h=c;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof c)if(h={},e=c.split("."),c=e.shift(),e.length){for(f=h[c]=a.widget.extend({},this.options[c]),g=0;e.length-1>g;g++)f[e[g]]=f[e[g]]||{},f=f[e[g]];if(c=e.pop(),1===arguments.length)return f[c]===b?null:f[c];f[c]=d}else{if(1===arguments.length)return this.options[c]===b?null:this.options[c];h[c]=d}return this._setOptions(h),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(c,d,e){var f,g=this;"boolean"!=typeof c&&(e=d,d=c,c=!1),e?(d=f=a(d),this.bindings=this.bindings.add(d)):(e=d,d=this.element,f=this.widget()),a.each(e,function(e,h){function i(){return c||g.options.disabled!==!0&&!a(this).hasClass("ui-state-disabled")?("string"==typeof h?g[h]:h).apply(g,arguments):b}"string"!=typeof h&&(i.guid=h.guid=h.guid||i.guid||a.guid++);var j=e.match(/^(\w+)\s*(.*)$/),k=j[1]+g.eventNamespace,l=j[2];l?f.delegate(l,k,i):d.bind(k,i)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.unbind(b).undelegate(b)},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.apply(this.element[0],[c].concat(d))===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?e===!0||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}})}(jQuery),define("jqueryUIWidget",["jqueryCore"],function(){}),function(a){var b=!1;a(document).mouseup(function(){b=!1}),a.widget("ui.mouse",{version:"1.10.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){return!0===a.data(c.target,b.widgetName+".preventClickEvent")?(a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(c){if(!b){this._mouseStarted&&this._mouseUp(c),this._mouseDownEvent=c;var d=this,e=1===c.which,f="string"==typeof this.options.cancel&&c.target.nodeName?a(c.target).closest(this.options.cancel).length:!1;return e&&!f&&this._mouseCapture(c)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&(this._mouseStarted=this._mouseStart(c)!==!1,!this._mouseStarted)?(c.preventDefault(),!0):(!0===a.data(c.target,this.widgetName+".preventClickEvent")&&a.removeData(c.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),c.preventDefault(),b=!0,!0)):!0}},_mouseMove:function(b){return a.ui.ie&&(!document.documentMode||9>document.documentMode)&&!b.button?this._mouseUp(b):this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted)},_mouseUp:function(b){return a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),define("jqueryUIMouse",["jqueryUIWidget"],function(){}),function(a){var b=5;a.widget("ui.slider",a.ui.mouse,{version:"1.10.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var b,c,d=this.options,e=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),f="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",g=[];for(c=d.values&&d.values.length||1,e.length>c&&(e.slice(c).remove(),e=e.slice(0,c)),b=e.length;c>b;b++)g.push(f);this.handles=e.add(a(g.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(b){a(this).data("ui-slider-handle-index",b)})},_createRange:function(){var b=this.options,c="";b.range?(b.range===!0&&(b.values?b.values.length&&2!==b.values.length?b.values=[b.values[0],b.values[0]]:a.isArray(b.values)&&(b.values=b.values.slice(0)):b.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=a("<div></div>").appendTo(this.element),c="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(c+("min"===b.range||"max"===b.range?" ui-slider-range-"+b.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){var a=this.handles.add(this.range).filter("a");this._off(a),this._on(a,this._handleEvents),this._hoverable(a),this._focusable(a)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(b){var c,d,e,f,g,h,i,j,k=this,l=this.options;return l.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),c={x:b.pageX,y:b.pageY},d=this._normValueFromMouse(c),e=this._valueMax()-this._valueMin()+1,this.handles.each(function(b){var c=Math.abs(d-k.values(b));(e>c||e===c&&(b===k._lastChangedValue||k.values(b)===l.min))&&(e=c,f=a(this),g=b)}),h=this._start(b,g),h===!1?!1:(this._mouseSliding=!0,this._handleIndex=g,f.addClass("ui-state-active").focus(),i=f.offset(),j=!a(b.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=j?{left:0,top:0}:{left:b.pageX-i.left-f.width()/2,top:b.pageY-i.top-f.height()/2-(parseInt(f.css("borderTopWidth"),10)||0)-(parseInt(f.css("borderBottomWidth"),10)||0)+(parseInt(f.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(b,g,d),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(a){var b={x:a.pageX,y:a.pageY},c=this._normValueFromMouse(b);return this._slide(a,this._handleIndex,c),!1},_mouseStop:function(a){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(a){var b,c,d,e,f;return"horizontal"===this.orientation?(b=this.elementSize.width,c=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,c=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),d=c/b,d>1&&(d=1),0>d&&(d=0),"vertical"===this.orientation&&(d=1-d),e=this._valueMax()-this._valueMin(),f=this._valueMin()+d*e,this._trimAlignValue(f)},_start:function(a,b){var c={handle:this.handles[b],value:this.value()};return this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("start",a,c)},_slide:function(a,b,c){var d,e,f;this.options.values&&this.options.values.length?(d=this.values(b?0:1),2===this.options.values.length&&this.options.range===!0&&(0===b&&c>d||1===b&&d>c)&&(c=d),c!==this.values(b)&&(e=this.values(),e[b]=c,f=this._trigger("slide",a,{handle:this.handles[b],value:c,values:e}),d=this.values(b?0:1),f!==!1&&this.values(b,c))):c!==this.value()&&(f=this._trigger("slide",a,{handle:this.handles[b],value:c}),f!==!1&&this.value(c))},_stop:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("stop",a,c)},_change:function(a,b){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._lastChangedValue=b,this._trigger("change",a,c)}},value:function(a){return arguments.length?(this.options.value=this._trimAlignValue(a),this._refreshValue(),void this._change(null,0)):this._value()},values:function(b,c){var d,e,f;if(arguments.length>1)return this.options.values[b]=this._trimAlignValue(c),this._refreshValue(),void this._change(null,b);if(!arguments.length)return this._values();if(!a.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(b):this.value();for(d=this.options.values,e=arguments[0],f=0;d.length>f;f+=1)d[f]=this._trimAlignValue(e[f]),this._change(null,f);this._refreshValue()},_setOption:function(b,c){var d,e=0;switch("range"===b&&this.options.range===!0&&("min"===c?(this.options.value=this._values(0),this.options.values=null):"max"===c&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),a.isArray(this.options.values)&&(e=this.options.values.length),a.Widget.prototype._setOption.apply(this,arguments),b){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),d=0;e>d;d+=1)this._change(null,d);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a)},_values:function(a){var b,c,d;if(arguments.length)return b=this.options.values[a],b=this._trimAlignValue(b);if(this.options.values&&this.options.values.length){for(c=this.options.values.slice(),d=0;c.length>d;d+=1)c[d]=this._trimAlignValue(c[d]);return c}return[]},_trimAlignValue:function(a){if(this._valueMin()>=a)return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=this.options.step>0?this.options.step:1,c=(a-this._valueMin())%b,d=a-c;return 2*Math.abs(c)>=b&&(d+=c>0?b:-b),parseFloat(d.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var b,c,d,e,f,g=this.options.range,h=this.options,i=this,j=this._animateOff?!1:h.animate,k={};this.options.values&&this.options.values.length?this.handles.each(function(d){c=100*((i.values(d)-i._valueMin())/(i._valueMax()-i._valueMin())),k["horizontal"===i.orientation?"left":"bottom"]=c+"%",a(this).stop(1,1)[j?"animate":"css"](k,h.animate),i.options.range===!0&&("horizontal"===i.orientation?(0===d&&i.range.stop(1,1)[j?"animate":"css"]({left:c+"%"},h.animate),1===d&&i.range[j?"animate":"css"]({width:c-b+"%"},{queue:!1,duration:h.animate})):(0===d&&i.range.stop(1,1)[j?"animate":"css"]({bottom:c+"%"},h.animate),1===d&&i.range[j?"animate":"css"]({height:c-b+"%"},{queue:!1,duration:h.animate}))),b=c}):(d=this.value(),e=this._valueMin(),f=this._valueMax(),c=f!==e?100*((d-e)/(f-e)):0,k["horizontal"===this.orientation?"left":"bottom"]=c+"%",this.handle.stop(1,1)[j?"animate":"css"](k,h.animate),"min"===g&&"horizontal"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({width:c+"%"},h.animate),"max"===g&&"horizontal"===this.orientation&&this.range[j?"animate":"css"]({width:100-c+"%"},{queue:!1,duration:h.animate}),"min"===g&&"vertical"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({height:c+"%"},h.animate),"max"===g&&"vertical"===this.orientation&&this.range[j?"animate":"css"]({height:100-c+"%"},{queue:!1,duration:h.animate}))},_handleEvents:{keydown:function(c){var d,e,f,g,h=a(c.target).data("ui-slider-handle-index");switch(c.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(c.preventDefault(),!this._keySliding&&(this._keySliding=!0,a(c.target).addClass("ui-state-active"),d=this._start(c,h),d===!1))return}switch(g=this.options.step,e=f=this.options.values&&this.options.values.length?this.values(h):this.value(),c.keyCode){case a.ui.keyCode.HOME:f=this._valueMin();break;case a.ui.keyCode.END:f=this._valueMax();break;case a.ui.keyCode.PAGE_UP:f=this._trimAlignValue(e+(this._valueMax()-this._valueMin())/b);break;case a.ui.keyCode.PAGE_DOWN:f=this._trimAlignValue(e-(this._valueMax()-this._valueMin())/b);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(e===this._valueMax())return;f=this._trimAlignValue(e+g);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(e===this._valueMin())return;f=this._trimAlignValue(e-g)}this._slide(c,h,f)},click:function(a){a.preventDefault()},keyup:function(b){var c=a(b.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(b,c),this._change(b,c),
a(b.target).removeClass("ui-state-active"))}}})}(jQuery),define("jqueryUISlider",["jqueryUIMouse"],function(){}),function(a){a.widget("ui.draggable",a.ui.mouse,{version:"1.10.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(b){var c=this.options;return this.helper||c.disabled||a(b.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(b),this.handle?(a(c.iframeFix===!0?"iframe":c.iframeFix).each(function(){a("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(a(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(b){var c=this.options;return this.helper=this._createHelper(b),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),this._setContainment(),this._trigger("start",b)===!1?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_mouseDrag:function(b,c){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),!c){var d=this._uiHash();if(this._trigger("drag",b,d)===!1)return this._mouseUp({}),!1;this.position=d.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var c=this,d=!1;return a.ui.ddmanager&&!this.options.dropBehaviour&&(d=a.ui.ddmanager.drop(this,b)),this.dropped&&(d=this.dropped,this.dropped=!1),"original"!==this.options.helper||a.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!d||"valid"===this.options.revert&&d||this.options.revert===!0||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)?a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){c._trigger("stop",b)!==!1&&c._clear()}):this._trigger("stop",b)!==!1&&this._clear(),!1):!1},_mouseUp:function(b){return a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){return this.options.handle?!!a(b.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b])):"clone"===c.helper?this.element.clone().removeAttr("id"):this.element;return d.parents("body").length||d.appendTo("parent"===c.appendTo?this.element[0].parentNode:c.appendTo),d[0]===this.element[0]||/(fixed|absolute)/.test(d.css("position"))||d.css("position","absolute"),d},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options;return e.containment?"window"===e.containment?void(this.containment=[a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,a(window).scrollLeft()+a(window).width()-this.helperProportions.width-this.margins.left,a(window).scrollTop()+(a(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===e.containment?void(this.containment=[0,0,a(document).width()-this.helperProportions.width-this.margins.left,(a(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):e.containment.constructor===Array?void(this.containment=e.containment):("parent"===e.containment&&(e.containment=this.helper[0].parentNode),c=a(e.containment),d=c[0],void(d&&(b="hidden"!==c.css("overflow"),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(b?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(b?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=c))):void(this.containment=null)},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:e.scrollTop(),left:e.scrollLeft()}),{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*d}},_generatePosition:function(b){var c,d,e,f,g=this.options,h="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=b.pageX,j=b.pageY;return this.offset.scroll||(this.offset.scroll={top:h.scrollTop(),left:h.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(d=this.relative_container.offset(),c=[this.containment[0]+d.left,this.containment[1]+d.top,this.containment[2]+d.left,this.containment[3]+d.top]):c=this.containment,b.pageX-this.offset.click.left<c[0]&&(i=c[0]+this.offset.click.left),b.pageY-this.offset.click.top<c[1]&&(j=c[1]+this.offset.click.top),b.pageX-this.offset.click.left>c[2]&&(i=c[2]+this.offset.click.left),b.pageY-this.offset.click.top>c[3]&&(j=c[3]+this.offset.click.top)),g.grid&&(e=g.grid[1]?this.originalPageY+Math.round((j-this.originalPageY)/g.grid[1])*g.grid[1]:this.originalPageY,j=c?e-this.offset.click.top>=c[1]||e-this.offset.click.top>c[3]?e:e-this.offset.click.top>=c[1]?e-g.grid[1]:e+g.grid[1]:e,f=g.grid[0]?this.originalPageX+Math.round((i-this.originalPageX)/g.grid[0])*g.grid[0]:this.originalPageX,i=c?f-this.offset.click.left>=c[0]||f-this.offset.click.left>c[2]?f:f-this.offset.click.left>=c[0]?f-g.grid[0]:f+g.grid[0]:f)),{top:j-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:i-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(b,c,d){return d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d]),"drag"===b&&(this.positionAbs=this._convertPositionTo("absolute")),a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c){var d=a(this).data("ui-draggable"),e=d.options,f=a.extend({},c,{item:d.element});d.sortables=[],a(e.connectToSortable).each(function(){var c=a.data(this,"ui-sortable");c&&!c.options.disabled&&(d.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",b,f))})},stop:function(b,c){var d=a(this).data("ui-draggable"),e=a.extend({},c,{item:d.element});a.each(d.sortables,function(){this.instance.isOver?(this.instance.isOver=0,d.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,"original"===d.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,e))})},drag:function(b,c){var d=a(this).data("ui-draggable"),e=this;a.each(d.sortables,function(){var f=!1,g=this;this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(f=!0,a.each(d.sortables,function(){return this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this!==g&&this.instance._intersectsWith(this.instance.containerCache)&&a.contains(g.instance.element[0],this.instance.element[0])&&(f=!1),f})),f?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(e).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=d.offset.click.top,this.instance.offset.click.left=d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,d._trigger("toSortable",b),d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),d._trigger("fromSortable",b),d.dropped=!1)})}}),a.ui.plugin.add("draggable","cursor",{start:function(){var b=a("body"),c=a(this).data("ui-draggable").options;b.css("cursor")&&(c._cursor=b.css("cursor")),b.css("cursor",c.cursor)},stop:function(){var b=a(this).data("ui-draggable").options;b._cursor&&a("body").css("cursor",b._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c){var d=a(c.helper),e=a(this).data("ui-draggable").options;d.css("opacity")&&(e._opacity=d.css("opacity")),d.css("opacity",e.opacity)},stop:function(b,c){var d=a(this).data("ui-draggable").options;d._opacity&&a(c.helper).css("opacity",d._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(){var b=a(this).data("ui-draggable");b.scrollParent[0]!==document&&"HTML"!==b.scrollParent[0].tagName&&(b.overflowOffset=b.scrollParent.offset())},drag:function(b){var c=a(this).data("ui-draggable"),d=c.options,e=!1;c.scrollParent[0]!==document&&"HTML"!==c.scrollParent[0].tagName?(d.axis&&"x"===d.axis||(c.overflowOffset.top+c.scrollParent[0].offsetHeight-b.pageY<d.scrollSensitivity?c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop+d.scrollSpeed:b.pageY-c.overflowOffset.top<d.scrollSensitivity&&(c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop-d.scrollSpeed)),d.axis&&"y"===d.axis||(c.overflowOffset.left+c.scrollParent[0].offsetWidth-b.pageX<d.scrollSensitivity?c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft+d.scrollSpeed:b.pageX-c.overflowOffset.left<d.scrollSensitivity&&(c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft-d.scrollSpeed))):(d.axis&&"x"===d.axis||(b.pageY-a(document).scrollTop()<d.scrollSensitivity?e=a(document).scrollTop(a(document).scrollTop()-d.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<d.scrollSensitivity&&(e=a(document).scrollTop(a(document).scrollTop()+d.scrollSpeed))),d.axis&&"y"===d.axis||(b.pageX-a(document).scrollLeft()<d.scrollSensitivity?e=a(document).scrollLeft(a(document).scrollLeft()-d.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<d.scrollSensitivity&&(e=a(document).scrollLeft(a(document).scrollLeft()+d.scrollSpeed)))),e!==!1&&a.ui.ddmanager&&!d.dropBehaviour&&a.ui.ddmanager.prepareOffsets(c,b)}}),a.ui.plugin.add("draggable","snap",{start:function(){var b=a(this).data("ui-draggable"),c=b.options;b.snapElements=[],a(c.snap.constructor!==String?c.snap.items||":data(ui-draggable)":c.snap).each(function(){var c=a(this),d=c.offset();this!==b.element[0]&&b.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:d.top,left:d.left})})},drag:function(b,c){var d,e,f,g,h,i,j,k,l,m,n=a(this).data("ui-draggable"),o=n.options,p=o.snapTolerance,q=c.offset.left,r=q+n.helperProportions.width,s=c.offset.top,t=s+n.helperProportions.height;for(l=n.snapElements.length-1;l>=0;l--)h=n.snapElements[l].left,i=h+n.snapElements[l].width,j=n.snapElements[l].top,k=j+n.snapElements[l].height,h-p>r||q>i+p||j-p>t||s>k+p||!a.contains(n.snapElements[l].item.ownerDocument,n.snapElements[l].item)?(n.snapElements[l].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,b,a.extend(n._uiHash(),{snapItem:n.snapElements[l].item})),n.snapElements[l].snapping=!1):("inner"!==o.snapMode&&(d=p>=Math.abs(j-t),e=p>=Math.abs(k-s),f=p>=Math.abs(h-r),g=p>=Math.abs(i-q),d&&(c.position.top=n._convertPositionTo("relative",{top:j-n.helperProportions.height,left:0}).top-n.margins.top),e&&(c.position.top=n._convertPositionTo("relative",{top:k,left:0}).top-n.margins.top),f&&(c.position.left=n._convertPositionTo("relative",{top:0,left:h-n.helperProportions.width}).left-n.margins.left),g&&(c.position.left=n._convertPositionTo("relative",{top:0,left:i}).left-n.margins.left)),m=d||e||f||g,"outer"!==o.snapMode&&(d=p>=Math.abs(j-s),e=p>=Math.abs(k-t),f=p>=Math.abs(h-q),g=p>=Math.abs(i-r),d&&(c.position.top=n._convertPositionTo("relative",{top:j,left:0}).top-n.margins.top),e&&(c.position.top=n._convertPositionTo("relative",{top:k-n.helperProportions.height,left:0}).top-n.margins.top),f&&(c.position.left=n._convertPositionTo("relative",{top:0,left:h}).left-n.margins.left),g&&(c.position.left=n._convertPositionTo("relative",{top:0,left:i-n.helperProportions.width}).left-n.margins.left)),!n.snapElements[l].snapping&&(d||e||f||g||m)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,b,a.extend(n._uiHash(),{snapItem:n.snapElements[l].item})),n.snapElements[l].snapping=d||e||f||g||m)}}),a.ui.plugin.add("draggable","stack",{start:function(){var b,c=this.data("ui-draggable").options,d=a.makeArray(a(c.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});d.length&&(b=parseInt(a(d[0]).css("zIndex"),10)||0,a(d).each(function(c){a(this).css("zIndex",b+c)}),this.css("zIndex",b+d.length))}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c){var d=a(c.helper),e=a(this).data("ui-draggable").options;d.css("zIndex")&&(e._zIndex=d.css("zIndex")),d.css("zIndex",e.zIndex)},stop:function(b,c){var d=a(this).data("ui-draggable").options;d._zIndex&&a(c.helper).css("zIndex",d._zIndex)}})}(jQuery),define("jqueryUIDraggable",["jqueryUIMouse"],function(){}),define("directives/base/pt-rangeSlider",["app","jqueryDeParam","jqueryUISlider","jqueryUIDraggable"],function(a,b){a.directive("ptRangeslider",["$filter","$rootScope","$location",function(a,c,d){return{restrict:"A",transclude:!0,scope:{filter:"=",name:"@"},link:function(e,f,g){var h,i,j,k,l,m=e.filter,n=d.search(),o=!1;f=$(f),j=a("priceFormat"),i={budget:function(a){var b;return b=(Math.log(a)-Math.log(799400))/.05889},area:function(a){var b;return b=(Math.log(a)-Math.log(78.4768))/.048475},"default":function(a){var b=m.range.min;return m.range.max,(a-b)/1e5}},h={budget:function(a){var b;return b=799400*Math.exp(.05889*a)},area:function(a){var b;return b=78.4768*Math.exp(.048475*a)},"default":function(a){var b=m.range.min;return m.range.max,1e5*a+b}},e.updateValues=function(a){var b,c,d=m.range;return b=Math.floor(i[e.name](a[0]))+d.min-parseInt(d.min),c=Math.floor(i[e.name](a[1]))+d.max-parseInt(d.max),b=b<=d.min?d.min:b,c=c>=d.max?d.max:c,d=[b,c]},k=function(a){var b="",c=e.name,d=h[c](m.range.min),f=h[c](m.range.max),g=h[c](a[0]),i=h[c](a[1]);g=d>=g?d:g,i=i>=f?f:i;var k=j(g,void 0,void 0,void 0,-1),l=j(i,void 0,"",void 0,-1);a[1]>=m.range.max&&(l+="",l=l.split(".")[0],b="+"),i>=1e7&&(b+=" Cr"),l+=b,$("."+c+"-min-size").text(k),$("."+c+"-max-size").text(l)},f.slider({step:1,min:e.filter.range.min,max:e.filter.range.max,range:!0,values:[e.filter.range.min,e.filter.range.max],stop:function(a,b){var f={},i=[h[e.name](b.values[0]),h[e.name](b.values[1])],k=e.updateValues([m.initial.min,m.initial.max]);(b.values[0]>k[0]||b.values[1]<k[1])&&(f={from:i[0],to:i[1]});var o=j(i[0]),p=j(i[1]),q=g.elem,r="",s="",t={},u=c.CURRENT_ACTIVE_PAGE;s=o+"-"+p,r=m.gaKey+":"+s+"-"+u,t["Filter Name"]=q,t["Filter Value"]=s,t["Page Name"]=u,e.$apply(function(){l=[],f.from&&f.to&&(l=[f.from,f.to]),l&&l.length?n[m.key]=l.join():delete n[m.key],d.search(n)})},slide:function(a,b){k(b.values)}}).draggable();var p=function(){if(!o){var a=e.updateValues([m.initial.min,m.initial.max]);m.from=m.initial.min,m.to=m.initial.max,f.slider("option","values",a),k(a),m.active=!1}},q=function(){var a=m.range;_.has(n,m.key)?(a=n[m.key].split(","),m.from=a[0],m.to=a[1],a=e.updateValues(a),k(a),f.slider("option","values",a),m.active=!0,o=!0):m.initial&&(o=!1,p())};e.$watch("filter.initial",function(a,b){a&&p(a)}),e.$on("$locationChangeSuccess",function(a,e,f){var g,h,i=e.split("?")[1],j=f.split("?")[1],k=e.split("?")[0],l=f.split("?")[0],o=!_.isEqual(k,l);i&&(g=b(i)[m.key]),j&&(h=b(j)[m.key]),n=d.search(),_.isEqual(g,h)||(q(),c.$broadcast("FiltersUpdate",{hasPathChanged:o}))}),e.$on("$destroy",function(){f.slider("destroy").draggable("destroy")}),q()}}}])}),define("directives/base/pt-placeholder",["app","services/globalService"],function(a){a.directive("ptPlaceholder",["$rootScope","GlobalService",function(a,b){return{restrict:"A",require:"ngModel",link:function(c,d,e,f){var g;c.$on("$destroy",function(){d.unbind("focus"),d.unbind("blur")});var h,i=!1,j=function(c){var d=b.getObjectValuebyString(a,c);return d?d:c},g=function(){d.val(""),d.removeClass("exampleonly"),i&&d.attr("type","password")};c.$watch(e.ngModel,function(a){h=a||""}),c.$watch(function(){return e.ptPlaceholder},function(a){return a&&!h&&d[0]!==document.activeElement?(k(),h="",j(e.ptPlaceholder)):void 0}),d.bind("focus",function(){""===h&&g()}),d.bind("blur",function(){""===d.val()&&k()}),f.$formatters.unshift(function(a){return a||d[0]===document.activeElement?a:(k(),h="",j(e.ptPlaceholder))});var k=function(){d[0].value=j(e.ptPlaceholder),d.addClass("exampleonly"),"password"===d.attr("type")&&(d.attr("type","text"),i=!0)};d[0].value||k()}}}])}),define("text!views/directives/filters/equal-type.html",[],function(){return'<div ng-class="{\'dropdown-toggle\' : isdropdown}" class="searchDropInfo dropdown-toggle">\n    <span data-ng-if=\'filter.activeCount && isdropdown\'> \n        {{filter.tempLabel}}\n    </span>\n    <span data-ng-if=\'!filter.activeCount && isdropdown\'> {{filter.label}} </span>\n    <label data-ng-if=\'!isdropdown\'> {{filter.label}} </label>\n    <i class="pt pt-icon-angle-down iconArrow" data-ng-if=\'isdropdown\'></i>\n</div>\n<ul class="rightTopClick" data-ng-class="{\'filtClickListInfo\' : isdropdown, \'filtMoreContInfo\' : !isdropdown}">\n    <li class="checkboxInfo" data-ng-repeat="option in filter.options" data-ng-class="{\'active\': option.selected || option.selectedFromUrl, \'disable\':option.disable || option.disabledFromUrl}" data-ng-click="filterChanged(option, $event)">\n        <span class="checkIconInfo">\n            <i class="pt pt-icon-square-o"></i>\n            <i class="pt pt-icon-check-square-o"></i>\n        </span>\n        <label>{{option.label}}</label>\n    </li>\n</ul>'}),define("directives/filters/equal-type",["app","text!views/directives/filters/equal-type.html"],function(a,b){a.directive("equalType",["$rootScope","$location","GoogleAnalyticsService",function(a,c,d){return{restrict:"A",scope:{filter:"=",showDropdown:"=?",gaEvent:"@?",gaCategory:"@?"},template:b,controller:["$scope","$rootScope",function(a,b){var e=a.filter;c.search(),a.isdropdown=e.dropdown,0==a.showDropdown?a.isdropdown=!1:1==a.showDropdown&&(a.isdropdown=!0),a.filterChanged=function(c,f){f.stopPropagation(),d.gaEventSelectEqualType(a.gaEvent,a.gaCategory,c),c.disable||c.disabledFromUrl||b.$broadcast("filterChanged",c,e)}}]}}])}),define("text!views/directives/filters/range-type.html",[],function(){return'<span class="searchDropInfo dropdown-toggle" ng-class="{\'dropdown-toggle\' : filter.dropdown}">\n    \n    <label data-ng-if=\'!filter.dropdown\'> {{filter.label}} </label>\n\n    <i class="caret" data-ng-if=\'filter.dropdown\'></i>\n</span>\n<ul class="rightTopClick" data-ng-class="{\'filtClickListInfo\' : filter.dropdown, \'filtMoreContInfo\' : !filter.dropdown, \'disable\':filter.disable || filter.disabledFromUrl}">\n    <li class="checkboxInfo" data-ng-repeat="option in filter.options" data-ng-class="{\'active\': option.selected}" data-ng-click="filterChanged(option, $event)">\n        <span class="checkIconInfo">\n        	<i class="pt pt-icon-square-o"></i>\n        	<i class="pt pt-icon-check-square-o"></i>\n        </span>\n        <label>{{option.label}}</label>\n    </li>\n</ul>'}),define("directives/filters/range-type",["app","text!views/directives/filters/range-type.html","jqueryDeParam"],function(a,b,c){a.directive("rangeType",["$rootScope","$location","GoogleAnalyticsService",function(a,c,d){return{restrict:"A",scope:{filter:"=",gaEvent:"@?",gaCategory:"@?"},template:b,controller:["$scope",function(b){var e=b.filter,f=c.search();b.$on("$destroy",function(){e=void 0,f=void 0}),b.filterChanged=function(c,f){f.stopPropagation(),e.disable||e.disabledFromUrl||(a.$broadcast("filterChanged",c,e),d.gaEventRangeType(b.gaEvent,b.gaCategory,c))}}]}}])}),define("text!views/directives/filters/dynamic-tags.html",[],function(){return'<div class="row-full filtLocalDetInfo">\n    <label>{{filter.label}}</label>                               \n    <div class="autoCompleteSearch" tags-input data-ng-model="filter.selected" \n        placeholder="{{filter.placeholder}}"\n        temp-placeholder="{{filter.placeholder}}"\n        replace-spaces-with-dashes="false"                                   \n        add-from-autocomplete-only="true"\n        allowed-tags-pattern = "[a-zA-Z0-9\\.]*"                                \n        max-tags = "6"\n        min-length="2"\n        on-tag-added="update($tag.label)"\n        on-tag-removed="update($tag.label)"\n        >\n        <div auto-complete source="loadData($query)" min-length="2" debounce-delay="0" max-results-to-show="5"></div>\n    </div>\n\n    <div class="row-full filter-recommended">\n        <span class="filtRecHeadInfo">Popular {{filter.label}}:</span>\n        <span class="filtRecLink" data-ng-repeat="(id, item) in filter.recommended" data-ng-click="add(item, model, label)" data-ng-show="!item.notVisible" once-title="item.label" once-text="item.label"></span>\n    </div>\n    <div class="row-full requireText">\n            <strong>Note:</strong> You can add upto 6 {{filter.label}}\n    </div> \n    \n</div>\n'}),define("directives/filters/dynamic-tags",["app","text!views/directives/filters/dynamic-tags.html","jqueryDeParam"],function(a,b,c){a.directive("dynamicTags",["$rootScope","$location",function(a,d){return{restrict:"A",scope:{filter:"="},template:b,controller:["$scope",function(b){var e=b.filter,f=d.search(),g=[];b.update=function(a,b){e.selected.length?f[e.key]=_.pluck(e.selected,"label").join():delete f[e.key],d.search(f)},b.add=function(a,c,d){return e.selectedItem="",e.selected.length>=6?!1:(e.selected.push(a),e.specific&&e.specific(),void b.update(a.label,!0))},b.loadData=function(){return e.data};var h=function(){$.each(e.recommended,function(a,b){b.notVisible=_.contains(g,b.label)})},i=function(){_.has(f,e.key)?(g=f[e.key].split(","),e.activeCount=0,e.selected=[],_.each(g,function(a){e.selected.push({label:a}),e.activeCount++}),h()):(e.selected=[],e.activeCount=0,g.length=0,h())};b.$watch("filter.recommended",function(a){a&&a.length&&h()}),b.$on("$locationChangeSuccess",function(b,g,h){var j,k,l=g.split("?")[1],m=h.split("?")[1],n=g.split("?")[0],o=h.split("?")[0],p=!_.isEqual(n,o);l&&(j=c(l)[e.key]),m&&(k=c(m)[e.key]),f=d.search(),_.isEqual(j,k)||(i(),a.$broadcast("FiltersUpdate",{hasPathChanged:p}))}),i()}]}}])}),define("text!views/directives/filters/size.html",[],function(){return'<div ng-click="openSizeWidget=!openSizeWidget" class="searchDropInfo selectBoxInfo" ng-class="{\'arroDownInfo\': openSizeWidget}">    \n     <label data-ng-if=\'filter.active\'> \n        {{filter.tempLabel}} (sq ft)\n    </label>\n    <label data-ng-if=\'!filter.active\'> {{filter.label}} (sq ft)</label>\n    <i class="pt pt-icon-angle-down iconArrow"></i>\n</div>\n<div class="rightTopClick filterSizeContInfo"\n     ng-class="{\'showBoxInfo\': openSizeWidget}"\n     data-ga-category="gaCategory" data-ga-event="gaEvent" pt-rangemanager filter="filter"></div>\n'}),define("directives/filters/size",["app","text!views/directives/filters/size.html","directives/common/pt-rangemanager"],function(a,b){a.directive("size",["$rootScope",function(a){return{restrict:"A",scope:{filter:"=",gaCategory:"@?",gaEvent:"@?"},template:b}}])}),define("services/flags",["app"],function(a){a.factory("Flags",["$rootScope",function(a){var b={},c=function(a,c){b[a]=c},d=function(a){return b[a]},e=function(c,d){a.$broadcast(c+"Message",{value:b[c],extra:d})};return{set:c,get:d,broadcast:e}}])}),define("controllers/filterCtrl",["app","jqueryDeParam","underscore","services/pageSettings","services/projectService","services/localityService","services/builderService","services/filterService","directives/base/pt-rangeSlider","directives/base/pt-placeholder","directives/filters/equal-type","directives/filters/range-type","directives/filters/budget","directives/filters/dynamic-tags","directives/filters/size","services/flags","formatters/common"],function(a,b){a.controller("filterCtrl",["$rootScope","$scope","$window","$location","$state","$timeout","$stateParams","pageSettings","ProjectService","LocalityService","BuilderService","FilterService","Flags","$filter","Formatter",function(a,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q,r=e.search(),s=[],t=[],u=function(){var a;return"equal"===q.type&&s&&s.length?(a=s.sort()[0],_.each(q.options,function(b,c){b.key===a&&(a=b.label)}),q.activeCount>1&&(a+="+"+(q.activeCount-1))):"range"!==q.type||q.options||s&&s.length&&q.active&&(a=""===s[1]&&""!==s[0]&&q.amountAny?"budget"===q.gaKey?'<i class="pt pt-icon-inr"></i> '+o("priceFormat")(s[0],null,null," L",null,2)+" - Any":o("priceFormat")(s[0],null,null," L")+" - Any":""!==s[1]||""===s[0]||q.amountAny?""===s[0]&&""!==s[1]?"budget"===q.gaKey?'Up To <i class="pt pt-icon-inr"></i> '+o("priceFormat")(s[1],null,null," L",null,2):"Up To "+o("priceFormat")(s[1],null,null," L"):"budget"===q.gaKey?'<i class="pt pt-icon-inr"></i> '+o("priceFormat")(s[0],null,null," L",null,2)+' - <i class="pt pt-icon-inr"></i> '+o("priceFormat")(s[1],null,null," L",null,2):o("priceFormat")(s[0],null,null," L")+" - "+o("priceFormat")(s[1],null,null," L"):"budget"===q.gaKey?'<i class="pt pt-icon-inr"></i> '+o("priceFormat")(s[0],null,null," L",null,2)+" +":o("priceFormat")(s[0],null,null," L")+" +"),a},v=function(){if(q.keys)for(var a=0;a<q.keys.length;a++)if(_.has(r,q.keys[a])){q.key=q.keys[a];break}return _.has(r,q.key)?!0:!1},w=function(){var b;if("equal"===q.type)_.has(r,q.key)?(q.backwardCompatibility&&(b=q.backwardCompatibility(r[q.key])),b||(s=r[q.key].split(","),c.urlData=s,q.activeCount=0,_.each(q.options,function(a){_.contains(s,a.key)?(a.selected=!0,q.activeCount++):a.selected=!1}),q.tempLabel=u())):(_.each(q.options,function(a){a.selected=!1}),q.activeCount=0,s=[]);else if("range"===q.type)if(q.options)_.has(r,q.key)?(q.backwardCompatibility&&(b=q.backwardCompatibility(r[q.key])),b||(s=r[q.key].split(","),_.each(q.options,function(a){a.selected=s[0]==a.from&&s[1]==a.to}),q.active=!0)):(_.each(q.options,function(a){a.selected=!1}),q.active=!1,s.length=0);else{if(v()){s=r[q.key].split(",");var d=r[q.key].split(",");q.tmpFrom=p.formatPriceWithComma(d[0]),q.tmpTo=p.formatPriceWithComma(d[1]),q.from=d[0],q.to=d[1],q.active=!0,q.tempLabel=u()}else q.fromurl?(q.tmpFrom=p.formatPriceWithComma(q.from),q.tmpTo=p.formatPriceWithComma(q.to)):(q.active=!1,s.length=0,q.from="",q.to="",
q.tmpFrom="",q.tmpTo="",a.$broadcast("budgetFilterReset"));q.getMaxRange(q.from),q.selectMinMaxRange(q.from,q.to)}var e=0;if("projectStatus"===q.key&&q.options){for(e=0;e<q.options.length;e++){if(!q.activeCount||"underConstruction"===q.options[e].key&&q.options[e].selected){c.filters.possessionDate.disable=!1;break}c.filters.possessionDate.disable=!0}if(c.filters.possessionDate.disable)for(e=0;e<c.filters.possessionDate.options.length;e++)"undefined"!=typeof c.filters.possessionDate.options[e].selected&&c.filters.possessionDate.options[e].selected===!0&&a.$broadcast("filterChanged",c.filters.possessionDate.options[e],c.filters.possessionDate)}if("possessionDate"===q.key&&q.options){var f=c.filters.projectStatus.options.length;if(q.active)for(e=0;f>e;e++)"underConstruction"!=c.filters.projectStatus.options[e].key&&(c.filters.projectStatus.options[e].disable=!0);else for(e=0;f>e;e++)"underConstruction"!=c.filters.projectStatus.options[e].key&&(c.filters.projectStatus.options[e].disable=!1)}},x=function(){angular.forEach(c.filters,function(a,b){q=a,w()})},y=function(){var a=[];return r[q.key]&&(a=r[q.key].split(",")),a},z=c.$on("minRangeSelected",function(a,b){q=b,q.getMaxRange(q.from),q.selectMinMaxRange(q.from,q.to)});t.push(z);var A=c.$on("maxRangeSelected",function(a,b){q=b,q.selectMinMaxRange(q.from,q.to)});t.push(A);var B=c.$on("filterChanged",function(a,b,c){q=c,r=e.search(),s=y(),"equal"==q.type?(b.selected?(s=_.without(s,b.key),_.each(q.options,function(a,c){_.isEqual(a,b)&&(a.selected=!1)})):(_.each(q.options,function(a,c){_.isEqual(a,b)&&(a.selected=!0)}),s?s.push(b.key):(s.length=0,s.push(b.key))),s&&s.length?r[q.key]=s.join():delete r[q.key]):"range"===q.type&&(b?b.selected?(delete r[q.key],s=[],_.each(q.options,function(a,c){_.isEqual(a,b)&&(a.selected=!1)})):(_.each(q.options,function(a,c){_.isEqual(a,b)?a.selected=!0:a.selected=!1}),s=[b.from,b.to]):q.active||""===q.from&&""===q.to?(delete r[q.key],s=[]):s=[q.from,q.to],s&&s.length&&(r[q.key]=s.join())),delete r.page,e.search(r)});t.push(B);var C=c.$on("$locationChangeSuccess",function(c,d,f){var g,h,i=d.split("?")[1],j=f.split("?")[1],k=d.split("?")[0],l=f.split("?")[0],m=!_.isEqual(k,l);i&&(g=b(i)),j&&(h=b(j)),r=e.search(),x(),angular.forEach(g,function(a,b){-1==E.indexOf(b)&&delete g[b]}),angular.forEach(h,function(a,b){-1===E.indexOf(b)&&delete h[b]}),h=h||{},g=g||{},_.isEqual(g,h)||a.$broadcast("FiltersUpdate",{hasPathChanged:m})});t.push(C);var D=c.$watch("selectedCity",function(a){if(a&&a.label){var b={filters:{and:[{equal:{cityLabel:a.label.toLowerCase()}}]}};m.fetchStats(b)}});t.push(D),c.$on("$destroy",function(){for(var a in t)t[a]()}),c.filters=m.filters;var E=[];angular.forEach(c.filters,function(a,b){a.key&&E.push(a.key)}),E.push("price"),c.activeCount=function(){var a=0;return _.each(c.filters,function(b){b.dropdown||(b.activeCount||b.active)&&a++}),a},c.enableReset=function(){var a=c.activeCount()||m.filters.listingType.activeCount||m.filters.budget.active||m.filters.projectStatus.activeCount||m.filters.bed.activeCount||m.filters.possessionDate.active||m.filters.propertyType.activeCount;return a},c.clearAll=function(a){var b=a||{};if(c.enableReset()){var d=e.search().geo||null,f=e.search()._keys||null,g=e.search().q||null;f?e.search({_keys:f}):d?e.search({geo:d}):g?e.search({q:g}):e.search(b),r=b,x()}};var F=a.userDetails;if(F&&F.preference&&F.preference.preference&&F.preference.preference.unitType&&F.preference.preference.unitType.length){var G={};c.filters.propertyType.selected=F.preference.preference.unitType,_.each(F.preference.preference.unitType,function(a,b){G[a]=!0}),c.filters.propertyType.selection=G}x()}])}),define("controllers/b2b/analysis.e6215ea0",["app","services/catchmentService","directives/filters/budget","services/filterService","controllers/filterCtrl","directives/filters/equal-type"],function(a){a.controller("analysis",["$scope","$rootScope","$stateParams","$location","FilterService","CatchmentService",function(a,b,c,d,e,f){a.mapping={unitType:"unitType",primaryOrResaleBudget:"budget",bedrooms:"bedrooms",projectStatus:"constructionStatus"};var g=[],h=function(){var b=d.search(),c=[],e=a.filters;for(var f in e){var h=e[f];if(_.has(b,h.key))switch(h.type){case"equal":c=b[h.key].split(","),_.each(h.options,function(a){_.contains(c,a.key)&&k(a,h.key)});break;case"range":var j=b[h.key]?b[h.key].split(","):null;b[h.key]&&""!=b[h.key]&&j&&"primaryOrResaleBudget"==h.key&&(h.from=j[0]&&j[0].length?j[0]:null,h.to=j[1]&&j[1].length?j[1]:null,(h.from||h.to)&&(h.active=!0)),i(h)}}a.filterArr=g},i=function(b){var c=a.mapping[b.key];if(c)if(g=_.reject(g,function(a){return c==a.key}),b.options){var d=_.find(b.options,function(a){return 1==a.selected});d&&(g=_.reject(g,function(a){return a.key==c}),j(d,c))}else b.active&&j(b,c)},j=function(a,b){a.from&&g.push({key:b,filter:{fltrType:"ge",fltrKey:b,fltrValue:parseInt(a.from)}}),a.to&&g.push({key:b,filter:{fltrType:"le",fltrKey:b,fltrValue:parseInt(a.to)}})},k=function(b,c){var d=a.mapping[c];if(d){var e=_.find(g,function(a){return a.option==b&&d==a.key});e||(b.values?_.each(b.values,function(a){g.push({option:b,key:d,filter:{fltrType:"=",fltrKey:d,fltrValue:a}})}):g.push({option:b,key:d,filter:{fltrType:"=",fltrKey:d,fltrValue:b.key}}))}};a.builderId=c.builderId,a.catchmentId=c.catchmentId,a.filters=e.filters,a.filterArr=g,h()}])});