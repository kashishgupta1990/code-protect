!function(t){var e=function(i,n,s){s&&(s.stopPropagation(),s.preventDefault()),this.$element=t(i),this.$newElement=null,this.button=null,this.options=t.extend({},t.fn.selectpicker.defaults,this.$element.data(),"object"==typeof n&&n),null==this.options.title&&(this.options.title=this.$element.attr("title")),this.val=e.prototype.val,this.render=e.prototype.render,this.refresh=e.prototype.refresh,this.selectAll=e.prototype.selectAll,this.deselectAll=e.prototype.deselectAll,this.init()};e.prototype={constructor:e,init:function(e){this.options.container?this.$element.css("visibility","hidden"):this.$element.hide(),this.multiple=this.$element.prop("multiple");var i=void 0!==this.$element.attr("class")?this.$element.attr("class").split(/\s+/):"",n=this.$element.attr("id");this.$element.after(this.createView()),this.$newElement=this.$element.next(".bootstrap-select"),this.options.container&&this.selectPosition(),this.button=this.$newElement.find("> button"),void 0!==n&&(this.button.attr("id",n),t('label[for="'+n+'"]').click(t.proxy(this,function(){this.$newElement.find("button#"+n).focus()})));for(var s=0;s<i.length;s++)"selectpicker"!=i[s]&&this.$newElement.addClass(i[s]);this.multiple&&this.$newElement.addClass("show-tick"),this.button.addClass(this.options.style),this.checkDisabled(),this.checkTabIndex(),this.clickListener(),this.$element.bind("DOMNodeInserted DOMNodeRemoved",t.proxy(this.refresh,this)),this.render(),this.setSize()},createDropdown:function(){var e="<div class='btn-group bootstrap-select'><button class='btn dropdown-toggle clearfix' data-toggle='dropdown'><span class='filter-option pull-left'></span>&nbsp;<span class='caret'></span></button><ul class='dropdown-menu' role='menu'></ul></div>";return t(e)},createView:function(){var t=this.createDropdown(),e=this.createLi();return t.find("ul").append(e),t},reloadLi:function(){this.destroyLi(),$li=this.createLi(),this.$newElement.find("ul").append($li)},destroyLi:function(){this.$newElement.find("li").remove()},createLi:function(){var e=this,i=[],n=[],s="";if(this.$element.find("option").each(function(){i.push(t(this).text())}),this.$element.find("option").each(function(i){var s=void 0!==t(this).attr("class")?t(this).attr("class"):"",o=t(this).text(),l=void 0!==t(this).data("subtext")?'<small class="muted">'+t(this).data("subtext")+"</small>":"";if(o+=l,t(this).parent().is("optgroup")&&1!=t(this).data("divider"))if(0==t(this).index()){var d=t(this).parent().attr("label"),a=void 0!==t(this).parent().data("subtext")?'<small class="muted">'+t(this).parent().data("subtext")+"</small>":"";d+=a,0!=t(this)[0].index?n.push('<div class="div-contain"><div class="divider"></div></div><dt>'+d+"</dt>"+e.createA(o,"opt "+s)):n.push("<dt>"+d+"</dt>"+e.createA(o,"opt "+s))}else n.push(e.createA(o,"opt "+s));else 1==t(this).data("divider")?n.push('<div class="div-contain"><div class="divider"></div></div>'):n.push(e.createA(o,s))}),i.length>0)for(var o=0;o<i.length;o++){this.$element.find("option").eq(o);s+="<li rel="+o+">"+n[o]+"</li>"}return 0!=this.$element.find("option:selected").length||e.options.title||this.$element.find("option").eq(0).prop("selected",!0).attr("selected","selected"),t(s)},createA:function(t,e){return'<a tabindex="-1" href="#" class="'+e+'"><span class="pull-left">'+t+'</span><i class="icon-ok check-mark"></i></a>'},render:function(){var e=this;this.$element.find("option").each(function(i){e.setDisabled(i,t(this).is(":disabled")||t(this).parent().is(":disabled")),e.setSelected(i,t(this).is(":selected"))});var i=this.$element.find("option:selected").map(function(e,i){return void 0!=t(this).attr("title")?t(this).attr("title"):t(this).text()}).toArray(),n=i.join(", ");if(e.multiple&&e.options.selectedTextFormat.indexOf("count")>-1){var s=e.options.selectedTextFormat.split(">");(s.length>1&&i.length>s[1]||1==s.length&&i.length>=2)&&(n=i.length+" of "+this.$element.find("option").length+" selected")}n||(n=void 0!=e.options.title?e.options.title:e.options.noneSelectedText),e.$newElement.find(".filter-option").html(n)},setSize:function(){function e(){var e=l-t(window).scrollTop(),o=window.innerHeight,r=a+parseInt(n.css("margin-top"))+parseInt(n.css("margin-bottom"))+2,h=o-e-d-r;menuHeight=h,i.$newElement.hasClass("dropup")&&(menuHeight=e-r),n.find("li").length+n.find("dt").length>3?minHeight=3*s+r-2:minHeight=0,n.css({"max-height":menuHeight+"px","overflow-y":"auto","min-height":minHeight+"px"})}var i=this,n=this.$newElement.find(".dropdown-menu"),s=(n.find("li > a"),this.$newElement.addClass("open").find(".dropdown-menu li > a").outerHeight());this.$newElement.removeClass("open");var o=n.find("li .divider").outerHeight(!0),l=this.$newElement.offset().top,d=this.$newElement.outerHeight(),a=parseInt(n.css("padding-top"))+parseInt(n.css("padding-bottom"))+parseInt(n.css("border-top-width"))+parseInt(n.css("border-bottom-width"));if("auto"==this.options.size)e(),t(window).resize(e),t(window).scroll(e);else if(this.options.size&&"auto"!=this.options.size&&n.find("li").length>this.options.size){var r=n.find("li > *").filter(":not(.div-contain)").slice(0,this.options.size).last().parent().index(),h=n.find("li").slice(0,r+1).find(".div-contain").length;menuHeight=s*this.options.size+h*o+a,n.css({"max-height":menuHeight+"px","overflow-y":"auto"})}if("auto"==this.options.width){this.$newElement.find(".dropdown-menu").css("min-width","0");var c=this.$newElement.find(".dropdown-menu").css("width");this.$newElement.css("width",c),this.options.container&&this.$element.css("width",c)}else this.options.width&&"auto"!=this.options.width&&(this.$newElement.css("width",this.options.width),this.options.container&&this.$element.css("width",this.options.width))},selectPosition:function(){var t=this.$element.offset().top,e=this.$element.offset().left;this.$newElement.appendTo(this.options.container),this.$newElement.css({position:"absolute",top:t+"px",left:e+"px"})},refresh:function(){this.reloadLi(),this.render(),this.setSize(),this.checkDisabled(),this.options.container&&this.selectPosition()},setSelected:function(t,e){e?this.$newElement.find("li").eq(t).addClass("selected"):this.$newElement.find("li").eq(t).removeClass("selected")},setDisabled:function(t,e){e?this.$newElement.find("li").eq(t).addClass("disabled"):this.$newElement.find("li").eq(t).removeClass("disabled")},checkDisabled:function(){this.$element.is(":disabled")?(this.button.addClass("disabled"),this.button.click(function(t){t.preventDefault()}),this.button.on("focusin",function(){t(this).blur()})):!this.$element.is(":disabled")&&this.button.hasClass("disabled")&&(this.button.removeClass("disabled"),this.button.click(function(){return!0}))},checkTabIndex:function(){if(this.$element.is("[tabindex]")){var t=this.$element.attr("tabindex");this.button.attr("tabindex",t)}},clickListener:function(){var e=this;t("body").on("touchstart.dropdown",".dropdown-menu",function(t){t.stopPropagation()}),this.$newElement.on("click","li a",function(i){var n=t(this).parent().index(),s=t(this).parent(),o=s.parents(".bootstrap-select"),l=e.$element.val();if(e.multiple&&i.stopPropagation(),i.preventDefault(),e.$element.not(":disabled")&&!t(this).parent().hasClass("disabled")){if(e.multiple){var d=e.$element.find("option").eq(n).prop("selected");d?e.$element.find("option").eq(n).removeAttr("selected"):e.$element.find("option").eq(n).prop("selected",!0).attr("selected","selected")}else e.$element.find("option").removeAttr("selected"),e.$element.find("option").eq(n).prop("selected",!0).attr("selected","selected");o.find(".filter-option").html(s.text()),o.find("button").focus(),l!=e.$element.val()&&e.$element.trigger("change"),e.render()}}),this.$newElement.on("click","li.disabled a, li dt, li .div-contain",function(e){e.preventDefault(),e.stopPropagation(),$select=t(this).parent().parents(".bootstrap-select"),$select.find("button").focus()}),this.$element.on("change",function(t){e.render()})},val:function(t){return void 0!=t?(this.$element.val(t),this.$element.trigger("change"),this.$element):this.$element.val()},selectAll:function(){this.$element.find("option").prop("selected",!0).attr("selected","selected"),this.render()},deselectAll:function(){this.$element.find("option").prop("selected",!1).removeAttr("selected"),this.render()}},t.fn.selectpicker=function(i,n){var s,o=arguments,l=this.each(function(){if(t(this).is("select")){var l=t(this),d=l.data("selectpicker"),a="object"==typeof i&&i;if(d){if(a)for(var r in a)d.options[r]=a[r]}else l.data("selectpicker",d=new e(this,a,n));"string"==typeof i&&(property=i,d[property]instanceof Function?([].shift.apply(o),s=d[property].apply(d,o)):s=d.options[property])}});return void 0!=s?s:l},t.fn.selectpicker.defaults={style:null,size:"auto",title:null,selectedTextFormat:"values",noneSelectedText:"Nothing selected",width:null,container:!1}}(window.jQuery);