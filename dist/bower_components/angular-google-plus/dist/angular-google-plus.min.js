/*! angular-google-plus - v0.1.3 2015-08-27 */

angular.module("googleplus",[]).provider("GooglePlus",[function(){var e={};e.clientId=null,this.setClientId=function(t){return e.clientId=t,this},this.getClientId=function(){return e.clientId},e.apiKey=null,this.setApiKey=function(t){return e.apiKey=t,this},this.getApiKey=function(){return e.apiKey},e.scopes="https://www.googleapis.com/auth/plus.login",this.setScopes=function(t){return e.scopes=t,this},this.getScopes=function(){return e.scopes},this.init=function(t){angular.extend(e,t)},this.enableServerSide=function(){e.accessType="offline",e.responseType="code token id_token gsession"},this.disableServerSide=function(){delete e.accessType,delete e.responseType},this.$get=["$q","$rootScope","$timeout",function(t,n,i){var o,s=function(){};return s.prototype.login=function(){o=t.defer();var n={client_id:e.clientId,scope:e.scopes,immediate:!1};return e.accessType&&e.responseType&&(n.access_type=e.accessType,n.response_type=e.responseType),gapi.auth.authorize(n,this.handleAuthResult),o.promise},s.prototype.checkAuth=function(){gapi.auth.authorize({client_id:e.clientId,scope:e.scopes,immediate:!0},this.handleAuthResult)},s.prototype.handleClientLoad=function(){gapi.client.setApiKey(e.apiKey),gapi.auth.init(function(){}),i(this.checkAuth,1)},s.prototype.handleAuthResult=function(e){e&&!e.error?(o.resolve(e),n.$apply()):o.reject("error")},s.prototype.getUser=function(){var e=t.defer();return gapi.client.load("oauth2","v2",function(){gapi.client.oauth2.userinfo.get().execute(function(t){e.resolve(t),n.$apply()})}),e.promise},s.prototype.getToken=function(){return gapi.auth.getToken()},s.prototype.setToken=function(e){return gapi.auth.setToken(e)},s.prototype.logout=function(){gapi.auth.signOut()},new s}]}]).run([function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://apis.google.com/js/client.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}]);