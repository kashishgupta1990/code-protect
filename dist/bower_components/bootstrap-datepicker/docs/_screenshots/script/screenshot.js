var sys=require("system"),page=new WebPage;page.viewportSize={width:800,height:600},page.open(sys.args[1],function(t){"success"!==t&&(console.log("Bad status: %s",t),phantom.exit(1)),window.setTimeout(function(){var t=page.evaluate(function(){var t,e,a,i,o,r,h=10;window.setup&&window.setup(),r=$("body").data("show"),r=r?$(r):$("*"),r.filter(function(){return"datepicker"in $(this).data()}).datepicker("show"),o=$($("body").data("capture")),a=o.map(function(){return $(this).offset().top}).toArray(),t=o.map(function(){return $(this).offset().left}).toArray(),i=o.map(function(){return $(this).offset().top+$(this).outerHeight()}).toArray(),e=o.map(function(){return $(this).offset().left+$(this).outerWidth()}).toArray();var n={top:Math.min.apply(Math,a),left:Math.min.apply(Math,t)};return n.width=Math.max.apply(Math,e)-n.left,n.height=Math.max.apply(Math,i)-n.top,{top:Math.max(n.top-h,0),left:Math.max(n.left-h,0),width:n.width+2*h,height:n.height+2*h}});page.clipRect=t,page.render(sys.args[2]),phantom.exit()},1)});