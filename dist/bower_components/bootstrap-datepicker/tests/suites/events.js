module("Events",{setup:function(){this.input=$('<input type="text" value="31-03-2011">').appendTo("#qunit-fixture").datepicker({format:"dd-mm-yyyy"}).focus(),this.dp=this.input.data("datepicker"),this.picker=this.dp.picker},teardown:function(){this.picker.remove()}}),test("Selecting a year from decade view triggers changeYear",function(){var t,i=0;this.input.on("changeYear",function(){i++}),equal(this.dp.viewMode,0),t=this.picker.find(".datepicker-days thead th.datepicker-switch"),ok(t.is(":visible"),"View switcher is visible"),t.click(),ok(this.picker.find(".datepicker-months").is(":visible"),"Month picker is visible"),equal(this.dp.viewMode,1),datesEqual(this.dp.viewDate,UTCDate(2011,2,31)),datesEqual(this.dp.dates[0],UTCDate(2011,2,31)),t=this.picker.find(".datepicker-months thead th.datepicker-switch"),ok(t.is(":visible"),"View switcher is visible"),t.click(),ok(this.picker.find(".datepicker-years").is(":visible"),"Year picker is visible"),equal(this.dp.viewMode,2),datesEqual(this.dp.viewDate,UTCDate(2011,2,31)),datesEqual(this.dp.dates[0],UTCDate(2011,2,31)),t=this.picker.find(".datepicker-years tbody span:contains(2010)"),t.click(),equal(this.dp.viewMode,1),datesEqual(this.dp.viewDate,UTCDate(2010,2,1)),datesEqual(this.dp.dates[0],UTCDate(2011,2,31)),equal(i,1)}),test("Navigating forward/backward from month view triggers changeYear",function(){var t,i=0;this.input.on("changeYear",function(){i++}),equal(this.dp.viewMode,0),t=this.picker.find(".datepicker-days thead th.datepicker-switch"),ok(t.is(":visible"),"View switcher is visible"),t.click(),ok(this.picker.find(".datepicker-months").is(":visible"),"Month picker is visible"),equal(this.dp.viewMode,1),t=this.picker.find(".datepicker-months thead th.prev"),ok(t.is(":visible"),"Prev switcher is visible"),t.click(),ok(this.picker.find(".datepicker-months").is(":visible"),"Month picker is visible"),equal(i,1),t=this.picker.find(".datepicker-months thead th.next"),ok(t.is(":visible"),"Next switcher is visible"),t.click(),ok(this.picker.find(".datepicker-months").is(":visible"),"Month picker is visible"),equal(i,2)}),test("Selecting a month from year view triggers changeMonth",function(){var t,i=0;this.input.on("changeMonth",function(){i++}),equal(this.dp.viewMode,0),t=this.picker.find(".datepicker-days thead th.datepicker-switch"),ok(t.is(":visible"),"View switcher is visible"),t.click(),ok(this.picker.find(".datepicker-months").is(":visible"),"Month picker is visible"),equal(this.dp.viewMode,1),datesEqual(this.dp.viewDate,UTCDate(2011,2,31)),datesEqual(this.dp.dates[0],UTCDate(2011,2,31)),t=this.picker.find(".datepicker-months tbody span:contains(Apr)"),t.click(),equal(this.dp.viewMode,0),datesEqual(this.dp.viewDate,UTCDate(2011,3,1)),datesEqual(this.dp.dates[0],UTCDate(2011,2,31)),equal(i,1)}),test("Navigating forward/backward from month view triggers changeMonth",function(){var t,i=0;this.input.on("changeMonth",function(){i++}),equal(this.dp.viewMode,0),t=this.picker.find(".datepicker-days thead th.prev"),ok(t.is(":visible"),"Prev switcher is visible"),t.click(),ok(this.picker.find(".datepicker-days").is(":visible"),"Day picker is visible"),equal(i,1),t=this.picker.find(".datepicker-days thead th.next"),ok(t.is(":visible"),"Next switcher is visible"),t.click(),ok(this.picker.find(".datepicker-days").is(":visible"),"Day picker is visible"),equal(i,2)}),test("format() returns a formatted date string",function(){var t,i,e;this.input.on("changeDate",function(t){try{e=t.format()}catch(t){i=t}}),equal(this.dp.viewMode,0),t=this.picker.find(".datepicker-days tbody td:nth(15)"),t.click(),datesEqual(this.dp.viewDate,UTCDate(2011,2,14)),datesEqual(this.dp.dates[0],UTCDate(2011,2,14)),equal(i,void 0),equal(e,"14-03-2011")}),test("format(altformat) returns a formatted date string",function(){var t,i,e;this.input.on("changeDate",function(t){try{e=t.format("m/d/yy")}catch(t){i=t}}),equal(this.dp.viewMode,0),t=this.picker.find(".datepicker-days tbody td:nth(15)"),t.click(),datesEqual(this.dp.viewDate,UTCDate(2011,2,14)),datesEqual(this.dp.dates[0],UTCDate(2011,2,14)),equal(i,void 0),equal(e,"3/14/11")}),test("format(ix) returns a formatted date string of the ix'th date selected",function(){var t,i,e;this.dp._process_options({multidate:!0}),this.input.on("changeDate",function(t){try{e=t.format(2)}catch(t){i=t}}),t=this.picker.find(".datepicker-days tbody td:nth(7)"),equal(t.text(),"6"),t.click(),t=this.picker.find(".datepicker-days tbody td:nth(15)"),equal(t.text(),"14"),t.click(),equal(this.dp.dates.length,3),equal(i,void 0),equal(e,"14-03-2011")}),test("format(ix, altformat) returns a formatted date string",function(){var t,i,e;this.dp._process_options({multidate:!0}),this.input.on("changeDate",function(t){try{e=t.format(2,"m/d/yy")}catch(t){i=t}}),t=this.picker.find(".datepicker-days tbody td:nth(7)"),equal(t.text(),"6"),t.click(),t=this.picker.find(".datepicker-days tbody td:nth(15)"),equal(t.text(),"14"),t.click(),equal(this.dp.dates.length,3),equal(i,void 0),equal(e,"3/14/11")}),test("Clear button: triggers change and changeDate events",function(){this.input=$('<input type="text" value="31-03-2011">').appendTo("#qunit-fixture").datepicker({format:"dd-mm-yyyy",clearBtn:!0}).focus(),this.dp=this.input.data("datepicker"),this.picker=this.dp.picker;var t,i=0,e=0;this.input.on({changeDate:function(){e++},change:function(){i++}}),this.input.focus(),ok(this.picker.find(".datepicker-days").is(":visible"),"Days view visible"),ok(this.picker.find(".datepicker-days tfoot .clear").is(":visible"),"Clear button visible"),t=this.picker.find(".datepicker-days tfoot .clear"),t.click(),equal(i,1),equal(e,1)}),test("setDate: triggers change and changeDate events",function(){this.input=$('<input type="text" value="31-03-2011">').appendTo("#qunit-fixture").datepicker({format:"dd-mm-yyyy"}).focus(),this.dp=this.input.data("datepicker"),this.picker=this.dp.picker;var t=0,i=0;this.input.on({changeDate:function(){i++},change:function(){t++}}),this.input.focus(),ok(this.picker.find(".datepicker-days").is(":visible"),"Days view visible"),this.dp.setDate(new Date(2011,2,5)),equal(t,1),equal(i,1)}),test("paste must update the date",function(){var t="22-07-2015",i={type:"paste",originalEvent:{clipboardData:{types:["text/plain"],getData:function(){return t}}}};this.input.trigger(i),datesEqual(this.dp.dates[0],UTCDate(2015,6,22))}),test("clicking outside datepicker triggers 'hide' event",function(){var t=$("<div />");$("body").append(t);var i;this.input.on("hide",function(){i=!0}),t.trigger("mousedown"),ok(i,"'hide' event is not triggered"),t.remove()}),test("Selecting date from previous month triggers changeMonth",function(){var t,i=0;this.input.on("changeMonth",function(){i++}),t=this.picker.find(".datepicker-days tbody td:first"),t.click(),equal(i,1)}),test("Selecting date from previous month in january triggers changeMonth/changeYear",function(){var t,i=0,e=0;this.input.val("01-01-2011"),this.dp.update(),this.input.on("changeMonth",function(){i++}),this.input.on("changeYear",function(){e++}),t=this.picker.find(".datepicker-days tbody td:first"),t.click(),equal(i,1),equal(e,1)}),test("Selecting date from next month triggers changeMonth",function(){var t,i=0;this.input.on("changeMonth",function(){i++}),t=this.picker.find(".datepicker-days tbody td:last"),t.click(),equal(i,1)}),test("Selecting date from next month in december triggers changeMonth/changeYear",function(){var t,i=0,e=0;this.input.val("01-12-2011"),this.dp.update(),this.input.on("changeMonth",function(){i++}),this.input.on("changeYear",function(){e++}),t=this.picker.find(".datepicker-days tbody td:last"),t.click(),equal(i,1),equal(e,1)});