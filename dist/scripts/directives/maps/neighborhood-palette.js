define(["app","text!views/directives/maps/neighborhood-palette.html","services/localityService","formatters/common"],function(a,b){a.directive("neighborhoodPalette",["LocalityService","$rootScope","Formatter",function(a,c,d){return{restrict:"EAC",scope:{radius:"=",data:"=",activate:"&",deactivate:"&"},template:b,link:function(b){b.places=d.neighborhoodPlaces,b.activeKey="school",b.action=function(a,d){void 0!==b.activeKey&&b.deactivate({key:b.activeKey}),b.activeKey!==a?(b.activate({key:a}),b.activeKey=a):b.activeKey=void 0;var e={};e["Project "+d+" Name"]=a,e["Project Id"]=b.data.projectId?b.data.projectId:void 0,e["Page Name"]=c.CURRENT_ACTIVE_PAGE},b.neighbourhoodItems=function(c,d){var e="",f={school:0,restaurant:0,hospital:0,gas_station:0,bank:0,airport:0,train_station:0,bus_station:0};a.getNeighbourhood(d,c,"",function(a){for(var c=0,d=a.length;d>c;c++)e=a[c],f[e.localityAmenityTypes.name]+=1;for(var c=0;c<b.places.nearby.length;c++)b.places.nearby[c].value=f[b.places.nearby[c].key];for(var c=0;c<b.places.connectivity.length;c++)b.places.connectivity[c].value=f[b.places.connectivity[c].key]})};var e={};e.lat=b.data.latitude,e.lng=b.data.longitude,b.neighbourhoodItems(b.radius,e)}}}])});