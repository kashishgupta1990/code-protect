if(!function(deparam){if("function"==typeof require&&"object"==typeof exports&&"object"==typeof module){var jquery=require("jquery");module.exports=deparam(jquery)}else if("function"==typeof define&&define.amd)define("jqueryDeParam",["jquery"],function(a){return deparam(a)});else{var global=eval("this");global.deparam=deparam(jQuery)}}(function(a){return function(b,c){var d={},e={"true":!0,"false":!1,"null":null};return a.each(b.replace(/\+/g," ").split("&"),function(b,f){var g,h=f.split("="),i=decodeURIComponent(h[0]),j=d,k=0,l=i.split("]["),m=l.length-1;if(/\[/.test(l[0])&&/\]$/.test(l[m])?(l[m]=l[m].replace(/\]$/,""),l=l.shift().split("[").concat(l),m=l.length-1):m=0,2===h.length)if(g=decodeURIComponent(h[1]),c&&(g=g&&!isNaN(g)?+g:"undefined"===g?void 0:void 0!==e[g]?e[g]:g),m)for(;m>=k;k++)i=""===l[k]?j.length:l[k],j=j[i]=m>k?j[i]||(l[k+1]&&isNaN(l[k+1])?{}:[]):g;else a.isArray(d[i])?d[i].push(g):void 0!==d[i]?d[i]=[d[i],g]:d[i]=g;else i&&(d[i]=c?void 0:"")}),d}}),define("services/maps/mapConfig",["app"],function(a){a.factory("PtMapsConfig",[function(){var a={state:{zoom:5,center:{lat:21,lng:78},minZoom:9,maxZoom:22,filter:{visible:!1,action:null,state:{distance:3,minDistance:3,maxDistance:7,maxStoredDistance:3,lastDistance:2,position:{lat:21,lng:78}}},polygonFilter:{visible:!1,currentDrawingStatus:!1,polygonExist:!1,action:null,savedGeo:null,state:{distance:3,minDistance:3,maxDistance:7,position:{lat:21,lng:78}}},libraries:{},markers:{},neighbourhood:{locality:{},project:{}},activateToggleCollage:!1,collapseState:!1,activeProjectId:null},events:{},services:{direction:{create:void 0,remove:void 0},bounds:void 0,state:{saveMapState:function(a,b){window.__mapZoomLevel=a,window.__mapCenter=b},restoreMapState:function(){var a=window.__mapZoomLevel,b=window.__mapCenter;return window.__mapZoomLevel=null,window.__mapCenter=null,{zoom:a,center:b}},isMapStateSaved:function(){return window.__mapZoomLevel}}},zoomincounter:0,zoomoutcounter:0},b={ptDefault:[{featureType:"all",stylers:[{saturation:-90},{hue:"#0066ff"},{gamma:1}]},{featureType:"water",stylers:[{gamma:.63},{hue:"#0091ff"},{saturation:51}]},{featureType:"poi.business",stylers:[{visibility:"off"}]}],masterPlan:[{featureType:"all",stylers:[{saturation:-90},{hue:"#0066ff"},{gamma:1}]},{featureType:"poi.business",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:"49"}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"water",elementType:"all",stylers:[{color:"#dde6e8"},{visibility:"on"}]}]},c={V_HIGH:Math.PI/24,HIGH:Math.PI/12,MEDIUM:Math.PI/6,LOW:Math.PI/4},d={currentActiveTab:!1},e={directions:[{direction:"EAST",lat:.5,lng:0},{direction:"WEST",lat:-.5,lng:0},{direction:"NORTH",lat:0,lng:.5},{direction:"SOUTH",lat:0,lng:-.5}],delta:.5,timeLimit:30,repeatThreshHold:4,stepOutThreshold:4,fitBoundTimeKey:30,fitBoundRange:"20-30",timeSequence:[{time:10,degree:c.MEDIUM,add:[{range:"0-10",limits:[10],fillColor:"#86b927",strokeColor:"#86b927",fillOpacity:.35,strokeOpacity:.5,strokeWeight:.1}]},{time:20,degree:c.HIGH,add:[{range:"10-20",limits:[10,20],fillColor:"#bfb51d",strokeColor:"#bfb51d",fillOpacity:.35,strokeOpacity:.5,strokeWeight:.1}]},{time:30,degree:c.HIGH,add:[{range:"20-30",limits:[20,30],fillColor:"#b25317",strokeColor:"#b25317",fillOpacity:.35,strokeOpacity:.5,strokeWeight:.1}]}]},f={displayType:"type"},g={displayType:"type"},h={roadScaleFactor:{increase:2,decrease:.5},trainScaleFactor:{increase:2,decrease:.5}},i=function(a,b){if(!a||!b)return 0;var c=6371,d=(b.lat-a.lat)*Math.PI/180,e=(b.lng-a.lng)*Math.PI/180,f=Math.sin(d/2)*Math.sin(d/2)+Math.cos(a.lat*Math.PI/180)*Math.cos(b.lat*Math.PI/180)*Math.sin(e/2)*Math.sin(e/2),g=2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),h=c*g;return h},j={noida:[[28.66347872760795,77.09346771240234],[28.66347872760795,77.75127410888672],[28.376297906469308,77.09346771240234]],bangalore:[[13.283387236490535,76.98394775390625],[13.283387236490535,78.30024719238281],[12.647038251367576,76.98394775390625]],pune:[[18.858858917152634,73.21014404296875],[18.858858917152634,74.52713012695312],[18.238481676022758,73.21014404296875]]},k={na:["#333"],0:["rgba(204, 3, 0, 1)"],1:["rgba(204, 88, 0, 1)"],2:["rgba(204, 173, 0, 1)"],3:["rgba(149, 204, 0, 1)"],4:["rgba(67, 204, 0, 1)"]};return{mapConfig:a,mapStyle:b,markerSettings:f,distanceBetweenPoints:i,polygonColorPalette:k,indexSettings:g,travelHeatMapConfig:e,projectDetailCardConfig:d,citySvgLatLongHashMap:j,masterPlanScaleFactor:h}}])}),define("services/maps/markerBuilder",["app","services/maps/mapConfig"],function(a){a.factory("MarkerBuilder",["$rootScope","PtMapsConfig",function(a,b){var c=function(){var a=document.createElement("div"),b=angular.element(a);return b},d=function(){var a=document.createElement("span"),b=angular.element(a);return b},e=function(){var a=document.createElement("i"),b=angular.element(a);return b},f={parent:function(){var a=c(),b=this.data;return a.addClass("sq_marker sqm_locality"),a.addClass("sq_"+b.markerWidth),a.attr("id",b.selector),a},projectCount:function(){var a=c(),b=this.data;return a.addClass("val"),a.text(b.projectCount),a},name:function(){var a=c(),b=this.data;return a.addClass("loc-name"),a.text(b.label),a.attr("title",b.label),a},rate:function(){var a=c(),b=this.data;return a.addClass("avg-rate"),a.html(b.unitPriceHtml),a},trend:function(){var a=c(),b=this.data;return a.addClass("rise-fall"),a.html(b.priceRiseHtml),a},countTrend:function(){var a=c(),b=c(),d=c(),e=this.data;return a.addClass("loc-wrap-two"),b.addClass("count"),b.text(e.projectCountText),d.addClass("launch"),d.html(e.prelaunchHtml),a.append(b),a.append(d),a.append('<div class="clearfix"></div>'),a},build:function(a){this.data=a;var b=this.parent();b.append(this.projectCount());var d=c();return d.addClass("loc-info-wrap"),d.append(this.name()),d.append(this.rate()),d.append(this.trend()),d.append(this.countTrend()),b.append(d),b}},g={parent:function(){var a=c(),b=this.data;return a.addClass("sq_marker sqm_project"),this.data.addDefaultClass&&a.addClass(this.data.addDefaultClass),a.addClass("pt-"+this.type),a.addClass("rate-color-"+b._rateColor),a.addClass("date-color-"+b._dateColor),a.addClass("score-color-"+b._scoreColor),a.addClass(b.displayPriceClass),a.addClass(b.possessionDateClass),a.addClass(b.livabilityScoreClass),a.addClass(b.projectType),a.attr("id",b.selector),a},favVisited:function(){var a=c();return this.data,a.html('<div class="fav-icon"><i class="pt pt-icon-heart"></i></div><div class="visited-icon"><i class="pt pt-icon-clock-o"></i></div>'),a},icon:function(){var a=c(),b=this.data;switch(this.type){case"type":a.html('<div class="val val-type"><i class="pt-icon-'+b.projectType+'"></i></div>');break;case"rate":a.addClass("val-rate"),a.html(b.displayPriceHtml);break;case"date":a.addClass("val-date"),a.html(b.possessionDateHtml);break;case"livability":a.addClass("val-score"),a.html(b.livabilityScore)}return a},projectStatus:function(){return"New Launch"==this.data.projectStatus?$('<div class="info-bnrs"><div class="info-bnr-green">New Launch</div></div>'):"Launching Soon"==this.data.projectStatus?$('<div class="info-bnrs"><div class="info-bnr-blue">Launching Soon</div></div>'):void 0},deal:function(){return this.data.offers&&this.data.offers.length?$('<div class="deal-icon"><i class="pt pt-icon-bell-o"></i></div>'):void 0},location:function(){return $('<div class="proj-loc">'+this.data.address+"</div>")},bhk:function(){var a=$('<div class="proj-bhk>');return a.html("<span>"+this.data.bhkInfo+"</span>")},price:function(){if("Price On Request"!=this.data.newPriceHtml){var a=$("<span>"),b=$('<div class="proj-new-price">');return a.html(this.data.newPriceHtml),b.text("Builder Price: "),b.append(a),b}if("Price On Request"==this.data.newPriceHtml){var b=$('<div class="proj-new-price">');return b.text("Builder Price: Price On Request"),b}},resalePrice:function(){if(this.data.resalePriceHtml){var a=$("<span>"),b=$('<div class="proj-re-price">');return a.html(this.data.resalePriceHtml),b.text("Resale Price: "),b.append(a),b}},rate:function(){if("NA"!=this.data.minPricePerUnitArea){var a=$("<span>"),b=$('<div class="proj-rate"><i class="pt pt-icon-inr"></i></div>');return a.text(this.data.minPricePerUnitArea),b.append(a),b.append(" /sq ft"),b}},possessionDate:function(){return"NA"!=this.data.possessionDate?$('<div class="proj-date"></div>').text(this.data.possessionDate):void 0},livabilityScore:function(){return this.data.livabilityScoreHtml&&"NA"!=this.data.livabilityScore?$('<div class="proj-score"></div>').text(this.data.livabilityScoreHtml):void 0},builder:function(){return $('<div class="pBuildername">').text(this.data.builderName)},name:function(){return $('<div class="pname">').text(this.data.name)},basicInfo:function(){var a=$('<div class="proj-type-name">');return a.append(this.builder()).append(this.name())},projectInfo:function(){var a=$('<div class="proj-info-wrap">');return a.append(this.projectStatus()),a.append(this.deal()),a.append(this.location()),a.append(this.bhk()),a.append(this.price()),a.append(this.resalePrice()),"rate"==this.type&&a.append(this.rate()),"date"==this.type&&a.append(this.possessionDate()),"livability"==this.type&&a.append(this.livabilityScore()),a.append(this.basicInfo()),a},build:function(a){this.type=b.markerSettings.displayType,this.data=a;var c=this.parent();return c.append(this.favVisited()),c.append(this.icon()),c.append(this.projectInfo()),c}},h={parent:function(){var a=c(),b=this.data;return a.addClass("mrkr l-mrkr"),b.authorized||a.addClass("buyit"),a.attr("id",b.selector),a},buy:function(){var a=d(),b=e();return a.addClass("buy"),b.addClass("pt pt-icon-shopping-cart"),a.append(b),a},projectCount:function(){var a=d(),b=this.data;return a.addClass("count"),a.text(b.projectCount),a},label:function(){var a=d(),b=this.data;return a.addClass("put-ellipsis"),a.text(b.label),a},hoverLabel:function(){var a=d(),b=this.data;return a.addClass("loc-name"),a.attr("title",b.label),a.text(b.label),a},unitPrice:function(){var a=c(),b=this.data;return a.addClass("pt_col-6-8"),a.html(b.unitPriceHtml),a},priceRise6Months:function(){var a=d(),b=this.data;return a.addClass("rise-decline"),a.html(b.priceRise6MonthsHtml),a},unitsLaunched:function(){var a=d(),b=this.data;return a.addClass("new-launch-count"),a.html(b.localityUnitsLaunched6MonthsHtml),$('<div class="pt_col-3-8">').append("<div>New Launch</div>").append(a)},unitsSold:function(){var a=d(),b=this.data;return a.addClass("under-constr-count"),a.html(b.localityUnitsSold6MonthsHtml),$('<div class="pt_col-3-8">').append("<div>Sold</div>").append(a)},unitsDelivered:function(){var a=d(),b=this.data;return a.addClass("delivered-count"),a.html(b.localityUnitsDelivered6MonthsHtml),$('<div class="pt_col-2-8">').append("<div>Delivered</div>").append(a)},upgradeButton:function(){var a=$('<button class="small-btn btn-primary">UPGRADE PLAN</button>');return a},onClickPopup:function(){var b=$('<div class="onclick-popup">'),c=$('<div class="head">').append(this.hoverLabel()).append('<span class="last-update">last 6 months</span>').append('<div class="clearfix"></div>'),d=$('<div class="buy-wrap ta-center marginT5 paddingB5 paddingB5">').append("<p>Oops! you need to upgrade your package to view this data</p>").append(this.upgradeButton()),e=$('<div class="pt_row loc-info">').append(this.unitPrice()).append($('<div class="pt_col-2-8">').append(this.priceRise6Months())),f=$('<div class="pt_row proj-nmbr">').append(this.unitsLaunched()).append(this.unitsSold()).append(this.unitsDelivered()),g=$('<a href="javascript:void(0)">view projects</a>'),h=$('<a href="javascript:void(0)">view analysis</a>'),i=$('<div class="pt_row loc-footer">').append($('<div class="pt_col-1-2">').append('<i class="pt pt-icon-info-circle"></i>').append(g)).append($('<div class="pt_col-1-2">').append('<i class="pt pt-icon-bar-chart-o"></i>').append(h)),j=this;return g.bind("click",function(){var b=j.data;return function(){a.$apply(function(){a.$broadcast("newCatchmentCall",!0),a.$broadcast("viewProjects",b)})}}()),h.bind("click",function(){var b=j.data;return function(){a.$apply(function(){a.$broadcast("newCatchmentCall",!0),a.$broadcast("viewAnalysis",b)})}}()),b.append(c).append(d).append(e).append(f).append(i),b},build:function(a){this.data=a;var b=this.parent();return b.append(this.buy()),b.append($('<span class="proj-count">').append(this.projectCount())),b.append($('<span class="onhover-popup">').append(this.label())),b.append(this.onClickPopup()),b}},i={parent:function(){var a=c(),b=this.data;return a.addClass("mrkr p-mrkr"),a.addClass(b.projectType),a.addClass("rate-color-"+b._rateColor),a.addClass("date-color-"+b._dateColor),a.addClass(b.displayPriceunitsClass),a.addClass(b.possessionDateClass),b.authorized||a.addClass("buyit"),b.projectSelected&&a.addClass("selected"),a.attr("id",b.selector),a},buy:function(){var a=d();return a.addClass("buy").append('<i class="pt pt-icon-shopping-cart"></i>'),a},pType:function(){var a=c(),b=this.data;return a.addClass("val").append('<i class="fs15p pt-icon-'+b.projectType+'"></i>'),a},selected:function(){return $('<div class="selected-icon"><i class="pt pt-icon-check"></i></div>')},fullName:function(){var a=d(),b=this.data;return a.addClass("put-ellipsis").text(b.fullName),a},builderName:function(){var a=d(),b=this.data;return a.addClass("proj-name displayBlock").text(b.builderName),a},projectName:function(){var a=d(),b=this.data;return a.addClass("proj-name").attr("title",b.name).text(b.name),a},build:function(a){this.data=a;var b=this.parent();return b.append(this.buy()).append(this.pType()).append(this.selected()).append($('<span class="onhover-popup">').append(this.fullName())),b}},j={parent:function(){var a=c(),b=this.type,d=this.data;return a.addClass("neighbour-icons"),a.addClass(b),a.attr("id",this.stringReplace(d.latitude,".","")+"-"+this.stringReplace(d.longitude,".","")),a.attr("data-toggle","tooltip"),a.attr("title",d.__tooltip__),a},stringReplace:function(a,b,c){return String(a).replace(b,c)},iconType:function(){return'<i class="fs0 pt pt-icon-'+this.iconName+'"></i>'},onHoverElem:function(){var a="",b=this.data,c='<span class="waiting"><span class="dstnc_wrap"><i class="pt pt-icon-road"></i><i class="pt pt-icon-cog pt-icon-spin"></i></span><span class="time_car_wrap"><i class="pr pt-icon-truck"></i><i class="pt pt-icon-cog pt-icon-spin"></i></span></span>';return b.__direction__&&(a=$('<div class="on-hov">'),a.append($('<span class="name" title="'+b.name+'">').html(b.name)),a.append(c)),a},build:function(a,b,c){this.data=a,this.type=b,this.iconName=c;var d=this.parent();return d.append(this.iconType()).append(this.onHoverElem()),d}},k={build:function(a){return j.build(a,"school","school")}},l={build:function(a){return j.build(a,"restaurant","restaurant")}},m={build:function(a){return j.build(a,"hospital","hospital")}},n={build:function(a){return j.build(a,"gas","petrol-station")}},o={build:function(a){return j.build(a,"bank","bank")}},p={build:function(a){return j.build(a,"airport","airport")}},q={build:function(a){return j.build(a,"bus-stop","bus-stop")}},r={build:function(a){return j.build(a,"train-station","train-station")}};return{school:k,restaurant:l,hospital:m,gas_station:n,bank:o,airport:p,bus_station:q,train_station:r,locality:f,project:g,b2b_locality:h,b2b_project:i}}])}),define("services/markerFactory",["app","services/maps/markerBuilder","services/maps/mapConfig"],function(a){a.factory("markerFactory",["$rootScope","$compile","MarkerBuilder","PtMapsConfig",function(a,b,c,d){var e={};return e.marker=function(a,b){this.type=a,this.data=b,this._callbacks={mouseEnter:[],mouseOut:[],click:[],resume:[]}},e.marker.prototype.init=function(a){var b=this,c=b.type+"Id",d="#"+b.type+"_"+b.data[c];b.elem=null,b.addBuilder(),b.mouseEnter(function(){b.elem||(b.elem=$(d)),b.elem.addClass("st-h"),("locality"===b.type||"project"===b.type)&&b.markerTracking("hover",b.type+" hovered",b.type,b.data)}),b.mouseOut(function(){b.elem.removeClass("st-h")}),b.click(function(){("locality"===b.type||"project"===b.type)&&b.markerTracking("clicked",b.type+" clicked",b.type,b.data)}),b.resume(function(){var a=b.elem.hasClass("st-c");a&&(b.elem.removeClass("st-c"),b.elem.addClass("st-v"))})},e.marker.prototype.destroy=function(){for(var a in this._callbacks)this._callbacks[a]=[];this._callbacks={},this.template=void 0,this.scope=void 0,this.data=void 0,this.builder=void 0,this.elem=void 0,this.type=void 0},e.marker.prototype.addCallback=function(a,b){return _.has(this._callbacks,a)||(this._callbacks[a]=[]),this._callbacks[a].push(b),this},e.marker.prototype.triggerEvent=function(a,b){var c=this;return $.each(this._callbacks[a],function(a,d){setTimeout(function(){d(c.data,b)},0)}),this},e.marker.prototype.addBuilder=function(){this.builder=c[this.type]},e.marker.prototype.mouseEnter=function(a){var b=_.toArray(arguments);return _.isEmpty(b)?this.triggerEvent("mouseEnter","MAP"):this.addCallback("mouseEnter",a),this},e.marker.prototype.mouseOut=function(a){var b=_.toArray(arguments);return _.isEmpty(b)?this.triggerEvent("mouseOut","MAP"):this.addCallback("mouseOut",a),this},e.marker.prototype.click=function(a){var b=_.toArray(arguments);return _.isEmpty(b)?this.triggerEvent("click","MAP"):this.addCallback("click",a),this},e.marker.prototype.resume=function(a){var b=_.toArray(arguments);return _.isEmpty(b)?this.triggerEvent("resume"):this.addCallback("resume",a),this},e.marker.prototype.markerTracking=function(b,c,e,f){var g,h=a.CURRENT_ACTIVE_PAGE,i={},j="MAP";"locality"==e?(g=e+"-"+j+"-"+h,i["Locality ID"]=f.localityId,i["City ID"]=f.cityId):(g=e+"-"+d.markerSettings.displayType+"-"+j+"-"+h,i["Project ID"]=f.projectId,i["View Type"]=d.markerSettings.displayType),"clicked"==b&&(i["Clicked From"]=j,i["Page Name"]=h,"undefined"!=typeof mixpanel&&mixpanel.people.increment(c))},e}])}),define("services/flags",["app"],function(a){a.factory("Flags",["$rootScope",function(a){var b={},c=function(a,c){b[a]=c},d=function(a){return b[a]},e=function(c,d){a.$broadcast(c+"Message",{value:b[c],extra:d})};return{set:c,get:d,broadcast:e}}])}),define("parsers/gridParser",["app"],function(a){a.factory("GridParser",[function(){return{parse:function(a,b){for(var c=[],d=function(b,c){a.indexOf(b)>-1&&(g[b]=c)},e=0;e<b.length;e++){var f=b[e],g={};$.each(f,d),c.push(g)}return c}}}])}),define("parsers/recentlyViewedParser",["app"],function(a){a.factory("RecentlyViewedParser",[function(){return{parse:function(a,b,c){var d,e=function(a){var b;return b=a>=1e7||-1e7>=a?Math.round(100*a/1e7)/100+"Cr":a>=1e5||-1e5>=a?Math.round(100*a/1e5)/100+"L":a},f={},g=[];for(d=0;d<a.length;d++){var h=a[d];f[a[d].projectId]={projectId:h.projectId,projectName:h.builder.name+", "+h.name,projectLocation:h.address,pricePerSqft:"undefined"==typeof h.minPricePerUnitArea||"undefined"==typeof h.maxPricePerUnitArea?"-":h.minPricePerUnitArea+" / sq ft - "+h.maxPricePerUnitArea+" / sq ft",price:"undefined"==typeof h.minPrice||"undefined"==typeof h.maxPrice?"-":e(h.minPrice)+" - "+e(h.maxPrice),projectUrl:h.URL,imageURL:h.imageURL,city:h.locality.suburb.city.label,locality:h.locality.label,minResaleOrPrimaryPrice:h.minResaleOrPrimaryPrice,maxResaleOrPrimaryPrice:h.maxResaleOrPrimaryPrice,hasPriceOnRequest:h.hasPriceOnRequest,compProject:h,cityId:h.cityId}}for(c>b.length&&(c=b.length),d=0;c>d;d++)f[b[d]]&&g.push(f[b[d]]);return g}}}])}),define("services/userService",["app","parsers/gridParser","formatters/common","parsers/recentlyViewedParser","services/notificationService","services/b2b/CookieService"],function(a){a.config(["$httpProvider",function(a){delete a.defaults.headers.common["X-Requested-With"]}]).factory("UserService",["$http","$cookies","$q","$rootScope","$location","GlobalService","GridParser","Formatter","RecentlyViewedParser","NotificationService","CookieService",function(a,b,c,d,e,f,g,h,i,j,k){var l="",m=function(a,b){if(a){b||(b=0);var c=a.toString(),d=k.get("RECENTLY_VIEWED_2");if(d){var e=d.split("-"),f=e.indexOf(c);0!==f&&(-1!==f&&e.splice(f,1),e.unshift(c)),e=e.slice(0,10),c=e.join("-")}k.set("RECENTLY_VIEWED_2",c)}},n=function(a,b){var d=[],e=k.get("RECENTLY_VIEWED_2");if(e&&(l=_.map(e.split("-"),function(a){return a=a.split(","),d[a[0]]=a[1],a[0]}).filter(function(a){return a.toString().trim()})),l){var h='data/v1/entity/project?selector={"filters":{"and":[{"equal":{"projectId":['+l.join(",")+']}}]},"fields":["cityId","projectId","localityId","name","builder","address","URL","maxPrice","minPrice","minResaleOrPrimaryPrice","maxResaleOrPrimaryPrice","minPricePerUnitArea","maxPricePerUnitArea","imageURL","locality","label","suburb","city","hasPriceOnRequest"]}';return f.makeGetCall(h,!1,!0,!0,!0).then(function(c){var e=i.parse(c.data.data,l,b);return e=_.map(e,function(a){return d[a.projectId]?a.typeId=d[a.projectId]:a.typeId=0,a}),a?g.parse(a,e):e})}var j=c.defer();return j.resolve([]),j.promise},o=function(a){return f.makeGetCall("data/v1/entity/user/{userId}/enquired-property",!1,!0,!0).then(function(b){return $.each(b.data.data,function(a,c){b.data.data[a].url="/"+c.projectUrl,b.data.data[a].name="Visit",c.cityName&&!c.projectName&&(b.data.data[a].url=c.cityName.replace(" ","-").toLowerCase()+"-real-estate",b.data.data[a].projectName="NA")}),g.parse(a,b.data.data)})},p=function(a,b){var c={username:a.trim(),password:b};return f.makePostCall("app/v1/login",c,"",!1,!0)},q=function(a,b,c,d,e){var g={fullName:a.trim(),password:d,confirmPassword:d,email:b,countryId:e,contactNumbers:[{contactNumber:c}]};return f.makePostCall("app/v1/register",g,"application/json",!0,!0)},r=function(a){return f.makePostCall("app/v1/reset-password?email="+encodeURIComponent(a),!1,"application/json",!1,!0)},s=function(a,b){return d.isProvider=!0,f.makePostCall("app/v1/login/"+b,a).then(function(a){return t(a),f.returnUserResp(a)})},t=function(a){if(a&&a.firstName){a.USERNAME=a.firstName+(a.lastName?a.lastName:""),a.CONTACT=a.contactNumber,a.EMAIL=a.email,a.COUNTRY_ID=a.countryId,d.userDetails=a;var b="Hi "+a.USERNAME+"! You have logged in successfully.";d.$broadcast("userLoggedIn"),d.$broadcast("$signupRes"),j.setNotification({msg:b,type:"info"})}},u=function(b){return a({method:"POST",url:"app/v1/login",data:$.param(b),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){return a})},v=function(a){var b="data/v1/entity/user/change-password";return f.makePostCall(b,a,-1,!0,!0,!0)};return{userLogin:p,userRegister:q,resetPassword:r,userInfo:t,checkUser:s,getRecentlyViewed:n,setRecentlyViewed:m,getEnquiredProperty:o,loginB2b:u,changePassword:v}}])}),define("services/mapOverlay",["app","services/maps/markerBuilder"],function(a){a.factory("mapOverlay",["$rootScope",function(a){var b={};return b.getOverlayClass=function(){var b,c=function(a,c,e){b=document.createDocumentFragment(),this._map=c,this._markers=a,this.map=c?c:null,this.shift={x:6,y:0};for(var f=0;f<this._markers.length;f++){var g=this._markers[f];if(g.markerEvents=[],d(g.data)){g.position=new google.maps.LatLng(g.data.latitude,g.data.longitude);var h=document.createElement("div");h.className=e?"measleMarker":"",h.style.borderStyle="none",h.style.borderWidth="0px",h.style.position="absolute",g.div=h;var i=angular.element(h);i.append(g.builder.build(g.data)),e&&(g.isMeasle=!0,$(h.children).addClass("measleMarker_dna")),b.appendChild(h)}}this.div=b},d=function(a){return a&&a.latitude&&a.longitude?!0:!1};return c.prototype=new google.maps.OverlayView,c.prototype.makeMeasles=!1,c.prototype.updateMeasles=function(){if(this._markers&&this._markers.length){for(var a,b=this,c=a=40,e=new Array,f=angular.element("#map_canvas").width(),g=angular.element("#map_canvas").height(),h=b.getProjection(),i=0;f/a>i;i++)e[i]=new Array;for(var i=0;i<this._markers.length;i++){var j=this._markers[i];if(d(j.data)){var k=new google.maps.LatLng(j.data.latitude,j.data.longitude),l=h.fromLatLngToContainerPixel(k),m=Math.floor(l.y/a)+(l.y%a?1:0),n=Math.floor(l.x/c)+(l.x%c?1:0);m=m?m-1:m,n=n?n-1:n;var o=document.getElementById(j.data.selector);$(o).removeClass("measleMarker_dna"),m>=0&&g/a>=m&&n>=0&&f/c>=n&&!e[m][n]?(e[m][n]=!0,j.isMeasle=!1):(j.isMeasle=!0,$(o).addClass("measleMarker_dna"))}}}},c.prototype.updateHeight=function(a){a.divHeight=$(a.div).height()},c.prototype.attachEvents=function(a){var b=this;if(0===a.markerEvents.length){var c,d,e;c=google.maps.event.addDomListener(a.div,"mouseover",function(){a.mouseEnter()}),d=google.maps.event.addDomListener(a.div,"mouseout",function(){a.mouseOut()}),a.markerEvents.push(c),a.markerEvents.push(d),a.click(function(){b.panToCenter(a)}),e=google.maps.event.addDomListener(a.div,"click",function(){a.click()}),a.markerEvents.push(e)}},c.prototype.panToCenter=function(a){if(!this.getProjection())return"";var b=this.getProjection(),c=b.fromLatLngToContainerPixel(a.position),d=$(".map_canvas_wrap"),e=$(".proj-card-wrap"),f=d.offset();this.limit=this.limit||{left:f.left+e.width()+50,right:f.left+d.width()-100,top:d.height()-100,bottom:100},(c.x<this.limit.left||c.x>this.limit.right||c.y<this.limit.bottom||c.y>this.limit.top)&&this.map.panTo(a.position)},c.prototype.detachFromPane=function(){this.div=$(this.div).detach()[0]},c.prototype.attachToPane=function(){var a=this.getPanes();a.overlayMouseTarget.appendChild(this.div)},c.prototype.removeEvents=function(){var a,b,c,d=function(a,b){google.maps.event.removeListener(b)};for(a=0,b=this._markers.length;b>a;a++)c=this._markers[a],$.each(c.markerEvents,d),c.markerEvents=[]},c.prototype.destroy=function(){this.setMap(null),this.removeEvents(),this.map=void 0,this._map=void 0,this._markers=[],this.makeMeasles=void 0},c.prototype.onAdd=function(b){var c,e,f;for(c=0,e=this._markers.length;e>c;c++)f=this._markers[c],d(f.data)&&this.attachEvents(f);b||a.$broadcast("mapMarkerAdd",{data:"add"}),this.attachToPane(),!b&&this.makeMeasles&&this.updateMeasles(this._markers,this._map)},c.prototype.draw=function(){var a,b,c,e,f=this.getProjection(),g="locality"===this._markers[0].type?29:20;for(this.detachFromPane(),c=0,e=this._markers.length;e>c;c++)if(b=this._markers[c],d(b.data)){var h=this.shift.x,i=this.shift.y,j=g;b.isMeasle&&(h=0,i=0,j=0),a=f.fromLatLngToDivPixel(b.position),b.div.style.left=a.x-h+"px",b.div.style.top=a.y-j-i+"px"}this.attachToPane()},c.prototype.onRemove=function(){var a,b,c;for(a=0,b=this._markers.length;b>a;a++)c=this._markers[a],d(c.data)&&(angular.element(c.div).find("a").unbind("click"),c.div.parentNode.removeChild(c.div),c.div=null,c.destroy(),c.position=void 0,c=void 0);this.div=null},c},b}])}),define("services/mapDirection",["app"],function(a){a.factory("mapDirection",[function(){var a,b,c={},d=[],e={hideRouteList:!0,suppressMarkers:!0,preserveViewport:!0,suppressInfoWindows:!0};return c.initialize=function(c){a=c,b=new google.maps.DirectionsService},c.create=function(c,f){for(var g=c.source,h=c.destination,i=0,j=d.length;j>i;i++)d[i].setMap(null);d=[];for(var i=0,j=h.length;j>i;i++){var k={origin:new google.maps.LatLng(g.lat,g.lng),destination:new google.maps.LatLng(h[i].lat,h[i].lng),travelMode:google.maps.TravelMode.DRIVING};d.push(new google.maps.DirectionsRenderer(e)),function(c,e,g){b.route(k,function(b,h){h===google.maps.DirectionsStatus.OK?(d[c].setDirections(b),d[c].setMap(a),f("OK",{mode:"DRIVING",distance:b.routes[0].legs[0].distance.text,duration:b.routes[0].legs[0].duration.text,lat:e,lng:g})):f("ERROR",{msg:"Error calculating direction"})})}(i,h[i].lat,h[i].lng)}},c.remove=function(){for(var a=0,b=d.length;b>a;a++)d[a].setMap(null);d=[]},c}])}),define("services/mapPlacesGeocoder",["app"],function(a){a.factory("mapPlacesGeocoder",[function(){var a,b,c={};return c.initialize=function(c){a=new google.maps.places.PlacesService(c),b=new google.maps.places.AutocompleteService},c.getSuggestions=function(a,c,d,e){var f=new google.maps.LatLng(parseFloat(a.latitude),parseFloat(a.longitude)),g=new google.maps.Circle({center:f,radius:e});b.getPlacePredictions({input:d,componentRestrictions:{country:"in"},bounds:g.getBounds()},function(a,b){"OK"==b?c("OK",{results:a}):c("ERROR",{msg:"Error fetching address"})})},c.getDetails=function(b,c){var d={placeId:b};a.getDetails(d,function(a,b){b==google.maps.places.PlacesServiceStatus.OK?c("OK",a.geometry.location):c("ERROR","Details not found.")})},c.fetchNearBy=function(b,c,d,e){var f=new google.maps.LatLng(parseFloat(b.lat),parseFloat(b.lng)),g={location:f};d?(g.keyword=d,g.key="AIzaSyBTrqqnHWF8jIxxi0XP7DHtkJAMOgGOw3E"):g.types=["establishment"],g.radius=e?e:"500",a.nearbySearch(g,function(a,b){b===google.maps.places.PlacesServiceStatus.OK?c("OK",{results:a}):e&&"ZERO_RESULTS"===b?c("ZERO_RESULTS",{msg:"No results found"}):c("ERROR",{msg:"Error fetching address"})})},c}])}),define("services/maps/customPlacesDirection",["app"],function(a){a.factory("customPlacesDirection",[function(){var a,b,c={};return c.initialize=function(c){a=new google.maps.DirectionsService,b=new google.maps.DirectionsRenderer,b.setMap(c)},c.fetchDirection=function(c,d,e,f){var g=new google.maps.LatLng(parseFloat(c.latitude),parseFloat(c.longitude)),h=new google.maps.LatLng(parseFloat(d.latitude),parseFloat(d.longitude)),i={origin:g,destination:h,travelMode:google.maps.TravelMode.DRIVING,provideRouteAlternatives:!0};a.route(i,function(a,c){c==google.maps.DirectionsStatus.OK?(b.setDirections(a),b.setPanel(document.getElementById(e)),f&&a.routes[0]&&a.routes[0].legs&&f(a.routes[0].legs[0])):console.log("directionsService error")})},c.removeDirection=function(){b&&b.set("directions",null)},c}])}),define("services/mapFilter",["app"],function(a){a.factory("mapFilter",["$rootScope",function(a){function b(a,b){return new google.maps.LatLng(a,b)}function c(){return[b(5,65),b(40,65),b(40,100),b(5,100)]}function d(a,c,d){for(var e=48,f=7,g=Math.PI/180,h=180/Math.PI,i=6371,j=Math.PI/2*(f/(e/4)),k=[Math.PI/2-j,Math.PI/2+j],l=[3*Math.PI/2-j,3*Math.PI/2+j],m=c/i*h,n=m/Math.cos(a.lat()*g),o={plot:[],bounds:new google.maps.LatLngBounds},p=1===d?0:e+1,q=1===d?e+1:0,r=p;1===d?q>r:r>q;r+=d){var s=Math.PI*(r/(e/2)),t=a.lng()+n*Math.cos(s),u=a.lat()+m*Math.sin(s);o.plot.push(b(u,t)),(s<k[0]||s>k[1])&&(s<l[0]||s>l[1])&&o.bounds.extend(o.plot[o.plot.length-1])}return o}function e(a){var b={plot:[],bounds:new google.maps.LatLngBounds};if(a&&e.length){b.plot=a;var c=a,d=new google.maps.LatLngBounds;angular.forEach(c,function(a,b){d.extend(a)}),b.bounds=d}return b}function f(a,b){if(!a||!b)return 0;var c=6371,d=(b.lat()-a.lat())*Math.PI/180,e=(b.lng()-a.lng())*Math.PI/180,f=Math.sin(d/2)*Math.sin(d/2)+Math.cos(a.lat()*Math.PI/180)*Math.cos(b.lat()*Math.PI/180)*Math.sin(e/2)*Math.sin(e/2),g=2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),h=c*g;return h}function g(a,b){var c=Math.pow(2,a.getZoom()),d=a.getProjection(),e=a.getBounds(),f=d.fromLatLngToPoint(new google.maps.LatLng(e.getNorthEast().lat(),e.getSouthWest().lng())),g=d.fromLatLngToPoint(b);return new google.maps.Point(Math.floor((g.x-f.x)*c),Math.floor((g.y-f.y)*c))}function h(){function b(b,d,f){var g=e([]);this.bounds=g.bounds,this.plot=g.plot,this.set("visible",!1);var h=this,i=c(),j=[i,h.plot],k=new google.maps.Polygon({map:b,paths:j,fillColor:"#fff",fillOpacity:.45,strokeWeight:0,strokePosition:google.maps.StrokePosition.OUTSIDE});k.bindTo("visible",h),a.onUpdatePolygonFilter&&a.onUpdatePolygonFilter(),a.onUpdatePolygonFilter=a.$on("updatePolygonFilter",function(a,c){var d=e(c);h.bounds=d.bounds,h.plot=d.plot,c=c&&c.length?c:[],j[1]=c,k.setPaths(j),b.fitBounds(h.bounds)}),h.destroy=function(){google.maps.event.clearInstanceListeners(k),k.setMap(null),this.mapPolygon=null}}return b.prototype=new google.maps.MVCObject,b}function i(){function e(e,h,i){function j(a,c){var d,e;a=a?a:p.bounds,d=r.getPosition().lat();var g=a.getSouthWest(),h=a.getNorthEast(),i=t.getPosition(),j=f(i,g),k=f(i,h),l=c||j>=k?h:g;return e=l.lng(),b(d,e)}function k(){var a=x.getBounds();
p.set("position",r.getPosition()),p.set("sizer_position",j(a))}function l(){var b=r.getPosition();o=d(b,h.distance,1);var c=o.plot;p.bounds=o.bounds,a.$broadcast("updateCircleFilter",c)}function m(){var a=r.getPosition(),b=t.getPosition(),c=f(a,b);c=c<=h.maxDistance?c:h.maxDistance,p.set("distance",c);var d=x.getBounds();p.set("sizer_position",j(d))}function n(){var b=r.getPosition(),c=p.get("distance");o=d(b,c,1);var e=o.plot;p.bounds=o.bounds,a.$broadcast("updateCircleFilter",e),p.set("sizer_position",j())}var o=d(i,h.distance,1);this.bounds=o.bounds,this.plot=o.plot,this.set("position",i),this.set("distance",h.distance),this.set("visible",!1);var p=this,q={x:24,y:24},r=new google.maps.Marker({map:e,flat:!0,cursor:"move",draggable:!0,raiseOnDrag:!1,zIndex:4,fillOpacity:.8,position:i,title:"Drag to change center",icon:{url:"/styles/images/sprite-map.png",size:new google.maps.Size(q.x,q.y),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(q.x/2,q.y/2),scaledSize:new google.maps.Size(24,80)}});r.bindTo("visible",p),r.bindTo("position",p);var s={x:24,y:24},t=new google.maps.Marker({map:e,flat:!0,draggable:!0,raiseOnDrag:!1,cursor:"col-resize",zIndex:10,icon:{url:"/styles/images/sprite-map.png",size:new google.maps.Size(s.x,s.y),origin:new google.maps.Point(0,28),anchor:new google.maps.Point(s.x/2,s.y/2),scaledSize:new google.maps.Size(24,80)}});t.bindTo("visible",p),t.bindTo("position",p,"sizer_position");var u=$('<div class="sizer-div circle-tooltip"></div>').append('<div>Showing projects within <span class="sizer-div-radius"></span> mtrs</div><div>Drag to extend/contract</div>'),v=function(){var a=Math.floor(1e3*p.get("distance")),b=new google.maps.LatLng(r.getPosition().lat(),t.getPosition().lng()),c=g(e,b),d=$(".sizer-div"),f=d.width(),h=d.height();d.css("top",c.y-h-19),d.css("left",c.x-.55*f),$(".sizer-div-radius").html(a)},w=!1;$(".map_canvas_wrap").append(u),google.maps.event.addListener(t,"drag",v),google.maps.event.addListener(t,"mouseover",function(){v(),$(".sizer-div").css("display","block")}),google.maps.event.addListener(t,"mousedown",function(){w=!0}),google.maps.event.addListener(t,"mouseup",function(){w=!1,$(".sizer-div").css("display","none")}),google.maps.event.addListener(t,"mouseout",function(){w||$(".sizer-div").css("display","none")});var x=new google.maps.Circle({map:e,center:i,radius:1e3*h.distance,fillOpacity:0,strokeWeight:1,zIndex:10,strokeOpacity:.8,strokeColor:"#2691ec",cursor:'url("//maps.gstatic.com/mapfiles/openhand_8_8.cur"), default',strokePosition:google.maps.StrokePosition.OUTSIDE});x.bindTo("visible",p),x.bindTo("center",p,"position"),p.distance_changed=function(){x.setRadius(1e3*p.get("distance"))},p.set("sizer_position",j());var y=p.get("distance");google.maps.event.addListener(r,"drag",k),google.maps.event.addListener(r,"dragend",function(){l(),google.maps.event.trigger(p,"state_changed",{action:"dragged",distance:y})}),google.maps.event.addListener(t,"drag",m),google.maps.event.addListener(t,"dragend",function(){n(),google.maps.event.trigger(p,"state_changed",{action:"changeRadius",distance:y})});var z=c(),A=[z,p.plot],B=new google.maps.Polygon({map:e,paths:A,fillColor:"#fff",fillOpacity:.45,strokeWeight:0,strokePosition:google.maps.StrokePosition.OUTSIDE});B.bindTo("visible",p),a.onUpdateCircleFilter&&a.onUpdateCircleFilter(),a.onUpdateCircleFilter=a.$on("updateCircleFilter",function(a,b){b=b&&b.length?b:[],A[1]=b,B.setPaths(A)}),p.updateMapFilter=function(a){var c=b(a.position.lat,a.position.lng);p.set("position",c),k(),l(),p.set("distance",a.distance),n(),p.set("sizer_position",j(p.bounds,!0)),google.maps.event.trigger(e,"resize"),e.fitBounds(p.bounds),e.setCenter(c)},p.destroy=function(){google.maps.event.clearInstanceListeners(x),google.maps.event.clearInstanceListeners(t),google.maps.event.clearInstanceListeners(r),u.remove(),x.setMap(null)}}return e.prototype=new google.maps.MVCObject,e}var j={};return j.getFilterClass=function(){function a(a,c,d){var e,f=c&&c.position&&c.position.lat&&c.position.lng?b(c.position.lat,c.position.lng):a.getCenter();return"arbitraryShape"===d?(e=h(),e=new e(a,c,f)):"circle"===d&&(e=i(),e=new e(a,c,f)),e}return a.prototype=new google.maps.MVCObject,a},j}])}),define("services/maps/svgOverlay",["app"],function(a){a.factory("svgOverlay",["$rootScope",function(a){var b={};return b.getSvgOverlay=function(){function b(b){var g=b.opacity||1;this.options_=b||{},c=this.options_.map,this.container_=document.createElement("div"),this.container_.setAttribute("id",b.id),this.container_.style.display="none",this.container_.style.position="absolute",this.container_.style.top=0,this.container_.style.left=0,this.container_.style.height=0,this.container_.style.width=0,this.options_.zIndex&&(this.container_.style.zIndex=this.options_.zIndex),this.options_.layer||(this.options_.layer="overlayMouseTarget"),d=b.leftTop,e=b.rightTop,f=b.leftBottom,f&&this.options_.content.match(/<svg/g)&&(this.setSvgContent(this.options_.content,g,c),a.$broadcast("masterPlanSvgAdded",b.id),this.setMap(c))}var c,d,e,f;b.prototype=new google.maps.OverlayView,b.prototype.getSvgWidthHeight=function(){var a={},b=g(d[0],d[1]),c=g(e[0],e[1]),h=g(f[0],f[1]);return a.width=c.x-b.x,a.height=h.y-b.y,a},b.prototype.onAdd=function(){this.getPanes()[this.options_.layer].appendChild(this.container_)},b.prototype.setSvgContent=function(a,b,c){this.container_.innerHTML=a,this.content_=a,this.svg_=this.container_.getElementsByTagName("svg")[0],this.svg_.setAttribute("opacity",b),this.draw()},b.prototype.getContent=function(){return this.content_},b.prototype.getContainer=function(){return this.container_},b.prototype.getSvg=function(){return this.svg_};var g=function(a,b){var d,e,f,g,h,i=256,j=new google.maps.LatLng(a,b);h=function(a,b,c){return null!=b&&(a=Math.max(a,b)),null!=c&&(a=Math.min(a,c)),a},d=function(a){return a*(Math.PI/180)},e=function(a){return a/(Math.PI/180)},g=function(){var a=1<<c.getZoom(),b=new f,d=b.fromLatLngToPoint(j),e=new google.maps.Point(d.x*a,d.y*a);return{x:e.x,y:e.y}};var f=function(){this.pixelOrigin_=new google.maps.Point(i/2,i/2),this.pixelsPerLonDegree_=i/360,this.pixelsPerLonRadian_=i/(2*Math.PI)};f.prototype.fromLatLngToPoint=function(a,b){var c=this,e=b||new google.maps.Point(0,0),f=c.pixelOrigin_;e.x=f.x+a.lng()*c.pixelsPerLonDegree_;var g=h(Math.sin(d(a.lat())),-.9999,.9999);return e.y=f.y+.5*Math.log((1+g)/(1-g))*-c.pixelsPerLonRadian_,e};var k=g();return k};return b.prototype.draw=function(){var a=this.getProjection(),b=this.container_.style;if(a&&this.svg_){var c=a.fromLatLngToDivPixel(new google.maps.LatLng(d[0],d[1])),e=this.getSvgWidthHeight();this.svg_.setAttribute("width",e.width),this.svg_.setAttribute("height",e.height),b.left=c.x+"px",b.top=c.y+"px"}},b.prototype.onRemove=function(){this.container_.parentNode.removeChild(this.container_)},b},b}])}),define("services/maps/mapDistanceMatrix",["app"],function(a){a.factory("mapDistanceMatrix",["$q",function(a){var b,c={};return c.initialize=function(a){b=new google.maps.DistanceMatrixService},c.fetch=function(c,d){var e,f=new google.maps.LatLng(c.latitude,c.longitude),g=new google.maps.LatLng(d.latitude,d.longitude),h={origins:[f],destinations:[g],travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.METRIC,avoidHighways:!1,avoidTolls:!1},i=a.defer();return b.getDistanceMatrix(h,function(a,b){e=b===google.maps.DistanceMatrixStatus.OK?{status:"OK",results:a}:{status:"ERROR",msg:"Error fetching results"},i.resolve(e)}),i.promise},c}])}),define("services/maps/polygonSimplificationAlogrithm",["app"],function(a){a.factory("simplifyPolygonPoints",[function(){return function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=Math.PI/180*.5,w=new Array,x=new Array,y=new Array;if(a.length<3)return a;for(c=a.length,l=360*b/(2*Math.PI*6378137),l*=l,e=0,x[0]=0,y[0]=c-1,d=1;d>0;)if(f=x[d-1],g=y[d-1],d--,g-f>1){for(m=a[g].lng()-a[f].lng(),n=a[g].lat()-a[f].lat(),Math.abs(m)>180&&(m=360-Math.abs(m)),m*=Math.cos(v*(a[g].lat()+a[f].lat())),o=m*m+n*n,h=f+1,i=f,k=-1;g>h;h++)p=a[h].lng()-a[f].lng(),q=a[h].lat()-a[f].lat(),Math.abs(p)>180&&(p=360-Math.abs(p)),p*=Math.cos(v*(a[h].lat()+a[f].lat())),r=p*p+q*q,s=a[h].lng()-a[g].lng(),t=a[h].lat()-a[g].lat(),Math.abs(s)>180&&(s=360-Math.abs(s)),s*=Math.cos(v*(a[h].lat()+a[g].lat())),u=s*s+t*t,j=r>=o+u?u:u>=o+r?r:(p*n-q*m)*(p*n-q*m)/o,j>k&&(i=h,k=j);l>k?(w[e]=f,e++):(d++,x[d-1]=i,y[d-1]=g,d++,x[d-1]=f,y[d-1]=i)}else w[e]=f,e++;w[e]=c-1,e++;for(var z=new Array,h=0;e>h;h++)z.push(a[w[h]]);return z}}])}),define("services/mapPolygonFactory",["app","services/maps/mapConfig"],function(a){a.factory("mapPolygonFactory",["$rootScope",function(a){var b={};return b.Polygon=function(a,b){this.data=a,this.type=b},b.Polygon.prototype.init=function(b){function c(a,b){var c=b.getProjection().fromLatLngToPoint(b.getBounds().getNorthEast()),d=b.getProjection().fromLatLngToPoint(b.getBounds().getSouthWest()),e=Math.pow(2,b.getZoom()),f=b.getProjection().fromLatLngToPoint(a);return new google.maps.Point((f.x-d.x)*e,(f.y-c.y)*e)}var d=this.type.fillColor||"#333",e=this.type.strokeColor||"#FFFFFF",f=this.type.strokeOpacity||.8,g=this.type.strokeWeight||1,h=this.type.fillOpacity||.5;this.mapPolygon=new google.maps.Polygon({paths:google.maps.geometry.encoding.decodePath(this.data.encodedPolygon),strokeColor:e,strokeOpacity:f,strokeWeight:g,fillColor:d,fillOpacity:h,data:this.data,type:this.type}),google.maps.event.addListener(this.mapPolygon,"mouseover",function(d){var e=c(d.latLng,b);a.$broadcast("polygonMouseOver",this,d,e),this.setOptions({fillOpacity:this.type.fillOpacity+.01})}),google.maps.event.addListener(this.mapPolygon,"mouseout",function(b){a.$broadcast("polygonMouseOut",this,b),this.setOptions({fillOpacity:this.type.fillOpacity})}),google.maps.event.addListener(this.mapPolygon,"mousemove",function(d){var e=c(d.latLng,b);a.$broadcast("polygonMouseMove",this,d,e)}),google.maps.event.addListener(this.mapPolygon,"click",function(b){a.$broadcast("polygonClick",this,b)}),this.mapPolygon.setMap(b)},b.Polygon.prototype.destroy=function(){this.data=null,this.type=null,this.mapPolygon.setMap(null),this.mapPolygon=null},b}])}),define("services/maps/timeSenseService",["app","services/maps/mapConfig","services/maps/mapDistanceMatrix","services/constants","services/mapPolygonFactory"],function(a){a.factory("timeSenseService",["$q","PtMapsConfig","$rootScope","mapPolygonFactory","mapDistanceMatrix","Constants",function(a,b,c,d,e,f){function g(a,c,d){var e,f,g,i=b.travelHeatMapConfig;a<i.timeSequence.length?(g=i.timeSequence[a],e=g.degree,f=g.time,h(c,f,0,e,d,a)):p.resolve()}function h(a,e,f,h,j,k){var l,o,p,r,s,t,u,v,w,x=b.travelHeatMapConfig.timeSequence[k];if(f<2*Math.PI)l=e*j*.8,t={latitude:a.latitude+l*Math.cos(f),longitude:a.longitude+l*Math.sin(f)},i(a,t,e,f,h,j,k,0),c.$broadcast("updateTimeSenseProgress",{config:x,progress:100*f/(2*Math.PI)});else{for(o=0,r=x.add.length;r>o;o++){for(u=[],p=0,s=m[x.add[o].limits[0]].length;s>p;p++)w=x.add[o].limits[0],v=new google.maps.LatLng(m[w][p].latitude,m[w][p].longitude),u.push(v);if(u.push(u[0]),2===x.add[o].limits.length)for(w=x.add[o].limits[1],v=new google.maps.LatLng(m[w][0].latitude,m[w][0].longitude),u.push(v),p=m[x.add[o].limits[1]].length-1;p>=0;p--)v=new google.maps.LatLng(m[w][p].latitude,m[w][p].longitude),u.push(v);n[x.add[o].range]=new d.Polygon({encodedPolygon:google.maps.geometry.encoding.encodePath(u)},x.add[o]),n[x.add[o].range].init(q),c.$broadcast("updateTimeSenseProgress",{config:x,progress:100})}x.removeRange&&(n[x.removeRange].destroy(),delete n[x.removeRange]),g(k+1,a,j)}}function i(a,b,c,d,f,g,h,i){e.fetch(a,b).then(function(e){if("ERROR"===e.status)return void p.reject(e);if(e.results.rows[0].elements[0].duration){var l,n;l=e.results.rows[0].elements[0].duration.text.split(" "),n=4===l.length?60*parseInt(l[0])+parseInt(l[2]):parseInt(l[0]),k(n,c,a,b,d,f,g,h,i)}else{var o,q,r,s,t,u,v,w,x,y=Object.keys(m),z=1/0,A=new google.maps.LatLng(b.latitude,b.longitude);if(!(y.length>1))return void p.reject(e);r=100;for(w in y)s=c-y[w],s>0&&r>s&&(r=s,q=y[w]);for(o=m[q],w=0,x=o.length;x>w;w++)v=new google.maps.LatLng(o[w].latitude,o[w].longitude),t=google.maps.geometry.spherical.computeDistanceBetween(A,v),z>t&&(z=t,u=w);b=j(b)?{latitude:o[u].latitude+g*Math.cos(d),longitude:o[u].longitude+g*Math.sin(d)}:{latitude:(b.latitude+o[u].latitude)/2,longitude:(b.longitude+o[u].longitude)/2},k(c,c,a,b,d,f,g,h,0)}})}function j(a){var b=new google.maps.LatLng(a.latitude,a.longitude),c=!1;for(var d in n)if(google.maps.geometry.poly.containsLocation(b,n[d].mapPolygon)){c=!0;break}return c}function k(a,c,d,e,f,g,k,l,n){var p,q=1,s=a-c,t=Math.abs(s);if(o)if(s>2)q=15>=c?1:Math.log2(a-c),p=k*q,e.latitude=e.latitude-p*Math.cos(f),e.longitude=e.longitude-p*Math.sin(f),setTimeout(function(){i(d,e,c,f,g,k,l,n)},100);else{if(t>2){if(c===b.travelHeatMapConfig.timeLimit&&n<=b.travelHeatMapConfig.repeatThreshHold)return q=Math.log2(t),p=k*q,e.latitude=e.latitude+p*Math.cos(f),e.longitude=e.longitude+p*Math.sin(f),void setTimeout(function(){i(d,e,c,f,g,k,l,n+1)},100);if(j(e))for(var u=0;u<b.travelHeatMapConfig.stepOutThreshold&&(e.latitude=e.latitude+2*k*Math.cos(f),e.longitude=e.longitude+2*k*Math.sin(f),j(e));u++);else e.latitude=e.latitude+2*k*Math.cos(f),e.longitude=e.longitude+2*k*Math.sin(f)}j(e)&&(r=!0),m[c]=m[c]||[],m[c].push(e),f+=g,h(d,c,f,g,k,l)}}function l(){var a,c,d=b.travelHeatMapConfig.fitBoundTimeKey,e=new google.maps.LatLngBounds;if(d&&m.hasOwnProperty(d)){c=m[d];for(var f=0,g=c.length;g>f;f++)a=new google.maps.LatLng(c[f].latitude,c[f].longitude),e.extend(a);a&&q.fitBounds(e)}}var m,n,o,p,q,r,s,t,u={};Math.log2=Math.log2||function(a){return Math.log(a)/Math.log(2)};var v=function(a){q=a},w=function(){var a,b,c,d,e,f,g,h,i;for(a in n)for(f=n[a].mapPolygon.getPath(),b=0;b<f.getLength();b++){e=f.getAt(b);for(c in n)if(i=!1,a!==c){for(h=n[c].mapPolygon.getPath(),d=0;d<h.getLength();d++)if(g=h.getAt(d),g.equals(e)){i=!0;break}if(i)continue;if(google.maps.geometry.poly.containsLocation(e,n[c].mapPolygon))return!0}}return!1},x=function(a){var f,g,h,i,j,k,l,m=b.travelHeatMapConfig.timeSequence,o={latitude:a.latitude,longitude:a.longitude},p=[];n={},r=!1;for(f in a.reachabilityInfo)for(g in m)for(h in m[g].add)f===m[g].add[h].range&&(n[f]=new d.Polygon({encodedPolygon:a.reachabilityInfo[f]},m[g].add[h]),n[f].init(q),p.push(m[g].add[h]));if(p=_.sortBy(p,function(a){return parseInt(a.range)}),r=w(),c.$broadcast("timeSenseStatus","preprocessed",{isPolygonOvelap:r,configs:p}),google.maps.event.addListener(q,"click",function(a){e.fetch(o,{latitude:a.latLng.lat(),longitude:a.latLng.lng()}).then(function(b){var d,e,f;"OK"===b.status&&b.results.rows[0].elements[0].duration&&b.results.rows[0].elements[0].duration.text&&(e=b.results.rows[0].elements[0].duration.text.split(" "),d=4===e.length?60*parseInt(e[0])+parseInt(e[2]):parseInt(e[0]),f=b.results.rows[0].elements[0].distance.text,c.$broadcast("mapClick",{type:{range:d,distance:f}},a))})}),google.maps.event.addListener(q,"drag",function(a){c.$broadcast("mapDrag")}),j=b.travelHeatMapConfig.fitBoundRange,l=new google.maps.LatLngBounds,j&&a.reachabilityInfo.hasOwnProperty(j)){for(k=google.maps.geometry.encoding.decodePath(a.reachabilityInfo[j]),f=0,i=k.length;i>f;f++)l.extend(k[f]);k&&k.length&&q.fitBounds(l)}},y=function(d){var f,h,i,j,k=[],v=b.travelHeatMapConfig,w=v.directions,x={latitude:d.latitude,longitude:d.longitude};for(h=0,j=w.length;j>h;h++)f={latitude:x.latitude+w[h].lat,longitude:x.longitude+w[h].lng},k.push(e.fetch(x,f));s=(new Date).getTime(),a.all(k).then(function(b){var f,h,k=0,s=0,w=0;for(p=a.defer(),o=!0,m={},n={},u={},r=!1,p.promise.then(function(a){c.$broadcast("timeSenseStatus","completed",{isPolygonOvelap:r}),google.maps.event.addListener(q,"click",function(a){e.fetch(x,{latitude:a.latLng.lat(),longitude:a.latLng.lng()}).then(function(b){var d,e,f;"OK"===b.status&&b.results.rows[0].elements[0].duration&&b.results.rows[0].elements[0].duration.text&&(e=b.results.rows[0].elements[0].duration.text.split(" "),d=4===e.length?60*parseInt(e[0])+parseInt(e[2]):parseInt(e[0]),f=b.results.rows[0].elements[0].distance.text,c.$broadcast("mapClick",{type:{range:d,distance:f}},a))})}),google.maps.event.addListener(q,"drag",function(a){c.$broadcast("mapDrag")}),l(),m=void 0;for(var b in n)u[b]=n[b].data.encodedPolygon;d.reachabilityInfo=u,d.reachabilityInfoCached=!0,t=(new Date).getTime()},function(a){o=!1,m=void 0,c.$broadcast("timeSenseStatus","failed"),t=(new Date).getTime()}),i=0,j=b.length;j>i;i++)"OK"===b[i].status&&b[i].results.rows[0].elements[0].duration&&(f=b[i].results.rows[0].elements[0].duration.text.split(" "),h=4===f.length?60*parseInt(f[0])+parseInt(f[2]):parseInt(f[0]),h&&(s+=1/h),w+=1);return w?(k=v.delta*s/w,void g(0,x,k)):void p.reject("Count :"+w)})},z=function(a){if(p&&p.reject(a),q){google.maps.event.clearListeners(q,"click"),google.maps.event.clearListeners(q,"drag");for(var b in n)n[b].destroy();n={},c.$broadcast("hideLocalityScoreCard")}};return{drawReachability:x,drawTimeSense:y,destroyPolygons:z,initialize:v}}])}),define("text!views/directives/common/pt-loading.html",[],function(){return'<div id="veil" data-ng-show="false"></div>\n<div id="feedLoading" data-ng-show="false" class="loadingArea">\n	<i></i>\n</div>\n'}),define("services/loadingService",["app"],function(a){a.factory("LoadingService",[function(){var a={};a.flag=!1;var b=function(){return a},c=function(){a.flag=!0},d=function(){a.flag=!1};return{showLoader:c,hideLoader:d,getLoadingFlag:b}}])}),define("directives/common/pt-loading",["app","text!views/directives/common/pt-loading.html","services/loadingService"],function(a,b){a.directive("ptLoading",["LoadingService",function(a){return{restrict:"A",template:b,controller:["$scope","LoadingService",function(a,b){a.loadingFlag={},a.loadingFlag=b.getLoadingFlag(),a.$watch("loadingFlag.flag",function(b,c){b!==c&&(a.loadingFlag=b)})}]}}])}),define("services/mapFactory",["app","services/mapOverlay","services/mapDirection","services/mapPlacesGeocoder","services/maps/customPlacesDirection","services/mapFilter","services/lazyLoadFactory","services/maps/mapConfig","services/maps/svgOverlay","services/globalService","services/maps/mapDistanceMatrix","services/maps/polygonSimplificationAlogrithm","services/maps/timeSenseService","directives/common/pt-loading"],function(a){a.factory("mapFactory",["$window","$rootScope","$timeout","mapOverlay","simplifyPolygonPoints","mapFilter","mapDirection","mapPlacesGeocoder","customPlacesDirection","PtMapsConfig","svgOverlay","GlobalService","mapDistanceMatrix","timeSenseService","lazyLoadFactory",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p={};p.includeJS=function(b){if(a.google)a.googleCallback=void 0,b();else{var c,d="//maps.googleapis.com/maps/api/js",e=[],f={v:"3",region:"in",sensor:!1,language:"en",libraries:["places","geometry","drawing"],callback:"googleCallback",key:"AIzaSyBTrqqnHWF8jIxxi0XP7DHtkJAMOgGOw3E"};$.each(f,function(a,b){b=b instanceof Array?b.join():b,e.push(a+"="+b)}),c=d+"?"+e.join("&"),a.googleCallback=b,o.loadOnWindowLoad({url:c})}},p.initialize=function(b,c){var e,k={zoom:b.zoom,zoomControl:b.zoomControl||!1,zoomControlOptions:b.zoomControlOptions||void 0,minZoom:5,panControl:!1,streetViewControl:!1,mapTypeControl:b.mapTypeControl||!1,mapTypeId:google.maps.MapTypeId.ROADMAP,scaleControl:b.scaleControl&&!0,scaleControlOptions:{position:google.maps.ControlPosition.TOP_LEFT},center:new google.maps.LatLng(b.center.lat,b.center.lng),styles:j.mapStyle.ptDefault};return e=new google.maps.Map(document.getElementById(c),k),a.Overlay||(a.Overlay=d.getOverlayClass()),a.Filter||(a.Filter=f.getFilterClass()),g.initialize(e),h.initialize(e),i.initialize(e),m.initialize(e),n.initialize(e),e},p.destroy=function(b,c){a.google&&(b&&google.maps.event.clearInstanceListeners(b),c&&google.maps.event.removeListener(c),google.maps.event.clearInstanceListeners(a),google.maps.event.clearInstanceListeners(document))},p.action={zoom:function(a,b){b=parseInt(b)?parseInt(b):10,a.setZoom(b)},zoomLevel:function(a,b,c){b=parseInt(b)?parseInt(b):10,c=parseInt(c)?parseInt(c):22;var d={minZoom:b,maxZoom:c};a.setOptions(d)},center:function(a,b){var c,d,e;c=parseFloat(b.lat)?parseFloat(b.lat):0,d=parseFloat(b.lng)?parseFloat(b.lng):0,e=new google.maps.LatLng(c,d),a.setCenter(e)},toggleMapOptions:function(a,b){b=b?!0:!1,a.setOptions({draggable:b,scrollwheel:b,disableDoubleClickZoom:b})},markers:{add:function(a,b){if(b&&b.length)for(var c=0;c<b.length;c++)b[c].init(a)},simple:function(a,b){for(var c,d=0;d<b.length;d++)c=b[d],new google.maps.Marker({position:new google.maps.LatLng(c.latitude,c.longitude),map:a,title:c.title})}},polygons:{add:function(a,b){if(b&&b.length)for(var c=0;c<b.length;c++)b[c].init(a)}},polygonFilter:{create:function(a,b){return Filter(a,b,"arbitraryShape")},setVisibility:function(a,b){a.set("visible",b)},destroy:function(a){a&&a.destroy()}},filter:{create:function(a,b){return Filter(a,b,"circle")},setVisibility:function(a,b){a.set("visible",b)},updateMapFilter:function(a,b){a.updateMapFilter(b)},destroy:function(a){a&&a.destroy()}},direction:{create:g.create,remove:g.remove},bounds:function(a,b,c,d){var e,f=new google.maps.LatLngBounds;c&&(f.extend(c.getCenter()),f.extend(c.getNorthEast()),f.extend(c.getSouthWest()));for(var g=0;g<b.length;g++)b[g].data.latitude&&b[g].data.longitude&&(e=new google.maps.LatLng(b[g].data.latitude,b[g].data.longitude),f.extend(e));d&&d.latitude&&d.longitude&&(e=new google.maps.LatLng(d.latitude,d.longitude),f.extend(e)),(e||c)&&a.fitBounds(f)},reverseGeocode:{fetch:h.fetchNearBy},routeDirection:{fetch:i.fetchDirection,remove:i.removeDirection},distanceMatrix:{fetch:m.fetch},timeSenseService:{destroyPolygons:n.destroyPolygons,drawReachability:n.drawReachability,drawTimeSense:n.drawTimeSense}};var q=function(a){var b=1;switch(a){case"landusage":b=.3;break;case"roads":b=.5;break;case"train":b=.5;break;case"drains_electric":b=.5}return b};return p.svgOverlay={init:function(a){var b,c=k.getSvgOverlay(),d=a.city?a.city.toLowerCase():"default";l.makeGetCall("svg/"+d+"/"+a.svgName+".svg",!1,!0,!0).then(function(d){b=new c({content:d.data,map:a.map,opacity:q(a.svgName),zIndex:a.zIndex||"auto",id:a.svgName||"default",leftTop:a.leftTop,rightTop:a.rightTop,leftBottom:a.leftBottom})})}},p.pencilDrawing={init:function(a,c){var d=this;j.mapConfig.state.polygonFilter.polygonExist=!1,a.setOptions({draggableCursor:"url(/styles/images/draw-map.png), default"}),google.maps.event.addListener(a,"mousedown",function(f){var g=d.polyline_obj;g&&(g.set("visible",!1),g.setMap(null),g=null),p.action.toggleMapOptions(a,!1),g=new google.maps.Polyline({map:a,strokeColor:"#2691ec",strokeOpacity:.5,strokeWeight:2,zIndex:1,clickable:!1}),google.maps.event.addListener(a,"mousemove",function(a){g.getPath().push(a.latLng),d.polyline_obj=g}),google.maps.event.addListener(a,"mouseup",function(f){google.maps.event.clearListeners(a,"mousemove");var h=d.currentPolygon,i=g.getPath();if(g.set("visible",!1),g.setMap(null),!(i&&i.length<3)){a.setOptions({draggableCursor:"null"});var j=i.j,k=e(j,50);p.action.toggleMapOptions(a,!0),google.maps.event.clearListeners(a,"mousedown"),h&&d.removePolygon(a);var l={map:a,fillOpacity:0,strokeColor:"#2691ec",strokeOpacity:.5,strokeWeight:2,clickable:!1,zIndex:1,suppressUndo:!0,path:k,editable:!0},m=new google.maps.Polygon(l);h=m,b.$broadcast("showPolygonFilter",!0),m.bindTo("visible",c),d.setPolygonPaths(m.getPath()),d.currentPolygon=m,google.maps.event.addListener(m.getPath(),"set_at",function(a){d.setPolygonPaths(this)}),google.maps.event.addListener(m.getPath(),"insert_at",function(a){d.setPolygonPaths(this)}),google.maps.event.clearListeners(a,"mouseup")}})})},currentPolygon:null,polyline_obj:null,setPolygonPaths:function(a){var d=1,e={},f=a,g=new google.maps.LatLngBounds;f.forEach(function(a,b){g.extend(a)}),e={lat:g.getCenter().lat(),lng:g.getCenter().lng()},a.forEach(function(b,c){var f=j.distanceBetweenPoints({lat:e.lat,lng:e.lng},{lat:a.getAt(c).lat(),lng:a.getAt(c).lng()});f>d&&(d=f)});var h=j.mapConfig.state.polygonFilter.state.maxDistance;if(d>h)return void b.$broadcast("maxRadiusLimitExceeded");j.mapConfig.state.polygonFilter.state.position=e,j.mapConfig.state.polygonFilter.state.distance=d,a&&a.length&&b.$broadcast("updatePolygonFilter",a);var i=google.maps.geometry.encoding.encodePath(a);c(function(){b.$broadcast("setUrlPolygonPath",i)},0)},removePolygon:function(a){var d=this.currentPolygon;c(function(){b.$broadcast("setUrlPolygonPath",null)},0),this.currentPolygon=null,d&&(d.setMap(null),google.maps.event.clearInstanceListeners(d),this.currentPolygon=null)}},p.bind={zoom:function(a,b){google.maps.event.addListener(a,"zoom_changed",function(){b(a.getZoom())})},center:function(a,b){google.maps.event.addListener(a,"center_changed",function(){var c=a.getCenter(),d={lat:c.lat(),lng:c.lng()};b(d)})},filter:function(a,b){a.addListener("state_changed",function(){var c=a.get("position"),d=a.get("distance");b(c.lat(),c.lng(),d)})}},p}])}),define("parsers/projectParser",["app","formatters/common","services/constants","services/globalService"],function(a){"use strict";a.factory("ProjectParser",["$filter","Formatter","Constants","GlobalService",function(a,b,c,d){var e=(a("removePrefix"),a("priceFormat")),f=a("dateFormat"),g=a("rateColor"),h=a("dateColor"),i=a("score"),j=a("formatGraphPrice"),k=a("formatGraphPriceHover"),l=a("formatSoldPercentage"),m=a("formatSoldPercentageHover");return{mergePriceTrendData:function(a,b){var c={};return b&&a.keys&&a.keys.length>2&&(c={keys:a.keys,projectAvg:a.avg,avg:[]},$.each(a.keys,function(a,d){var e=b.keys.indexOf(d);-1===e?c.avg.push(null):c.avg.push(b.avg[e])})),c},getResaleDropdown:function(a){for(var b,c=["All"],d=0;d<a.length;d++)b=_.keys(a[d])[0],b&&c.push(b+" BHK");return c},praseResaleListings:function(a,c){var e=[];return c=c?c:250,a&&_.each(a,function(a){a.images&&a.images.length&&(a.mainImage=a.images[0]),a.property.project&&a.property.project.projectStatus&&(a.property.project.projectStatus=b.getProjectStatusKey(a.property.project.projectStatus)),a.property.project&&a.property.project.possessionDate&&(a.property.project.possessionDate=("Ready to Move In"==a.property.project.projectStatus?"Since ":"Possession by ")+f(a.property.project.possessionDate)),a.description&&(a.smallDesc=d.stripContent(a.description,!0,0,c).mediumDescription),a.imageCount&&(a.isUIVerified=!0),a.videos&&(a.mainImage={},a.mainImage.absolutePath=a.videos[0].imageUrl),e.push(a)}),e},addResaleInfo:function(a,c,e){var g=[],h=[];return c?_.each(c,function(c){c.data&&c.data.length&&_.each(c.data,function(e){e.propertyId==a.propertyId&&(a.totalResaleListings=c.totalCount,e.images&&e.images.length&&(e.mainImage=e.images[0]),e.description&&(e.smallDesc=d.stripContent(e.description,!0,0,250).mediumDescription),e.property.project&&e.property.project.projectStatus&&(e.property.project.projectStatus=b.getProjectStatusKey(e.property.project.projectStatus)),e.property.project&&e.property.project.possessionDate&&(e.property.project.possessionDate=("Ready to Move In"==e.property.project.projectStatus?"Since ":"Possession by ")+f(e.property.project.possessionDate)),e.imageCount?(e.isUIVerified=!0,g.push(e)):h.push(e),e.videos&&(e.mainImage={},e.mainImage.absolutePath=e.videos[0].imageUrl))})}):e&&e.data&&e.data.listings&&_.each(e.data.listings,function(c){c.propertyId==a.propertyId&&(a.totalResaleListings=e.totalCount,c.images&&c.images.length&&(c.mainImage=c.images[0]),c.property.project&&c.property.project.projectStatus&&(c.property.project.projectStatus=b.getProjectStatusKey(c.property.project.projectStatus)),c.property.project&&c.property.project.possessionDate&&(c.property.project.possessionDate=("Ready to Move In"==c.property.project.projectStatus?"Since ":"Possession by ")+f(c.property.project.possessionDate)),c.description&&(c.smallDesc=d.stripContent(c.description,!0,0,250).mediumDescription),c.imageCount?(c.isUIVerified=!0,g.push(c)):h.push(c))}),a.resaleInfo=g.concat(h),a},catagoriesProperty:function(a,c,d){var f,g,h={},i=this;return _.each(a,function(a){g=a.budget?a.budget:a.resalePrice,a.emi=b.formatRs(b.getEMI(e(g,0),c)),a.size?a.orig_size=a.size:a.carpetArea&&(a.orig_size=a.carpetArea),a.media&&a.media.length&&$.each(a.media,function(b,c){"3DFloorPlan"==c.objectMediaType.type.replace(/ /g,"")&&(a.has3D=!0)}),a.imageToShow=a.images?a.images[0]:a.media?a.media[0]:null,a.imageToShow&&(a.imageToShow.text=a.images?a.images[0].altText:""),a.video&&a.video.length?(a.imageToShow&&(a.imageToShow.showingImage=a.video[0].imageUrl),a.enable2D=!0,a.enable3D=!0,a.hasVideo=!0):a.media&&a.media.length&&$.each(a.media,function(b,c){return"3DFloorPlan"==c.objectMediaType.type.replace(/ /g,"")?(a.imageToShow&&(a.imageToShow.showingImage=c.absoluteUrl),a.enable2D=!0,void(a.enable3D=!1)):void 0}),!a.images||!a.images.length||a.has3D||a.video&&a.video.length||(a.enable3D=!0,a.enable2D=!1,a.imageToShow.showingImage=a.images[0].absolutePath),a.imageAltText=a.images?a.images[0].altText:"",a=d?i.addResaleInfo(a,d):a,f=a.bedrooms+"BHK",h[f]="undefined"==typeof h[f]?{}:h[f],h[f].minSize="undefined"==typeof h[f].minSize?a.orig_size:h[f].minSize,h[f].data="undefined"==typeof h[f].data?[]:h[f].data,h[f].data.push(a),h[f].count?h[f].count=h[f].count+1:h[f].count=1}),h},parseNeighborhood:function(a){var b={};return $.each(a,function(a,c){b[c.localityAmenityTypes.name]?b[c.localityAmenityTypes.name].count++:(b[c.localityAmenityTypes.name]={},b[c.localityAmenityTypes.name].count=1,b[c.localityAmenityTypes.name].displayName=c.localityAmenityTypes.description)}),b},parseSpecifications:function(a){var b={doors:{},fittingsAndFixtures:{},flooring:{},walls:{}};return a&&($.each(a,function(a,c){b.hasOwnProperty(a)?$.each(c,function(c,d){d&&(b[a][c]=d)}):b[a]=c}),$.each(b,function(a,c){("object"==typeof b[a]&&$.isEmptyObject(b[a])||0===b[a].length)&&delete b[a]})),b},parseAmenities:function(a){var b,c=[],d=[];if(a&&a.length){for(var e=0,f=a.length;f>e;e++){var g=a[e];"Oth"===g.amenityMaster.abbreviation?(d.push(g.amenityDisplayName),b=g):c.push(g)}d.length&&(b.amenityDisplayName=d.join(", "),c.push(b))}return c},parseProjectRating:function(a){switch(a){case 1:a="Terrible";break;case 2:a="Poor";break;case 3:a="Average";break;case 4:a="Good";break;case 5:a="Excellent";break;default:a=""}return a},parseStats:function(a){var b,d,e,f=-(1/0),g=-(1/0),h=1/0,i=1/0,j={pricePerUnitArea:{min:void 0,max:void 0},possessionDate:{min:void 0,max:void 0}};for(d=0,e=a.data.items.length;e>d;d++)b=a.data.items[d],f<b.minPricePerUnitArea&&b.latitude&&(f=b.minPricePerUnitArea),g<b.possessionDate&&b.latitude&&(g=b.possessionDate),h>b.minPricePerUnitArea&&b.latitude&&(h=b.minPricePerUnitArea),i>b.possessionDate&&b.latitude&&(i=b.possessionDate);return i<c.JAN2012&&(i=c.JAN2012),f!=-(1/0)&&h!=1/0&&(j.pricePerUnitArea={max:f,min:h}),g!=-(1/0)&&i!=1/0&&(j.possessionDate={max:g,min:i}),j},parseProject:function(a,c,d){var n={};if(n.projectId=a.projectId,n.landmarkImageTypeCount=a.landmarkImageTypeCount,n.cityId=a.locality.suburb.city.id,n.localityId=a.locality.localityId,n.selector="project_"+a.projectId,n.discussions=a.totalProjectDiscussion,n.name=a.name,n.builderName=a.builder.name,n.imageURL=a.imageURL,n.projectStatus=b.getProjectStatusKey(a.projectStatus?a.projectStatus.toLowerCase():""),n.address=a.address,n.completeProjectAddress=a.completeProjectAddress,n.projectBuilderContact=a.projectBuilderContact,n.supply=a.supply?a.supply:"NA",n.offer=a.offer,n.builder=a.builder,n.locality=a.locality,n.builderMarketingShare=a.builderMarketingShare,n.isRedevelopementProject=a.isRedevelopementProject,a.livabilityScore&&(n.livabilityScore=parseFloat(a.livabilityScore).toFixed(1)),a.safetyScore&&(n.safetyScore=parseFloat(a.safetyScore).toFixed(1)),n.dominantUnitType=a.dominantUnitType,n.locality.ratings={averageRating:n.locality.averageRating,ratingsCount:n.locality.ratingsCount,numberOfUsersByRating:n.locality.numberOfUsersByRating
},n.latitude=a.latitude,n.longitude=a.longitude,a.latitude&&a.longitude||(n.unMapped=!0),n.fullName=a.builder.name+" "+n.name,a.dominantUnitType&&(n.projectType=a.dominantUnitType.toLowerCase()),n.propertyUnitTypes=a.propertyUnitTypes,n.minPrice=e(a.minPrice,0,void 0,"L"),n.maxPrice=e(a.maxPrice,0,void 0,"L"),n.launchDateTstamp=a.launchDate,n.launchDate=f(a.launchDate),n.distinctBedrooms=a.distinctBedrooms,n.propertySizeMeasure=a.propertySizeMeasure,n.URL=a.URL,n.authorized=a.authorized,n.avgPricePerUnitArea=a.avgPricePerUnitArea,n.resalePricePerUnitArea=a.resalePricePerUnitArea,n.avgPriceDeviation=b.roundDoubleDecimal((n.locality.avgPricePerUnitArea-n.avgPricePerUnitArea)/n.locality.avgPricePerUnitArea*100),n.resaleEnquiry=a.resaleEnquiry,n.totalUnitsHtml="",a.totalUnits?(n.totalUnits=a.totalUnits,n.totalUnitsHtml=n.totalUnits+" Units Launched"):(n.totalUnits="NA",n.totalUnitsHover="Coming soon"),a.totalUnits&&(n.totalSold=Math.round((a.totalUnits-a.derivedAvailability)/a.totalUnits*100)),isNaN(n.totalSold)?n.totalSoldHtml="":n.totalSoldHtml=n.totalSold+"% Sold",n.totalSold=l(n.totalSold,a.derivedAvailability,n.projectStatus),n.totalSoldHover=m(n.totalSold,a.derivedAvailability,n.projectStatus),n.derivedAvailability=a.derivedAvailability,a.reachabilityInfo&&(n.reachabilityInfo=JSON.parse(decodeURIComponent(a.reachabilityInfo))),n.minResalePrice=e(a.minResalePrice,0,void 0,"L"),n.maxResalePrice=e(a.maxResalePrice,0,void 0,"L"),n.orgAvgPricePerUnitArea=a.avgPricePerUnitArea?a.avgPricePerUnitArea:a.resalePricePerUnitArea,n.minPricePerUnitArea=e(a.minPricePerUnitArea),n.maxPricePerUnitArea=e(a.maxPricePerUnitArea),n.maxResaleOrPrimaryPrice=a.maxResaleOrPrimaryPrice,n.minResaleOrPrimaryPrice=a.minResaleOrPrimaryPrice,n.projectLocalityScore=a.projectLocalityScore,n.projectSocietyScore=a.projectSocietyScore,n.projectSafetyRank=a.projectSafetyRank,n.isResale=a.isResale,n.isPrimary=a.isPrimary,n.isSoldOut=a.isSoldOut,n.projectLivabilityRank=a.projectLivabilityRank,n.possessionDate=f(a.possessionDate),n.possessionFullYear=parseInt(f(a.possessionDate,"yyyy"),10),n.possessionDateTstamp=a.possessionDate,n.avgPriceRiseMonths=a.avgPriceRiseMonths,n.avgPriceRiseMonthsHtml="in past "+a.avgPriceRiseMonths+" months",n.avgPriceRisePercentage=a.avgPriceRisePercentage,n.projectRating=this.parseProjectRating(parseInt(a.locality.averageRating)),n.imageThumbUrl=b.getImagePath(a.imageURL,"THUMBNAIL"),n.has3DImages=a.has3DImages,n.landmarkImages=a.landmarkImages,n.livabilityDeviation=b.roundDoubleDecimal((n.projectLocalityScore-n.livabilityScore)/n.projectLocalityScore*100),n.bCrum=[{text:"India Property",link:"/",target:"_self"},{text:"Property in "+n.locality.suburb.city.label,link:n.locality.suburb.city.overviewUrl,display:!0},{text:"Property in "+n.locality.label,link:n.locality.overviewUrl,display:!0},{label:"project",text:n.builderName+" "+n.name,link:n.URL}],n.lastUpdatedAt=a.lastUpdatedDate,void 0!==d){var o=d.pricePerUnitArea,p=d.possessionDate;o&&o.min&&o.max?n._rateColor=g(a.minPricePerUnitArea,o.min,o.max):n._rateColor=g(a.minPricePerUnitArea,void 0,void 0),p&&p.min&&p.max?n._dateColor=h(a.possessionDate,p.min,p.max):n._dateColor=h(a.possessionDate,void 0,void 0)}a.images&&(n.images=a.images),a.projectAmenities&&(n.amenities=this.parseAmenities(a.projectAmenities)),a.neighborhood&&(n.neighborhood=this.parseNeighborhood(a.neighborhood)),a.specifications&&(n.specifications=this.parseSpecifications(a.specifications)),a.description&&a.description.length>500?(n.projectDescriptionFull=a.description,n.projectDescriptionSmall=b.stripHtml(a.description).substring(0,300)+"... "):n.projectDescriptionSmall=a.description,a.loanProviderBanks&&(n.loanProviderBanks=a.loanProviderBanks),n.projectSize=a.sizeInAcres?a.sizeInAcres+" Acres":"NA";var q=a.propertyUnitTypes;q&&1==q.length&&"Plot"==q[0]&&(n.hasOnlyPlots=!0),n.hasResaleProperty=!1,n.showPricePerAreaCheckbox=!1,n.properties=a.properties,c&&a.properties&&_.each(n.properties,function(a){var b=a.size?"("+a.size+" "+a.measure+")":"";a.compareLabel=n.hasOnlyPlots?"Plot "+b:a.unitName+" "+b,a.compareBathroomsLabel=n.hasOnlyPlots?"NA":a.bathrooms,a.size=e(a.size),a.pricePerUnitArea=e(a.pricePerUnitArea),a.resalePricePerUnitArea=e(a.resalePricePerUnitArea),n.hasResaleProperty=n.hasResaleProperty||a.resalePrice?!0:!1,n.showPricePerAreaCheckbox=a.budget||a.resalePrice?!0:n.showPricePerAreaCheckbox}),a.offers&&(n.offers=a.offers),a.minSize&&(n.minSize=e(a.minSize)),a.maxSize&&(n.maxSize=e(a.maxSize)),a.maxPrice&&a.minPrice?n.minMaxPrice=a.minPrice+" - "+a.maxPrice:n.minMaxPrice="Not specified",a.maxSize&&a.minSize?n.minMaxSize=n.minSize+" - "+n.maxSize:n.minMaxSize="Not specified";var r=n.distinctBedrooms.indexOf(0);r>=0&&n.distinctBedrooms.splice(r,1),n.bhkInfo="",n.distinctBedrooms.length&&(n.bhkInfo+=n.distinctBedrooms.join(",")+" BHK "),n.bhkInfo+=n.propertyUnitTypes.join(","),n.newPriceHtml="Price On Request",n.minPrice&&n.maxPrice&&(n.newPriceHtml='<i class="pt pt-icon-inr"></i><span>'+n.minPrice+'</span> - <i class="pt pt-icon-inr"></i><span>'+n.maxPrice+"</span>"),n.isResale&&(n.minResalePrice&&n.maxResalePrice?n.resalePriceHtml='<i class="pt pt-icon-inr"></i><span>'+n.minResalePrice+'</span> - <i class="pt pt-icon-inr"></i><span>'+n.maxResalePrice+"</span>":n.resalePriceHtml="Price On Request"),n.sizeHtml="Size On Request";var s=n.propertySizeMeasure?n.propertySizeMeasure:"sq ft";return a.minSize&&a.maxSize&&(a.minSize!=a.maxSize?n.sizeHtml=n.minSize+" "+s+" - "+n.maxSize+" "+s:n.sizeHtml=n.maxSize+" "+s),n.displayPriceunitsHtml=n.displayPriceunitsHtmlMarker="",a.minPricePerUnitArea&&"NA"!==n.minPricePerUnitArea?n.displayPriceHtml='<i class="pt pt-icon-inr"></i><span>'+n.minPricePerUnitArea+"</span>":(n.displayPriceClass="rna",n.displayPriceHtml=""),n._scoreColor=i(a.livabilityScore,1,10),a.livabilityScore&&"NA"!==a.livabilityScore?n.livabilityScoreHtml=a.livabilityScore+"/10":(n.livabilityScoreClass="sna",n.livabilityScoreHtml=""),n.displayPriceunitsClass="rna",n.displayPriceunitsHtmlHover=k(a.avgPricePerUnitArea,a.derivedAvailability,n.projectStatus,a.resalePricePerUnitArea),n.displayPriceunitsHtml=j(a.avgPricePerUnitArea,a.derivedAvailability,n.projectStatus,a.resalePricePerUnitArea),isNaN(n.displayPriceunitsHtml)?n.displayPriceunitsHtmlMarker=n.displayPriceunitsHtml:(a.avgPricePerUnitArea?n.displayPriceunitsHtml=e(n.displayPriceunitsHtml,void 0,void 0,void 0,-1):n.displayPriceunitsHtml=e(n.displayPriceunitsHtml,void 0,void 0,void 0,-1)+" (R)",n.displayPriceunitsHtmlMarker='<i class="pt pt-icon-inr"></i><span>'+n.displayPriceunitsHtml+"</span>/"+s),n.possessionDateHtml=n.possessionDate,a.possessionDate&&"NA"!==n.possessionDate||(n.possessionDateClass="dna",n.possessionDateHtml=""),n.URL=a.URL,n.builderNameHtml='Builder: <span style="padding-left:2px;">'+n.builderName+"</span>",n.avgPriceRisePercentageHtml="",n.avgPriceRisePercentage&&(n.avgPriceRisePercentage>0?n.avgPriceRisePercentageHtml='<i class="pt pt-icon-arrow-up"></i>'+n.avgPriceRisePercentage+"%<small>in last 6 months</small>":n.avgPriceRisePercentageHtml='<i class="pt pt-icon-arrow-down"></i>'+-1*n.avgPriceRisePercentage+"%<small>in last 6 months</small>"),n.maxDiscount=e(a.maxDiscount,void 0,void 0,void 0,-1),n.isCouponAvailable=a.isCouponAvailable,n.couponsInventoryLeft=a.couponsInventoryLeft,n.minDiscountPrice=e(a.minDiscountPrice,0),n.maxDiscountPrice=e(a.maxDiscountPrice,0),n.numberOfTowers=a.numberOfTowers,n.hasTownship=a.hasTownship,n.avgFlatsPerFloor=a.avgFlatsPerFloor,n.delayInMonths=a.delayInMonths,n.avgLoadingPercentage=a.avgLoadingPercentage,n.hasProjectInsightReport=a.hasProjectInsightReport,n},parseDiscussed:function(a,c){c||(c=4);for(var d=[],e=0;e<a.length&&c>e;e++)d.push({projectId:a[e].projectId,url:a[e].URL,name:(a[e].builder?a[e].builder.name+" ":"")+a[e].name,minprice:a[e].minPrice?b.formatPrice(a[e].minPrice):"",maxprice:a[e].maxPrice?b.formatPrice(a[e].maxPrice):"",subName:a[e].totalProjectDiscussion?a[e].totalProjectDiscussion:"",subSubName:a[e].address,avgPriceRisePercentage:a[e].avgPriceRisePercentage?parseFloat(a[e].avgPriceRisePercentage).toFixed(1):0,avgPriceRiseMonths:a[e].avgPriceRiseMonths,propertyId:a[e].projectId,imageUrl:a[e].imageURL,altText:a[e].mainImage?a[e].mainImage.altText:""});return d},demandVsProjectParser:function(a,b,c){var d=0,e=[],f=[],g=[],h=[];_.each(a,function(a){e.push(a[0].extraAttributes.sumDemand)}),_.map(e,function(a){d+=a}),_.each(a,function(a){100*a[0].extraAttributes.sumDemand/d>=0&&(a[0].projectId===b?f.push({percentage:100*a[0].extraAttributes.sumDemand/d,project:a[0].projectName}):h.push({percentage:100*a[0].extraAttributes.sumDemand/d,project:a[0].projectName}))});var i=_.sortBy(h,"percentage"),j=i.reverse();return _.each(j,function(a,b){c>b&&f.push({percentage:a.percentage,project:a.project})}),g.xAxis=_.pluck(f,"project"),g.yAxis=_.pluck(f,"percentage"),g},scatterDiagramParser:function(a){var c=[],d=new Date;return _.each(a,function(a){var e=new Date(a.possessionDate-d.getTime()).getFullYear()-1970,f=a.projectStatus,g=a.locality.avgPricePerUnitArea-a.avgPricePerUnitArea,h=b.roundDoubleDecimal(Math.abs(g));"undefined"!=typeof a.minPricePerUnitArea&&("Under Construction"===a.projectStatus?(f="&gt;2 yrs to completion",0===e?f="&lt;1 yrs to completion":1===e&&(f="1-2 yrs to completion")):"Launch"===a.projectStatus?f="Lauching soon":"Completed"===a.projectStatus?f="Ready to move in":"Pre Launch"===a.projectStatus&&(f="New launch"),c.push({projectId:a.projectId,projectName:a.builder.name+" "+a.name,possessionDate:a.possessionDate,projectStatus:a.projectStatus,minPricePerUnitArea:a.minPricePerUnitArea,yearsApart:e,drawProjectStatus:f,viewCurrentStatus:b.getProjectStatusKey(a.projectStatus),locAvgPricePerUnitArea:h,priceStatusByLoc:g>0?"underpriced":"overpriced"}))}),c}}}])}),define("directives/maps/pt-map",["app","services/pageSettings","services/mapFactory","services/maps/mapConfig"],function(a){a.directive("ptMap",["$rootScope","pageSettings","mapFactory","PtMapsConfig","$q",function(a,b,c,d,e){return{restrict:"EAC",scope:{},template:"<div></div>",link:function(e,f,g){function h(a,b){return new google.maps.LatLng(+a,+b)}var i,j,k,l,m,n,o,p,q=[];e.displaySettings=b.displaySettings,e.state=d.mapConfig.state,e.events=d.mapConfig.events,e.services=d.mapConfig.services;var r=d.mapStyle,s=d.projectDetailCardConfig;c.pencilDrawing.currentPolygon=null,e.state.polygonFilter.polygonExist=!1,e.state.polygonFilter.visible=!1,e.state.polygonFilter.currentDrawingStatus=!1,d.markerSettings.displayType="type",s.currentActiveTab=!1,e.state.neighbourhood={locality:{},project:{}},e.neighbourhoodOverlay={locality:{},project:{}},$(document).on("mouseenter","polygon, polyline, line, path",function(b){b.stopPropagation();var c=angular.element(this).attr("data-toolTipName")||null,d=angular.element(this).attr("data-pathType")||null;c&&""!=c&&a.$broadcast("showSvgHoverTooltip",{name:c,type:d},b)}),$(document).on("mouseleave","polygon, polyline, line, path",function(b){b.stopPropagation(),a.$broadcast("hideSvgTooltip")}),e.$on("$destroy",function(){e.displaySettings=void 0,e.state=void 0,e.events=void 0,e.services=void 0,r=void 0,j=void 0,k=void 0,l=void 0,c.action.filter.destroy(m),c.action.polygonFilter.destroy(n),m=void 0,n=void 0,o=void 0,p=void 0,s=void 0,e.markerOverlay&&(e.markerOverlay.destroy(),e.markerOverlay=void 0),c.action.timeSenseService.destroyPolygons("Map unloaded");for(var a in e.neighbourhoodOverlay)for(var b in e.neighbourhoodOverlay[a])e.neighbourhoodOverlay[a][b].destroy();c.action.timeSenseService.destroyPolygons("Map unloaded"),c.destroy(i,v),v=void 0,i=void 0;for(var d in q)q[d]();_.each(f.find("div"),function(a){a.remove()}),$(".body_map").unbind("map-loaded"),$("#map_canvas").off("mousedown"),$(document).off("click","polygon, polyline, line, path"),$(document).off("mouseenter","polygon, polyline, line, path"),$(document).off("mouseleave","polygon, polyline, line, path"),f.remove()});var t=function(a){return function(){var b=this,c=arguments;i?a.apply(b,arguments):$(".body_map").bind("map-loaded",function(){a.apply(b,c)})}},u=function(a){i&&c.action.zoomLevel(i,a.minZoom,a.maxZoom)};u=t(u),e.services.direction.create=c.action.direction.create,e.services.direction.remove=c.action.direction.remove;var v,w=function(b,d,e){var f=c.pencilDrawing.currentPolygon,g=c.pencilDrawing.polyline_obj;g&&(g.setMap(null),c.pencilDrawing.polyline_obj=null);var i=[],j=[],k=0;if("project"!==d)return b;for(var l=0;l<b.length;l++)b[l].data.latitude&&b[l].data.longitude||k++,j.push(b[l].data);if(!f||!b.length)return e||a.$broadcast("alvListFilteredArray",{alvListArray:j,unMappedCount:k}),b;j=[],k=0;for(var l=0;l<b.length;l++){var m=b[l].data.latitude,n=b[l].data.longitude,o=h(m,n),p=google.maps.geometry.poly.containsLocation(o,f);f&&m&&n&&p&&(i.push(b[l]),j.push(b[l].data))}return e||a.$broadcast("alvListFilteredArray",{alvListArray:j,unMappedCount:k}),i},x=function(a,b,d,f){if(i){o=a,l=a,l=w(a,b,f);var g="project"===b?!0:!1;l&&l.length&&(v&&google.maps.event.removeListener(v),c.action.markers.add(i,l),e.markerOverlay&&(e.markerOverlay.makeMeasles=!1,e.markerOverlay.destroy(),delete e.markerOverlay),e.markerOverlay=new Overlay(l,i,g),e.markerOverlay.makeMeasles=g,e.markerOverlay.setMap(i),g&&(v=google.maps.event.addListener(i,"idle",function(){s&&"neighbourhood"!=s.currentActiveTab&&"timeSense"!=s.currentActiveTab&&e.markerOverlay.updateMeasles(l,i)})),d&&c.action.bounds(i,l,!1))}};x=t(x);var y=e.$on("removeMeasleUpdateListener",function(a,b){v&&google.maps.event.removeListener(v)});q.push(y);var z=function(a){i&&(c.action.markers.add(i,[a]),e.markerOverlay&&(e.markerOverlay.makeMeasles=!1,e.markerOverlay.destroy(),delete e.markerOverlay),e.markerOverlay=new Overlay([a],i,!1),e.markerOverlay.makeMeasles=!1,e.markerOverlay.setMap(i))};z=t(z);var A=e.$on("addActiveProjectMarker",function(a,b){b&&b.data&&(b.data.addDefaultClass="st-c",z(b))});q.push(A);var B=function(a){i&&c.action.zoom(i,a)};B=t(B);var C=e.$on("setDefaultZoomLevel",function(a,b){B(b)});q.push(C);var D=function(a){i&&e.markerOverlay&&(a.position=h(a.position.lat,a.position.lng),e.markerOverlay.panToCenter(a))};D=t(D);var E=function(b,c){if(i){var d=[];if(b&&b.length){var f=e.state.filter.state.position;b[0].forEach(function(a,b){d.push({lat:a[1],lng:a[0]})});var c=h(f.lat,f.lng),g=new google.maps.Polygon({path:d}),j=google.maps.geometry.poly.containsLocation(c,g),k="decideMasterPlanHelpScreen";j?(a.$broadcast("showDisabledSvgLegends",!1),k="decideMasterPlanHelpScreen"):(a.$broadcast("showDisabledSvgLegends",!0),k="localityOutOfCityPurviewHelpScreen"),setTimeout(function(){a.$broadcast(k)},1e3)}}};E=t(E),e.$on("decideIfMasterPlanDisabled",function(a,b){E(b.cityCoordinates,b.localityLatLng)});var F=function(a){i&&(G(),p=a,c.action.polygons.add(i,p))};F=t(F);var G=function(){if(i){for(var a=0;p&&a<p.length;a++)p[a].destroy();p=[],c.action.timeSenseService.destroyPolygons("User started")}};G=t(G);var H=function(b){i&&a.$broadcast("addSvgOverlayToMap",b)};H=t(H);var I=e.$on("addSvgOverlay",function(a,b){var c=angular.element("#"+b.svgName);c&&c.length||H(b)});q.push(I);var J=function(a,b){var c=String(b.lat).replace(".","")+"-"+String(b.lng).replace(".",""),d=$("#"+c).find(".waiting");"OK"!==a||d.hasClass("completed")||(d.addClass("completed"),d.html('<span class="dstnc_wrap"><i class="pt pt-icon-road"></i> '+b.distance+'</span><span class="time_car_wrap"><i class="pt pt-icon-truck"></i> '+b.duration+"</span>"))},K=function(a){k={source:{lat:j.lat,lng:j.lng},destination:[{lat:a.latitude,lng:a.longitude}]},c.action.direction.create(k,J)},L=function(a){for(var b=[],d=0,e=a.length;e>d;d++)b.push({lat:a[d].latitude,lng:a[d].longitude});k={source:{lat:j.lat,lng:j.lng},destination:b},c.action.direction.create(k,J)},M=function(a){var b=_.pluck(a,"data");L(b)},N=function(a,b){b.mouseEnter(K)},O=function(a){var b,d,f=a.type,g=a.level,h=e.state.neighbourhood;if(j=a.direction?a.project:null,h[g][f]){if(d=e.neighbourhoodOverlay[g][f],d&&(d.destroy(),h[g][f]=[],delete e.neighbourhoodOverlay[g][f],c.action.direction.remove()),b=e.state.neighbourhood[g][f],!b||!b.length)return;if(c.action.markers.add(i,b),d=new Overlay(b,i),d.setMap(i),e.neighbourhoodOverlay[g][f]=d,a.direction&&(a.showMultipleDirections?M(b):$.each(b,N)),!a.removeState)if(e.state.polygonFilter.polygonExist)c.action.bounds(i,b,n.bounds,a.projectLatLng);else{var k=m.visible?m.bounds:!1;c.action.bounds(i,b,k,a.projectLatLng)}}};O=t(O);var P=function(b){i&&a.$broadcast("drawPolygon",b)};P=t(P);var Q=e.$on("drawPolygonFromEncodedPath",function(a,b){P(b)});q.push(Q);var R=function(){if(i){var a=c.pencilDrawing.currentPolygon;a&&(a.setMap(null),google.maps.event.clearInstanceListeners(a)),e.state.polygonFilter.polygonExist=!1,c.pencilDrawing.currentPolygon=null}};R=t(R);var S=e.$on("removeCurrentPolygonReference",function(){R()});q.push(S);var T=function(){a.$broadcast("startDrawing")};T=t(T);var U=e.$on("activateDrawing",function(){T()});q.push(U);var V=e.$on("drawMarkers",function(a,b){b.markers&&b.markers.length&&x(b.markers,b.type,b.markersFitFlag,b.refreshOnlyMarkers)});q.push(V);var W=e.$on("panToCenter",function(a,b){b&&b.position&&b.position.lat&&b.position.lng&&D(b)});q.push(W);var X=function(a){c.action.reverseGeocode.fetch(a.coordinates,a.callback)};X=t(X);var Y=e.$on("fetchReverseGeocode",function(a,b){X(b)});q.push(Y);var Z=function(a){c.action.routeDirection.fetch(a.origin,a.destination,a.panelId,a.callback)};Z=t(Z);var aa=e.$on("drawCustomDirection",function(a,b){Z(b)});q.push(aa);var ba=e.$on("removeCustomDirection",function(a,b){c.action.routeDirection.remove()});q.push(ba);var ca=e.$on("drawNeighbourhoodMarkers",function(a,b){O(b)});q.push(ca);var da=e.$on("setZoomLevels",function(a,b){u(b)});q.push(da);var ea=e.$on("drawPolygons",function(a,b){F(b)});q.push(ea);var fa=e.$on("destroyPolygons",function(a){G()});q.push(fa),e.services.bounds=function(a){c.action.bounds(i,a,m.bounds)};var ga=function(a){var b=a?!0:!1;e.state.filter.visible=b,c.action.filter.setVisibility(m,b)};ga=t(ga);var ha=e.$on("showMapFilter",function(a,b){ga(b)});q.push(ha);var ia=function(){var a=e.state.filter.state;a&&a.position&&!e.state.polygonFilter.currentDrawingStatus&&c.action.filter.updateMapFilter(m,a)};ia=t(ia);var ja=e.$on("updateMapFilter",function(){ia()});q.push(ja);var ka=function(){var b=g.id;i=c.initialize(e.state,b),$("#map_canvas").on("mousedown",function(){e.state.activateToggleCollage=!0,e.state.collapseState=!0,angular.element(".masterplan-help-tooltip").hide()}),m=c.action.filter.create(i,e.state.filter.state),n=c.action.polygonFilter.create(i,e.state.polygonFilter.state),c.action.markers.add(i,o);var f=d.citySvgLatLongHashMap,h=e.$on("addSvgOverlayToMap",function(a,b){var d=b&&b.svgName?b.svgName:"",e=b&&b.city?b.city:"Noida";e=e.toLowerCase(),f[e]&&f[e].length&&c.svgOverlay.init({map:i,city:e,svgName:d,zIndex:b.zIndex,leftTop:f[e][0],rightTop:f[e][1],leftBottom:f[e][2]})});q.push(h);var j=e.$on("mapResize",function(){google.maps.event.trigger(i,"resize")});q.push(j);var k=e.$on("mapZoomin",function(){i.setZoom(i.getZoom()+1)});q.push(k);var l=e.$on("mapZoomout",function(){i.setZoom(i.getZoom()-1)});q.push(l);var p=e.$on("drawTravelTimeHeatMap",function(a,b){b.reachabilityInfo?c.action.timeSenseService.drawReachability(b):c.action.timeSenseService.drawTimeSense(b)});q.push(p);var s=e.$on("project-listing",function(a){e.state.polygonFilter.polygonExist?c.action.bounds(i,[],n.bounds):c.action.bounds(i,[],m.bounds)});q.push(s);var t=e.$on("updateCenter",function(a,b){c.action.center(i,b)});q.push(t);var u=e.$on("drawPolygon",function(b,d){if(d){var f=google.maps.geometry.encoding.decodePath(d);a.$broadcast("showPolygonFilter",!0),a.$broadcast("updatePolygonFilter",f),e.state.polygonFilter.polygonExist=!0;var g=new google.maps.Polygon({map:i,fillOpacity:0,strokeColor:"#2691ec",strokeOpacity:.5,strokeWeight:2,clickable:!1,zIndex:1,suppressUndo:!0,path:f,editable:!0});g.bindTo("visible",n),c.pencilDrawing.currentPolygon=g;var h=g.getPaths(),j=h.getLength();if(j){c.pencilDrawing.setPolygonPaths(g.getPath()),a.$broadcast("changeDrawButtonStatus",!0);for(var k=0;j>k;k++){var l=h.getAt(k);google.maps.event.addListener(l,"insert_at",function(a){c.pencilDrawing.setPolygonPaths(this)}),google.maps.event.addListener(l,"set_at",function(a){c.pencilDrawing.setPolygonPaths(this)})}}}});q.push(u);var v=e.$on("startDrawing",function(){c.pencilDrawing.init(i,n)});q.push(v);var w=e.$on("removePolygon",function(){c.pencilDrawing.removePolygon(i)});q.push(w);var x=e.$on("masterPlanActive",function(a,b){b?i.setOptions({styles:r.masterPlan}):i.setOptions({styles:r.ptDefault})});q.push(x);var y=e.$on("updateZoom",function(a,b){c.action.zoom(i,b)});q.push(y),c.bind.zoom(i,function(b){e.state.zoom=b,a.$broadcast("zoomUpdated",b),setTimeout(function(){a.$apply()},10)}),c.bind.center(i,function(b){e.state.center=b,setTimeout(function(){a.$apply()},0)});var z=e.$on("showPolygonFilter",function(a,b){var d=b?!0:!1;e.state.polygonFilter.visible=d,c.action.polygonFilter.setVisibility(n,d)});q.push(z),c.bind.filter(m,function(b,c,d){e.state.filter.state.position.lat=b,e.state.filter.state.position.lng=c,e.state.filter.state.distance=d,e.state.filter.action="drag",a.$broadcast("refreshOnFilterStateChange")}),e.state.libraries.places=new google.maps.places.PlacesService(i),$(".body_map").trigger("map-loaded"),m.addListener("state_changed",function(b){var c,d,f,g,h=a.CURRENT_ACTIVE_PAGE,i={};d=Math.floor(1e3*e.state.filter.state.distance)+" mtrs",f=Math.floor(1e3*e.state.filter.state.lastDistance)+" mtrs","dragged"==b.action?(c="circle-"+h,g="Circle Dragged",i.Radius=d):(c=f+"-"+d+"-"+h,g="Circle Radius Changed",i.Radius=f,i["Changed Radius"]=d),i["Locality ID"]=a.currentLocality&&a.currentLocality.localityId?a.currentLocality.localityId:null,i["Page Name"]=h,e.state.filter.state.lastDistance=e.state.filter.state.distance})};c.includeJS(ka)}}}])}),define("text!views/directives/common/pt-loading-block.html",[],function(){return'<div class="parent-blocking" data-ng-if="!loadingObject">\n    <div class="loader-info">\n    	<div data-ng-transclude ></div>\n    	<i class="pt pt-icon-cog pt-icon-spin {{iconStylingClass}}"></i>\n        <div class="big-loader">\n            <i class="spinLoader"></i>\n        </div>      \n    </div>        \n</div>\n'}),define("directives/common/pt-loading-block",["app","text!views/directives/common/pt-loading-block.html"],function(a,b){a.directive("ptLoadingBlock",[function(){return{restrict:"A",scope:{loadingObject:"=",iconStylingClass:"@"},transclude:!0,template:b,link:function(a,b,c){a.iconStylingClass=a.iconStylingClass||"",a.$on("$destroy",function(){a.loadingObject=void 0,b.remove()})}}}])}),define("text!views/directives/maps/pt-zoom-map.html",[],function(){return'<div class="zoom-wrap">\n    <div class="btn-group btn-group-vertical">\n        <button class="btn btn-mini map-zoomin" tooltip="Zoom In" tooltip-placement="left" data-ng-click="zoomin()" data-ng-disabled="!zoominEnabled"><i class="pt pt-icon-plus"></i></button>\n        <button class="btn btn-mini map-zoomout" tooltip="Zoom Out" tooltip-placement="left" data-ng-click="zoomout()" data-ng-disabled="!zoomoutEnabled"><i class="pt pt-icon-minus"></i></button>\n    </div>\n</div>\n<div class="backBtn">\n	<button id="backToCity" data-ng-if="backToCity" class="btn btn-mini backtocity" data-ng-click="back()"><i class="pt pt-icon-arrow-left"></i> <span class="show">{{particularBuilderProjects ? \'See All Localities\' : \'Go to \'+cityName}}</span></button>\n</div>\n'}),define("directives/maps/pt-zoom-map",["app","text!views/directives/maps/pt-zoom-map.html"],function(a,b){a.directive("ptZoomMap",["$rootScope",function(a){return{restrict:"A",scope:{},template:b,link:function(b,c){var d=c.find(".map-zoomin"),e=c.find(".map-zoomout");b.backToCity=!1,b.zoominEnabled=!0,b.zoomoutEnabled=!0,b.cityName=a.urlData&&a.urlData.city?a.urlData.city:"city",b.$on("$destroy",function(){d=void 0,e=void 0,b.cityName=void 0,c.remove()}),b.$on("showBackToCity",function(a,c){return b.backToCity=c?!0:!1,"builderSearch"==c?void(b.particularBuilderProjects=!0):(b.particularBuilderProjects=!1,void(b.cityName=c?c:""))}),b.$on("enableZoomin",function(a,c){b.zoominEnabled=c,c?d.removeClass("disabled"):d.addClass("disabled")}),b.$on("enableZoomout",function(a,c){b.zoomoutEnabled=c,c?e.removeClass("disabled"):d.addClass("disabled")}),b.back=function(){a.$broadcast("backToCity")},b.zoomin=function(){a.$broadcast("mapZoomIn")},b.zoomout=function(){a.$broadcast("mapZoomOut")}}}}])}),define("text!views/directives/maps/pt-svg-legends.html",[],function(){return'<div  data-ng-show="showSvgLegends || disableMasterPlanButton" id="svgLegends">\n	<div  class="svg-legend" data-ng-hide="disableMasterPlanButton">\n	   <div class="svg-header">Legend</div>\n	    <accordion close-others="true">\n	    	<accordion-group heading="Static Header, initially expanded" is-open="eachLegend.open"  is-disabled="status.isFirstDisabled" ng-repeat="eachLegend in legendsArray" ng-if="eachLegend.visible" ng-init="eachLegend.modelName = false;" class="paddingTB10LR15 svg-accordian" ng-class="{\'active\':eachLegend.modelName}">\n		    	<accordion-heading>\n						<div class="svg-item" id="{{eachLegend.id}}"  data-ng-click="eachLegend.modelName = !eachLegend.modelName;specToggle($event,eachLegend.modelName, eachLegend.name)">\n							<label for="eachLegend.labelFor">{{eachLegend.label}}</label>\n							<i class="pull-right pt" ng-class="{\'pt-icon-angle-up\': eachLegend.open, \'pt-icon-angle-down\': !eachLegend.open}"></i> \n						</div>\n						\n		    	</accordion-heading>\n				<div class="svg-sub-item">\n				<ul>\n					<li ng-repeat="subLegend in eachLegend.subLegends"><span ng-class="subLegend.cls"></span><span>{{subLegend.name}}</span></li>\n				</ul>\n				</div>\n	    	</accordion-group>\n	    </accordion>\n	    <div class="paddingT0lrb10">\n	    	<a ng-href="{{citySvgs.source}}"\n			   analytics-on\n			   data-analytics-event="ClICK_Masterplan_Source"\n			   data-analytics-category="Catchment Analysis"\n			   data-analytics-label="{{citySvgs.source}}"\n			   target="_blank">source</a>\n	    </div>\n	</div>\n	<button\n			analytics-on\n			data-analytics-event="ClICK_Masterplan"\n			data-analytics-category="Catchment Analysis"\n			data-analytics-label="{{ !toggleSvgLegendOpened ? \'CLOSE MASTER PLAN\' : \'VIEW MASTER PLAN (\'+citySvgs.year+\')\'}}"\n			class="btn btn-action-o svg-primary-btn" id="svgbtn" data-ng-hide="disableMasterPlanButton" data-ng-click="toggleSVgLegend()">\n	 	{{ toggleSvgLegendOpened ? \'CLOSE MASTER PLAN\' : \'VIEW MASTER PLAN (\'+citySvgs.year+\')\'}}\n	 </button>\n	 <div class="help-tooltip-txt masterplan-help-tooltip">\n			\n	 </div>\n	<button class="btn btn-action-o svg-primary-btn disable-legendbtn"  tooltip="Currently available for Noida, Bangalore and Pune" tooltip-placement="right" data-ng-show="disableMasterPlanButton">\n	 	VIEW MASTER PLAN\n	</button>\n</div>'}),define("directives/maps/pt-svg-legends",["app","text!views/directives/maps/pt-svg-legends.html","services/maps/mapConfig","googleAnalyticsService"],function(a,b){a.directive("ptSvgLegends",["$rootScope","PtMapsConfig","GoogleAnalyticsService",function(a,c,d){return{restrict:"A",scope:{},template:b,link:function(b,e,f){b.state=c.mapConfig.state,b.masterPlanActive=!1,b.showSvgLegends=!1,b.toggleSvgLegendOpened=!1,b.disableMasterPlanButton=!1;var g=[],h="project",i=c.masterPlanScaleFactor.roadScaleFactor,j=c.masterPlanScaleFactor.trainScaleFactor,k=[{zoom:14,status:!1},{zoom:16,status:!1},{zoom:18,status:!1},{zoom:20,status:!1},{zoom:21,status:!1}],l={"default":{name:"",source:"http://google.com"},noida:{name:"Noida",source:"http://www.noidaauthorityonline.com",year:2031},bangalore:{name:"Bangalore",source:"http://www.bdabangalore.org",year:2021},pune:{name:"Pune",source:"http://www.punecorporation.org",year:2027}};b.legendsArray=[{name:"landusage",id:"landusage_legend",label:"Land Usage",labelFor:"landusage",subLegends:[{name:"Agricultural",cls:"agri"},{name:"Industry/SEZ",cls:"indus"},{name:"Institutional/facility",cls:"inst"},{name:"Residential(Low density)",cls:"resid"},{name:"Park & Play Ground",cls:"parkplay"},{name:"Commercial",cls:"comm"},{name:"Village Population",cls:"village"}],visible:!1},{name:"train",id:"train_legend",label:"Rails & Metros",labelFor:"trains",subLegends:[{name:"Metros",cls:"metro-line-exist"},{name:"Metros (Proposed)",cls:"metro-line"},{name:"Trains",cls:"railway-line-exist"},{name:"Trains (Proposed)",cls:"railway-line"}],visible:!1},{name:"roads",id:"roads_legend",label:"Roads and Highways",labelFor:"roads",subLegends:[{name:"Highways",cls:"nh"},{name:"Highways (proposed)",cls:"nh-proposed"},{name:"Roads",cls:"street"}],visible:!1},{name:"drains_electric",id:"drains_electric_legend",label:"Drains & Electric",subLegends:[{name:"Drains/Canals",cls:"drain-canal"},{name:"High Tension Lines",cls:"tension-line"}],labelFor:"drains",visible:!1}],b.$on("$destroy",function(){for(var a in g)g[a]()}),b.$on("localityOutOfCityPurviewHelpScreen",function(){var a=b.citySvgs&&b.citySvgs.name?b.citySvgs.name:"city";angular.element(".masterplan-help-tooltip").css("bottom","10px").text("This locality is outside the purview of administrative area of "+a).show(),q()}),b.$on("decideMasterPlanHelpScreen",function(){if(!localStorage.masterPlanHelpScreen){var a=b.citySvgs&&b.citySvgs.name?" "+b.citySvgs.name:"";angular.element(".masterplan-help-tooltip").css("bottom","10px").text("Master Plan of"+a+" is available on maps now").show(),q()}setTimeout(function(){localStorage.masterPlanHelpScreen=!0},10)});var m=b.$on("showSvgLegends",function(c,d){b.showSvgLegends=d?!0:!1;var e=a.selectedCity&&a.selectedCity.label?a.selectedCity.label.toLowerCase():"default";b.citySvgs=l[e]});g.push(m);var n=b.$on("addSvgLegend",function(a,c){angular.forEach(b.legendsArray,function(a,b){a.name==c.svgType&&(a.visible=!0,h=c.viewLevel)})});g.push(n);var o=function(){angular.element(".masterplan-help-tooltip").hide(),angular.forEach(b.legendsArray,function(a,b){a.modelName=!1,a.open=!1,angular.element("#"+a.name).fadeOut(1e3)}),b.masterPlanActive&&(a.$broadcast("masterPlanActive",!1),b.masterPlanActive=!1)},p=null,q=function(){p&&clearTimeout(p),p=setTimeout(function(){angular.element(".masterplan-help-tooltip").hide()},1e4)},r=function(){angular.forEach(b.legendsArray,function(a,c){a.visible&&"landusage"==a.name&&"locality"==h?(a.modelName=!0,a.open=!0,angular.element("#"+a.name).fadeIn(1e3),b.masterPlanActive=!0):a.visible&&"project"==h&&"roads"==a.name?(a.modelName=!0,a.open=!0,angular.element("#"+a.name).fadeIn(1e3),b.masterPlanActive=!0):(a.modelName=!1,a.open=!1)}),b.masterPlanActive&&(a.$broadcast("masterPlanActive",!0),localStorage.masterPlanOpenHelpScreen||(angular.element(".masterplan-help-tooltip").css("bottom","155px").text("Hover over major roads and metro lines to view names").show(),q()),setTimeout(function(){localStorage.masterPlanOpenHelpScreen=!0},10))},s=b.$on("resetSvgLegends",function(){b.disableMasterPlanButton||(o(),b.toggleSVgLegend(!0),b.disableMasterPlanButton=!1)});g.push(s);var t=b.$on("showDisabledSvgLegends",function(a,c){b.disableMasterPlanButton=c?!0:!1,c&&b.toggleSVgLegend&&(o(),b.toggleSVgLegend(!0))});g.push(t),b.specToggle=function(c,e,f){e&&d.gaEventMasterPlanViewType(f);var g=!0;angular.forEach(b.legendsArray,function(a,b){a.name!=f&&(a.modelName=!1,angular.element("#"+a.name).fadeOut(1e3)),a.name==f&&e?(g=!1,angular.element("#"+a.name).fadeIn(1e3)):e||angular.element("#"+a.name).fadeOut(1e3)}),b.masterPlanActive=!g,a.$broadcast("masterPlanActive",!g)},b.toggleSVgLegend=function(a){return b.state.activateToggleCollage=!0,b.state.collapseState=!0,a||(o(),b.toggleSvgLegendOpened=!b.toggleSvgLegendOpened,b.toggleSvgLegendOpened&&r()),a?($(".svg-legend").slideUp(),void(b.toggleSvgLegendOpened=!1)):($(".svg-legend").slideToggle(400,function(){}),void(!b.toggleSvgLegendOpened&&!a));
};var u=function(a,b){for(var c=0;c<a.length;c++){var d=a[c].getAttribute("stroke-width");null!=d&&void 0!=d&&a[c].setAttribute("stroke-width",d*b)}},v=function(a){for(var b=$("#roads svg path"),c=$("#train svg path"),d=0;d<k.length;d++){if(k[d].zoom==a&&0==k[d].status){u(b,i.decrease),u(c,j.decrease),k[d].status=!0;break}if(a<k[d].zoom&&1==k[d].status){u(b,i.increase),u(c,j.increase),k[d].status=!1;break}}},w=b.$on("updateSvgStroke",function(a,b){v(b)});g.push(w)}}}])}),define("text!views/modal/pt-select-city.html",[],function(){return'<div class="modal-header bg-modal">\n	<span><i class="pt pt-icon-info-circle"></i> <b>Please select a city to continue</b></span>\n</div>\n<div class="choose_city">\n        <div class="city_option">\n        	<h5>TOP CITIES</h5>\n            <ul>\n                <li data-ng-repeat=" city in cityList | filter: {authorized: true, displayPriority: 1}" >\n                    <div data-ng-click="setSelected(city)" >{{city.label}}</div>\n                </li>\n            </ul>\n        </div>\n      \n        <div data-ng-show="otherCities && otherCities.length"  class="city_option" style="padding-top:15px;">\n        	<h5>OTHER CITIES</h5>\n            <ul>\n                <li data-ng-repeat=" city in otherCities" >\n                    <div data-ng-click="setSelected(city)">{{city.label}}</div>\n                </li>\n            </ul>\n        </div>\n</div>\n<div class="modal-footer md-footer">\n</div>\n\n'}),define("directives/common/pt-selectCity",["app","text!views/modal/pt-select-city.html"],function(a,b){a.directive("ptSelectCity",[function(){return{restrict:"A",scope:{selectedCity:"="},templateUrl:"",controller:["$scope","$rootScope","$modal","$location",function(a,c,d,e){d.open({backdrop:"static",keyboard:!1,template:b,controller:["$scope","$rootScope","$modalInstance","$location","$filter",function(a,b,c,d,e){var f=!0;a.otherCities=e("filter")(b.cityList,{authorized:!0,displayPriority:2}),a.setSelected=function(a){d.path("/maps/projects-in-"+a.label.toLowerCase());var c={};b.CURRENT_ACTIVE_PAGE,c["Çity Name"]=a.label,c["Page Name"]="map-home"},a.$on("$stateChangeStart",function(a,d,e,g,h){"maps"!=d.name&&f&&(c.close(c),b.showCitiesModal=!1,f=!1)})}]})}]}}])}),function(a){"function"==typeof define&&define.amd?define("PerfectScrollBar",["jquery"],a):a(jQuery)}(function(a){var b={wheelSpeed:10,wheelPropagation:!1,minScrollbarLength:null,useBothWheelAxes:!1,useKeyboard:!0,suppressScrollX:!1,suppressScrollY:!1,scrollXMarginOffset:0,scrollYMarginOffset:0};a.fn.perfectScrollbar=function(c,d){return this.each(function(){var e=a.extend(!0,{},b),f=a(this);if("object"==typeof c?a.extend(!0,e,c):d=c,"update"===d)return f.data("perfect-scrollbar-update")&&f.data("perfect-scrollbar-update")(),f;if("destroy"===d)return f.data("perfect-scrollbar-destroy")&&f.data("perfect-scrollbar-destroy")(),f;if(f.data("perfect-scrollbar"))return f.data("perfect-scrollbar");f.addClass("ps-container");var g,h,i,j,k,l,m,n,o,p,q=a("<div class='ps-scrollbar-x-rail'></div>").appendTo(f),r=a("<div class='ps-scrollbar-y-rail'></div>").appendTo(f),s=a("<div class='ps-scrollbar-x'></div>").appendTo(q),t=a("<div class='ps-scrollbar-y'></div>").appendTo(r),u=parseInt(q.css("bottom"),10),v=parseInt(r.css("right"),10),w=function(){var a=parseInt(p*(l-j)/(j-o),10);f.scrollTop(a),q.css({bottom:u-a})},x=function(){var a=parseInt(n*(k-i)/(i-m),10);f.scrollLeft(a),r.css({right:v-a})},y=function(a){return e.minScrollbarLength&&(a=Math.max(a,e.minScrollbarLength)),a},z=function(){q.css({left:f.scrollLeft(),bottom:u-f.scrollTop(),width:i,display:e.suppressScrollX?"none":"inherit"}),r.css({top:f.scrollTop(),right:v-f.scrollLeft(),height:j,display:e.suppressScrollY?"none":"inherit"}),s.css({left:n,width:m}),t.css({top:p,height:o})},A=function(){i=f.width(),j=f.height(),k=f.prop("scrollWidth"),l=f.prop("scrollHeight"),!e.suppressScrollX&&i+e.scrollXMarginOffset<k?(g=!0,m=y(parseInt(i*i/k,10)),n=parseInt(f.scrollLeft()*(i-m)/(k-i),10)):(g=!1,m=0,n=0,f.scrollLeft(0)),!e.suppressScrollY&&j+e.scrollYMarginOffset<l?(h=!0,o=y(parseInt(j*j/l,10)),p=parseInt(f.scrollTop()*(j-o)/(l-j),10)):(h=!1,o=0,p=0,f.scrollTop(0)),p>=j-o&&(p=j-o),n>=i-m&&(n=i-m),z()},B=function(a,b){var c=a+b,d=i-m;n=0>c?0:c>d?d:c,q.css({left:f.scrollLeft()}),s.css({left:n})},C=function(a,b){var c=a+b,d=j-o;p=0>c?0:c>d?d:c,r.css({top:f.scrollTop()}),t.css({top:p})},D=function(){var b,c;s.bind("mousedown.perfect-scrollbar",function(a){c=a.pageX,b=s.position().left,q.addClass("in-scrolling"),a.stopPropagation(),a.preventDefault()}),a(document).bind("mousemove.perfect-scrollbar",function(a){q.hasClass("in-scrolling")&&(x(),B(b,a.pageX-c),a.stopPropagation(),a.preventDefault())}),a(document).bind("mouseup.perfect-scrollbar",function(a){q.hasClass("in-scrolling")&&q.removeClass("in-scrolling")}),b=c=null},E=function(){var b,c;t.bind("mousedown.perfect-scrollbar",function(a){c=a.pageY,b=t.position().top,r.addClass("in-scrolling"),a.stopPropagation(),a.preventDefault()}),a(document).bind("mousemove.perfect-scrollbar",function(a){r.hasClass("in-scrolling")&&(w(),C(b,a.pageY-c),a.stopPropagation(),a.preventDefault())}),a(document).bind("mouseup.perfect-scrollbar",function(a){r.hasClass("in-scrolling")&&r.removeClass("in-scrolling")}),b=c=null},F=function(){var a=function(a,b){var c=f.scrollTop();if(0===c&&b>0&&0===a)return!e.wheelPropagation;if(c>=l-j&&0>b&&0===a)return!e.wheelPropagation;var d=f.scrollLeft();return 0===d&&0>a&&0===b?!e.wheelPropagation:d>=k-i&&a>0&&0===b?!e.wheelPropagation:!0},b=!1;f.bind("mousewheel.perfect-scrollbar",function(c,d,i,j){e.useBothWheelAxes?h&&!g?j?f.scrollTop(f.scrollTop()-j*e.wheelSpeed):f.scrollTop(f.scrollTop()+i*e.wheelSpeed):g&&!h&&(i?f.scrollLeft(f.scrollLeft()+i*e.wheelSpeed):f.scrollLeft(f.scrollLeft()-j*e.wheelSpeed)):(f.scrollTop(f.scrollTop()-j*e.wheelSpeed),f.scrollLeft(f.scrollLeft()+i*e.wheelSpeed)),A(),b=a(i,j),b&&c.preventDefault()}),f.bind("MozMousePixelScroll.perfect-scrollbar",function(a){b&&a.preventDefault()})},G=function(){var b=function(a,b){var c=f.scrollTop();if(0===c&&b>0&&0===a)return!1;if(c>=l-j&&0>b&&0===a)return!1;var d=f.scrollLeft();return 0===d&&0>a&&0===b?!1:d>=k-i&&a>0&&0===b?!1:!0},c=!1;f.bind("mouseenter.perfect-scrollbar",function(a){c=!0}),f.bind("mouseleave.perfect-scrollbar",function(a){c=!1});var d=!1;a(document).bind("keydown.perfect-scrollbar",function(a){if(c){var g=0,h=0;switch(a.which){case 37:g=-3;break;case 38:h=3;break;case 39:g=3;break;case 40:h=-3;break;default:return}f.scrollTop(f.scrollTop()-h*e.wheelSpeed),f.scrollLeft(f.scrollLeft()+g*e.wheelSpeed),A(),d=b(g,h),d&&a.preventDefault()}})},H=function(){var a=function(a){a.stopPropagation()};t.bind("click.perfect-scrollbar",a),r.bind("click.perfect-scrollbar",function(a){var b=parseInt(o/2,10),c=a.pageY-r.offset().top-b,d=j-o,e=c/d;0>e?e=0:e>1&&(e=1),f.scrollTop((l-j)*e),A()}),s.bind("click.perfect-scrollbar",a),q.bind("click.perfect-scrollbar",function(a){var b=parseInt(m/2,10),c=a.pageX-q.offset().left-b,d=i-m,e=c/d;0>e?e=0:e>1&&(e=1),f.scrollLeft((k-i)*e),A()})},I=function(){var b=function(a,b){f.scrollTop(f.scrollTop()-b),f.scrollLeft(f.scrollLeft()-a),A()},c={},d=0,e={},g=null,h=!1;a(window).bind("touchstart.perfect-scrollbar",function(a){h=!0}),a(window).bind("touchend.perfect-scrollbar",function(a){h=!1}),f.bind("touchstart.perfect-scrollbar",function(a){var b=a.originalEvent.targetTouches[0];c.pageX=b.pageX,c.pageY=b.pageY,d=(new Date).getTime(),null!==g&&clearInterval(g),a.stopPropagation()}),f.bind("touchmove.perfect-scrollbar",function(a){if(!h&&1===a.originalEvent.targetTouches.length){var f=a.originalEvent.targetTouches[0],g={};g.pageX=f.pageX,g.pageY=f.pageY;var i=g.pageX-c.pageX,j=g.pageY-c.pageY;b(i,j),c=g;var k=(new Date).getTime();e.x=i/(k-d),e.y=j/(k-d),d=k,a.preventDefault()}}),f.bind("touchend.perfect-scrollbar",function(a){clearInterval(g),g=setInterval(function(){return Math.abs(e.x)<.01&&Math.abs(e.y)<.01?void clearInterval(g):(b(30*e.x,30*e.y),e.x*=.8,void(e.y*=.8))},10)})},J=function(){f.unbind(".perfect-scrollbar"),a(window).unbind(".perfect-scrollbar"),a(document).unbind(".perfect-scrollbar"),f.data("perfect-scrollbar",null),f.data("perfect-scrollbar-update",null),f.data("perfect-scrollbar-destroy",null),s.remove(),t.remove(),q.remove(),r.remove(),s=t=i=j=k=l=m=n=u=o=p=v=null},K=function(b){f.addClass("ie").addClass("ie"+b);var c=function(){var b=function(){a(this).addClass("hover")},c=function(){a(this).removeClass("hover")};f.bind("mouseenter.perfect-scrollbar",b).bind("mouseleave.perfect-scrollbar",c),q.bind("mouseenter.perfect-scrollbar",b).bind("mouseleave.perfect-scrollbar",c),r.bind("mouseenter.perfect-scrollbar",b).bind("mouseleave.perfect-scrollbar",c),s.bind("mouseenter.perfect-scrollbar",b).bind("mouseleave.perfect-scrollbar",c),t.bind("mouseenter.perfect-scrollbar",b).bind("mouseleave.perfect-scrollbar",c)},d=function(){z=function(){s.css({left:n+f.scrollLeft(),bottom:u,width:m}),t.css({top:p+f.scrollTop(),right:v,height:o}),s.hide().show(),t.hide().show()},w=function(){var a=parseInt(p*l/j,10);f.scrollTop(a),s.css({bottom:u}),s.hide().show()},x=function(){var a=parseInt(n*k/i,10);f.scrollLeft(a),t.hide().show()}};6===b&&(c(),d())},L="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,M=function(){var a=navigator.userAgent.toLowerCase().match(/(msie) ([\w.]+)/);a&&"msie"===a[1]&&K(parseInt(a[2],10)),A(),D(),E(),H(),L&&I(),f.mousewheel&&F(),e.useKeyboard&&G(),f.data("perfect-scrollbar",f),f.data("perfect-scrollbar-update",A),f.data("perfect-scrollbar-destroy",J)};return M(),f})}}),function(a){function b(b){var c=b||window.event,d=[].slice.call(arguments,1),e=0,f=0,g=0;return b=a.event.fix(c),b.type="mousewheel",c.wheelDelta&&(e=c.wheelDelta/120),c.detail&&(e=-c.detail/3),g=e,void 0!==c.axis&&c.axis===c.HORIZONTAL_AXIS&&(g=0,f=-1*e),void 0!==c.wheelDeltaY&&(g=c.wheelDeltaY/120),void 0!==c.wheelDeltaX&&(f=-1*c.wheelDeltaX/120),d.unshift(b,e,f,g),(a.event.dispatch||a.event.handle).apply(this,d)}var c=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var d=c.length;d;)a.event.fixHooks[c[--d]]=a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=c.length;a;)this.addEventListener(c[--a],b,!1);else this.onmousewheel=b},teardown:function(){if(this.removeEventListener)for(var a=c.length;a;)this.removeEventListener(c[--a],b,!1);else this.onmousewheel=null}},a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}(jQuery),define("vendor/jquery.mousewheel",function(){}),define("directives/common/pt-scroll",["app","PerfectScrollBar","services/pageSettings","vendor/jquery.mousewheel"],function(a){a.directive("ptScroll",["$rootScope","pageSettings",function(a,b){return{scope:{},link:function(b,c,d){var e=c[0];c.perfectScrollbar({wheelSpeed:30,wheelPropagation:!1,minScrollbarLength:100,useBothWheelAxes:!0}),angular.element(".mousescroll:hover").css("overflow-y","scroll"),angular.element(".mousescroll").mousewheel(function(a,b,c,d){}),b.$on("updateScroll",function(a,b){setTimeout(function(){b&&b.dontScrollToTop||c.scrollTop(0),c.perfectScrollbar("update")},10)}),c.bind("$destroy",function(){c.perfectScrollbar("destroy"),c.unbind("scroll")}),c.bind("scroll",function(){e.scrollTop+e.offsetHeight>=e.scrollHeight-1&&(a.CURRENT_ACTIVE_PAGE,a.$broadcast("info:scrollUpdate"))})}}}])}),define("text!views/directives/maps/draw-shape.html",[],function(){return'<div data-ng-show="showOption" >\n       <div class="draw-map" data-ng-click="toggleDraw()">\n               <div data-ng-hide="drawActiveFlag" tooltip="Draw a region on map to see projects in a desired area" tooltip-placement="bottom"  data-ng-mouseenter="sendGAEvent()">\n                   <i class="pt pt-icon-pencil"></i>\n                   Draw your region\n               </div>\n               <div data-ng-show="drawActiveFlag" >\n                       <span>\n                           <i class="pt pt-icon-times"></i>\n                           {{polygonFilter.polygonExist ? \'Erase\' : \'Cancel\'}}\n                       </span>\n               </div>\n       </div>\n       <div data-ng-if="drawActiveFlag && !polygonFilter.polygonExist" class="hlp-txt">\n               Click on the map and start drawing.\n       </div>\n</div>'}),define("directives/maps/draw-shape",["app","text!views/directives/maps/draw-shape.html","services/maps/mapConfig"],function(a,b){a.directive("ptDrawShape",["$rootScope","PtMapsConfig",function(a,c){return{restrict:"A",scope:{},replace:!0,template:b,link:function(b,d,e){b.drawActiveFlag=!1,b.showOption=!1,b.polygonFilter=c.mapConfig.state.polygonFilter,b.toggleDraw=function(){b.drawActiveFlag=!b.drawActiveFlag,c.mapConfig.state.polygonFilter.currentDrawingStatus=b.drawActiveFlag,b.polygonFilter.currentDrawingStatus=b.drawActiveFlag,a.$broadcast("drawingModeSwitched",b.drawActiveFlag)},b.sendGAEvent=function(){},b.$on("changeDrawButtonStatus",function(a,c){c=c?!0:!1,b.drawActiveFlag=c,b.polygonFilter.currentDrawingStatus=c}),b.$on("$destroy",function(){b.polygonFilter=void 0,b.drawActiveFlag=void 0,b.showOption=void 0,d.remove()}),b.$on("showDrawingOption",function(a,c){b.showOption=c?!0:!1})}}}])}),define("services/commonScriptLoad",["app","services/pageSettings","services/markerFactory","services/projectService","services/localityService","services/notificationService","services/searchService","services/constants","services/filterService","services/globalService","services/flags","services/userService","services/mapFactory","parsers/projectParser","parsers/localityParser","directives/common/pt-notification","directives/maps/pt-map","directives/common/pt-loading-block","directives/maps/pt-zoom-map","directives/maps/pt-svg-legends","directives/common/pt-selectCity","directives/common/pt-scroll","directives/maps/draw-shape","services/maps/mapConfig"],function(a){}),define("controllers/common/mapBaseCtrl",["app","jqueryDeParam","services/commonScriptLoad","formatters/common"],function(a,b){a.controller("mapBaseCtrl",["$rootScope","$scope","$timeout","$location","pageSettings","PtMapsConfig","FilterService","NotificationService","GlobalService","LocalityService","Formatter","SearchService","Constants","ProjectService","ProjectParser","$modal","$state",function(a,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){c.refreshProjectsList,c.refreshLocalityList,c.alvDisplayType="locality",c.requestType,c.displaySettings=f.displaySettings,c.map=g.mapConfig,c.polygonFilter=g.mapConfig.state.polygonFilter,c.map.state.filter.action=null,c.currentDrawingMode=!1,c.suburbActive=!1,c.nearbyPlaceActive=!1,c.currentPlace={},c.currentSuburb={},c.projectListingCallBackProjectId=null,c.showCityNotSupported=!1,c.isBuilderCitySearchActive=!1,c.masterPlanSvgActive=!1,c.builderFilter={equal:{builderId:[]}},h.filters.locality.hide=!0,h.filters.builder.hide=!1;var s=h.filters;s.budget.key="primaryOrResaleBudget";var t,u,v,w,x=c.builderFilter,y={filters:{and:[]},paging:{start:0,rows:9999}},z={equal:{cityId:[]}},A={geoDistance:{geo:{}}},B={and:[]},C={bedroom:"bedrooms"},D=[];a.userDetails&&a.userDetails.preference&&(w={unitType:a.userDetails.preference.preference.unitType.join(",")});var E=function(){var b=c.$on("setUrlPolygonPath",function(b,d){d&&(d=escape(d)),e.search("_keys",d);var f=d?!1:!0;if(a.$broadcast("showMapFilter",f&&!c.isBuilderCitySearchActive),c.showUnMappedFlag=!1,c._toggleMappedProject(!1),a.$broadcast("showMapped",!0),a.$broadcast("showProjectMarkers",!1),d)e.search().geo&&(c.savedGeo=e.search().geo,e.search("geo",null)),c.polygonFilter.polygonExist=!0,a.$broadcast("updatePolygonProjects");else{c.polygonFilter.polygonExist=!1;var g=c.polygonFilter.savedGeo;if(g&&(c.polygonFilter.savedGeo=null,e.search("geo",g)),c.suburbActive)return void c.activateProjectsView(c.currentSuburb);if(c.nearbyPlaceActive)return void c.activateProjectsView(c.currentPlace);c.activateProjectsView(a.currentLocality)}});D.push(b);var f=c.$on("maxRadiusLimitExceeded",function(){i.setNotification({msg:"The region drawn has large area. Narrow down your search by drawing a smaller region.",type:"info",confirmText:"OK",onYes:function(){}}),c.activateRedraw()});D.push(f);var g=c.$on("mapZoomOut",function(b){c.map.state.zoom-2>=c.map.state.minZoom&&a.CURRENT_ACTIVE_PAGE,a.$broadcast("mapZoomout"),d(function(){c.$apply()},10),"project"===c.alvDisplayType&&a.selectedCity.maxZoomLevel-2===c.map.state.zoom&&i.setNotification({msg:a.selectedCity?"Take me to "+a.selectedCity.label.toUpperCase()+" view.":"Take me to city view.",type:"alert",isConfirm:!0,onYes:function(){a.$broadcast("backToCity")},onNo:function(){}})});D.push(g);var h=c.$on("amenityClickedComplete",function(b,c){a.$broadcast("removeCustomDirection"),a.$broadcast("addNeighbourhood",c)});D.push(h);var j=c.$on("readyToDrawNeighbourhoodMarkers",function(b,c){a.$broadcast("drawNeighbourhoodMarkers",c)});D.push(j);var k=c.$on("mapZoomIn",function(b){a.$broadcast("mapZoomin"),d(function(){c.$apply()},10),"locality"===c.alvDisplayType&&a.selectedCity.maxZoomLevel===c.map.state.zoom&&i.setNotification({msg:"Explore a locality by clicking on its icon.",type:"info",confirmText:"OK",onYes:function(){}})});D.push(k);var l=c.$on("projectAlvClicked",function(b,d){c.projectClick(d),d.latitude&&d.longitude&&a.$broadcast("panToCenter",{position:{lat:d.latitude,lng:d.longitude}})});D.push(l);var m=c.$watch("map.state.zoom",function(b,d){b&&("locality"===c.requestType?(a.$broadcast("enableZoomout",b!==c.map.state.minZoom),a.$broadcast("enableZoomin",!(a.selectedCity&&b===a.selectedCity.maxZoomLevel))):(a.$broadcast("enableZoomout",!(a.selectedCity&&b===a.selectedCity.maxZoomLevel-2)),a.$broadcast("enableZoomin",!(b===c.map.state.maxZoom))),b>d?(c.map.zoomincounter++,c.map.zoomoutcounter=0):(c.map.zoomincounter=0,c.map.zoomoutcounter++))});D.push(m);var n=c.$on("amenityClicked",function(a,b){c.removeNeighbourhood(b.type,b.level)});D.push(n);var p=c.$on("projectDetailCardOpened",function(a,b){b.unMapped&&i.setNotification({msg:"Project can not be located on map.",type:"info",confirmText:"OK",onYes:function(){}}),c.$on("pageReady")});D.push(p);var q=c.$on("viewAnalysis",function(a,b){U(b)});D.push(q);var r=c.$on("projectAlvMouseEntered",function(b,d){c.$broadcast("hoverMarkerEnter",d),a.$broadcast("gradient-show",d)});D.push(r);var s=c.$on("updateALVLocation",function(a,b){R(b)});D.push(s);var t=c.$on("projectAlvMouseLeft",function(b,d){c.$broadcast("hoverMarkerLeave",d),a.$broadcast("gradient-hide")});D.push(t);var v=c.$on("localityAlvMouseEntered",function(a,b){c.$broadcast("hoverMarkerEnter",b)});D.push(v);var w=c.$on("localityAlvMouseLeft",function(a,b){c.$broadcast("hoverMarkerLeave",b)});D.push(w);var x=c.$on("$signupRes",function(){a.$broadcast("updateFavoriteProjects")});D.push(x);var z=c.$on("backToCity",function(){o.abortProjectList(),J()});D.push(z);var B=c.$on("alvClosed",function(){$(".map_canvas_wrap").animate({right:"0px"},1e3,"",function(){a.$broadcast("mapResize")})});D.push(B);var C=c.$on("alvOpened",function(){$(".map_canvas_wrap").animate({right:"330px"},1e3)});D.push(C);var E=c.$on("projectListingCallBack",function(){if(c.projectListingCallBackProjectId){var b=c.projectListingCallBackProjectId;a.$broadcast("changeShowNeighbourhood-dd",!1),a.$broadcast("showNeighbourhood",!1),a.$broadcast("openProjectDetailCard",{projId:b,callback:function(){e.search("projectId",b),a.$broadcast("markerClicked",{type:"project",data:{projectId:b}})}}),c.projectListingCallBackProjectId=null}});D.push(E);var G=c.$on("updatePolygonProjects",function(){var b=c.polygonFilter.state;y.filters.and=_.without(y.filters.and,A);var d={distance:b.distance.toFixed(2)/1,lat:b.position.lat.toFixed(4)/1,lon:b.position.lng.toFixed(4)/1};A.geoDistance.geo=d,y.filters.and.push(A),a.$broadcast("fetchReverseGeocode",{coordinates:{lat:A.geoDistance.geo.lat,lng:A.geoDistance.geo.lon},callback:Q}),F()},!0);D.push(G);var I=c.$on("refreshOnFilterStateChange",function(){var b=c.map.state.filter.state;b&&"drag"===c.map.state.filter.action&&(H(b,!0),a.$broadcast("toggleUnmappedProjects"))});D.push(I),u=c.$on("FiltersUpdate",function(a,b){c.map.state.filter.state.maxStoredDistance=c.map.state.filter.state.distance,c.showCityNotSupported||b.hasPathChanged||F()}),D.push(u);var K=c.$on("drawTimeSenseSelected",function(b,c){a.$broadcast("resetSvgLegends"),a.$broadcast("drawTravelTimeHeatMap",c)});D.push(K);var L=c.$on("updateTimeSenseProgress",function(b,c){a.$broadcast("updateTimeSenseProgressOnCard",c)});D.push(L);var M=c.$on("timeSenseStatus",function(b,c,d){var e=d&&d.isPolygonOvelap;e&&a.$broadcast("showDisclaimer",e),a.$broadcast("timeSenseCardStatus",c,d)});D.push(M);var N=c.$on("fetchCatchment",function(a,b){c.fetchCatchment(b)});D.push(N)};E(),c.$on("$destroy",function(){i.removeNotification(),$.each(D,G),x=void 0,y=void 0,z=void 0,A=void 0,B=void 0,t=void 0,v=void 0,w=void 0,D=void 0,c.displaySettings=void 0,c.map=void 0,c.polygonFilter=void 0}),c.removeNeighbourhood=function(b,c,d){a.$broadcast("removeNeighbourhood",{types:b,level:c}),d&&d()},c.activateRedraw=function(){a.$broadcast("showProjectMarkers",!1),a.$broadcast("showPolygonFilter",!1),a.$broadcast("activateDrawing")};var F=function(){"locality"===c.requestType?(y.fields=f.localityListData,k.getLocalityList(h.mergeQueries(y),function(b,d){c.refreshLocalityList({data:b,status:d}),delete y.fields,a.$broadcast("pageReady")},!0,!0)):(y.fields=f.projectListData,o.getProjectList(h.mergeQueries(y),void 0,function(b,d){c.refreshProjectsList({data:b,status:d},!1),delete y.fields,A&&A.geoDistance&&A.geoDistance.geo&&delete A.geoDistance.geo.minDistance,a.$broadcast("pageReady")},!1,!0,!0))},G=function(a,b){b&&b()},H=function(b,d){var f=angular.copy(A),g=e.search().geo?!0:!1;y.filters.and=_.without(y.filters.and,A);var h={distance:b.distance.toFixed(2)/1,lat:b.position.lat.toFixed(4)/1,lon:b.position.lng.toFixed(4)/1};if(A.geoDistance.geo=h,y.filters.and.push(A),d){var i=$.extend(!0,{},e.search());i.geo=[h.distance,h.lat,h.lon].join(","),delete i.projectId,e.search(i),!g||f.geoDistance.geo.lat==A.geoDistance.geo.lat&&f.geoDistance.geo.lon==A.geoDistance.geo.lon?S({showPreviousLabel:!0,type:"locality",distance:A.geoDistance.geo.distance}):a.$broadcast("fetchReverseGeocode",{coordinates:{lat:A.geoDistance.geo.lat,lng:A.geoDistance.geo.lon},callback:Q})}else e.search("geo",[h.distance,h.lat,h.lon].join(","));var j=f.geoDistance.geo,k=A.geoDistance.geo;j.lat!==k.lat||j.lon!==k.lon?(b.maxStoredDistance=k.distance,F()):k.distance<=b.maxStoredDistance?c.refreshProjectsList(c.currentProjects,!1):(A.geoDistance.geo.minDistance=b.maxStoredDistance,b.maxStoredDistance=k.distance,c.isPartialRefresh=!0,F())},I=function(){c.markerSettings.displayType="type"},J=function(){e.search("_keys",null),a.$broadcast("removeCurrentPolygonReference"),a.$broadcast("destroyPolygons"),a.$broadcast("showDisclaimer",!1),c.requestType="locality";var b="projects-in-"+a.selectedCity.label.toLowerCase();delete e.search().geo,c.map.state.filter.action=null,e.path("/maps/"+b),d(function(){c.$digest()},10)},K=function(b){var d,f,g,i;if(b&&b.TYPE&&b.VIEW_TYPE==a.VIEW_TYPES.MAP)if(a.CURRENT_ACTIVE_PAGE=n.GLOBAL.PAGE_TYPES.MAP+"-"+b.TYPE,b.TYPE=b.TYPE.replace("sale-listing-",""),d=b.SEARCH_OBJ,"empty"===b.TYPE)N();else if("projectdetail"===b.TYPE){c.requestType="project",g=d.localityId;var j=e.search().projectId;if(c.searchProjectId=j||d.projectId,!e.search().geo&&d.latitude&&d.longitude){var k={distance:3..toFixed(2)/1,lat:d.latitude.toFixed(4)/1,lon:d.longitude.toFixed(4)/1};e.search("geo",[k.distance,k.lat,k.lon].join(","))}V(g,function(b){b&&a.waitUpdateCity(d.city,c.activateProjectsView,b)}),c.projectListingCallBackProjectId=c.searchProjectId}else if("builder"===b.TYPE){if(!d.builderCities||!d.builderCities.length)return void console.log("oops!! builders cities not found.");a.waitUpdateCity(d.city,O,d)}else if("nearby"===b.TYPE)d.label=d.placeName,c.nearbyPlaceActive=!0,c.currentPlace=d,a.waitUpdateCity(null,c.activateProjectsView,d,d.cityId);else switch(f=d.cityId,b.TYPE){case"city":a.$broadcast("changeShowbyPricePoss",!1);for(var l in C)if(b.SEARCH_OBJ[l]){var m={equal:{}};m.equal[C[l]]=b.SEARCH_OBJ[l],B.and.push(m)}a.waitUpdateCity(d.city,P);break;case"city-locality":case"locality":c.requestType="project",g=d.localityId,V(g,function(b){b&&a.waitUpdateCity(d.city,c.activateProjectsView,b)}),c.projectListingCallBackProjectId=e.search().projectId;break;case"buildercity":c.projectListingCallBackProjectId=e.search().projectId,y.filters.and=[],x.equal.builderId[0]=d.builderId,h.filters.builder.hide=!0,c.requestType="project",c.alvDisplayType="project",t=d.builderName,a.waitUpdateCity(d.city,W);break;case"city-suburb":case"suburb":c.requestType="project",i=d.suburbId,c.projectListingCallBackProjectId=e.search().projectId,M(i,function(b){b&&(c.suburbActive=!0,c.currentSuburb=b,a.waitUpdateCity(d.city,c.activateProjectsView,b))});break;default:console.log("IMPLEMENT SEARCH ON MAPS FOR "+b.TYPE)}},L=function(){c.currentDrawingMode&&(a.$broadcast("showPolygonFilter",!1),a.$broadcast("changeDrawButtonStatus",!1),a.$broadcast("removeCurrentPolygonReference"),c.currentDrawingMode=!1,e.search("_keys",null),y.filters.and=_.without(y.filters.and,A))};a.searchHandler=function(b){c.requestType="project";var d=l.getUrlWithParam(b.redirectUrl),f=c.currentDrawingMode;if("BUILDER"===b.type||"BUILDERCITY"===b.type)return I(),L(),void e.path("/maps/"+d.__url);if(b.isSuggestion)return void e.path("/maps/"+d.__url);if(a.selectedCity&&b.city!=a.selectedCity.label)switch(b.type){case"CITY":c.requestType="locality",I(),L(),w?e.path("/maps/"+d.__url).search(w):e.path("/maps/"+d.__url).search(d.__search);break;case"LOCALITY":i.setNotification({msg:'"'+b.locality.charAt(0).toUpperCase()+b.locality.slice(1)+'" is in '+b.city.toUpperCase()+". Want to go there?",type:"alert",isConfirm:!0,onYes:function(){I(),L(),w?e.path("/maps/"+d.__url).search(w):e.path("/maps/"+d.__url).search(d.__search)},onNo:function(){}});break;case"PROJECT":i.setNotification({msg:"Searched project is in "+b.city.toUpperCase()+". Want to go there?",type:"alert",isconfirm:!0,onYes:function(){I(),L(),c.requestType="project",c._handleProjectSearch(b,!1)},onNo:function(){}});break;case"SUBURB":i.setNotification({msg:"Searched suburb is in "+b.city.toUpperCase()+". Want to go there?",type:"alert",isconfirm:!0,onYes:function(){I(),L(),c.requestType="project",w?e.path("/maps/"+d.__url).search(w):e.path("/maps/"+d.__url).search(d.__search)},onNo:function(){}})}else switch(L(),b.type){case"CITY":c.requestType="locality",w?e.path("/maps/"+d.__url).search(w):e.path("/maps/"+d.__url).search(d.__search);break;case"LOCALITY":if(I(),e.path()==="/maps/"+d.__url){y.filters.and=[];var g=a.currentLocality,h={lat:g.latitude,lon:g.longitude},j=T(g,h,!1);S(g),F(),e.search({}),c._updateMapFilter(j)}else w?e.path("/maps/"+d.__url).search(w):e.path("/maps/"+d.__url).search(d.__search);break;case"PROJECT":c.requestType="project",c._handleProjectSearch(b,f);break;case"SUBURB":if(I(),e.path()==="/maps/"+d.__url){y.filters.and=[];var h={lat:c.currentSuburb.latitude,lon:$scopecurrentSuburb.longitude},j=T(c.currentSuburb,h,!1);S(c.currentSuburb),F(),e.search({}),c._updateMapFilter(j)}else w?e.path("/maps/"+d.__url).search(w):e.path("/maps/"+d.__url).search(d.__search)}};var M=function(a,b){return c.currentSuburb&&c.currentSuburb.id==a?void b(c.currentSuburb):void k.getSuburbById(a,function(a){a&&b(a)})},N=function(){a.cityList?c.selectDefaultCity(a.cityList):c.$watch("cityList",function(a){a&&c.selectDefaultCity(a)})},O=function(b){var d=c.prepareExistingCityLink(b.builderCities,a.cityList,b.builderName,b.redirectUrl);d&&d.length&&(e.search("geo",void 0),e.search("projectId",void 0),q.open({backdrop:"static",keyboard:!1,template:'<div class="padding20 font-selected">'+d+"</div>",controller:["$scope",function(a){a.closeBuilderCitiesModal=function(){a.$dismiss("close")}}]}))},P=function(b){var d,g={},j=a.PARSED_URL_DATA.SEARCH_OBJ.pageType.replace("sale-listing-",""),l=!("city-locality"==j||"projectdetail"==j),m=b&&(b.displayPriority<3||"B2B"==a.applicationType);y.filters.and=[],m?l&&(c.displaySettings&&c.displaySettings.showCityChangeMessage&&i.setNotification({msg:"Icons on map represent localities. Explore a locality by clicking on its icon.",type:"info",confirmText:"OK",onYes:function(){c.displaySettings.showCityChangeMessage=!1}}),a.$broadcast("showMarkers",!1),a.$broadcast("setZoomLevels",{minZoom:c.map.state.minZoom,maxZoom:b.maxZoomLevel}),d={lat:b.centerLatitude,lng:b.centerLongitude},a.$broadcast("showMapFilter",!1),g.center=d,g.zoom=b.minZoomLevel,c._updateMap(g),c.requestType="locality",c.removeNeighbourhood(null,"locality",c.inactiveLocalityNeighbourhood),c.map.zoomincounter=0,c.map.zoomoutcounter=0,a.selValue="",z.equal.cityId[0]=b.id,y.filters.and=[],y.filters.and.push(z),y.paging.rows=9999,y.filters.and=y.filters.and.concat(B.and),y.fields=f.localityListData,k.getLocalityList(h.mergeQueries(y),function(b,d){c.refreshLocalityList({data:b,status:d}),a.$broadcast("pageReady"),delete y.fields},!0,!0)):(i.setNotification({msg:b.label+" isn't supported on maps. Take me to my default city.",type:"info",confirmText:"Take me",onYes:function(){e.path("/maps/")}}),c.showCityNotSupported=!0,a.$broadcast("pageReady"))};c.activateProjectsView=function(b){var d,g={},j={},k=(c.map.state.filter.state,e.search()),l=k&&k.geo,m=a.selectedCity&&(a.selectedCity.displayPriority<3||"B2B"==a.applicationType);if(m){if(l){var n=k.geo.split(",");d={distance:n[0],lat:n[1],lon:n[2]}}else d={lat:b.latitude,lon:b.longitude};var p=k&&k._keys;if(c.requestType="project",c.alvDisplayType="project",a.$broadcast("setZoomLevels",{minZoom:a.selectedCity.maxZoomLevel-2,maxZoom:c.map.state.maxZoom}),y.filters.and=[],l?a.$broadcast("fetchReverseGeocode",{coordinates:{lat:d.lat,lng:d.lon},callback:Q}):p||S(b),p)return a.$broadcast("drawPolygonFromEncodedPath",unescape(p)),c.currentDrawingMode=!0,g.center={lat:d.lat,lng:d.lon},g.zoom=a.selectedCity.maxZoomLevel,c._updateMap(g),a.$broadcast("showMapFilter",!1),j.position=g.center,void c._updateMapFilter(j);j=T(b,d,l),y.fields=f.projectListData,o.getProjectList(h.mergeQueries(y),void 0,function(b,d){c.refreshProjectsList({data:b,status:d},!1),delete y.fields,a.$broadcast("pageReady")},!1,!0,!0),g.center={lat:d.lat,lng:d.lon},g.zoom=a.selectedCity.maxZoomLevel,c._updateMap(g),a.$broadcast("showMapFilter",!1),j.position=g.center,c._updateMapFilter(j)}else i.setNotification({msg:b.label+" isn't supported on maps. Take me to my default city.",type:"info",confirmText:"Take me",onYes:function(){e.path("/maps/")}}),c.showCityNotSupported=!0,a.$broadcast("pageReady")};var Q=function(a,b){S("OK"===a&&b.results.length?{label:b.results[0].name}:{label:"locality center"})};c._inactiveProjectNeighbourhood=function(){var a=$(".proj-card-wrap .neighbour-col");a.find("li a").removeClass("active-neighbour"),a=$(".proj-card-wrap .connectivity-col"),a.find("li a").removeClass("active-neighbour")},c._updateMap=function(b){var d=c.map.state;d.zoom=b.zoom?b.zoom:d.zoom,d.center=b.center?b.center:d.center,a.$broadcast("updateZoom",b.zoom),a.$broadcast("updateCenter",b.center)},c._updateMapFilter=function(b){var d=c.map.state.filter,e=d.state;d.action=b.action?b.action:null,e.distance=e.lastDistance=b.distance?b.distance:e.distance,e.position=b.position?b.position:e.position,a.$broadcast("updateMapFilter")},c.getCdnUrl=function(a){return j.addCDNHost(a)},c.fetchCatchment=function(c){for(var f=[],g=0,h=c.catchmentProjects.length;h>g;g++)f.push(c.catchmentProjects[g].projectId);a.currentCatchment={name:c.name,id:c.id,state:"new",projIds:f,status:c.status,attr:c.metaAttributes};var i,j=e.path(),k=e.search(),l=c.metaAttributes.url.split("?")[0];c.metaAttributes.url.split("?")[1]&&(i=b(c.metaAttributes.url.split("?")[1])),j===l?_.isEqual(k,i)||(u(),
e.url(c.metaAttributes.url),d(function(){r.go(r.current,{},{reload:!0,inherit:!0,location:!1,notify:!0})},10)):e.url(c.metaAttributes.url)};var R=function(a){var b,c;switch(a.showPreviousLabel?a.label=v:v=a.label,a.type){case"builder":c="Showing projects by "+a.label,b={msg:c,type:"info",confirmText:"OK",onYes:function(){}};break;case"locality":default:c=a.distance?"Showing projects around "+a.distance+" kms of "+a.label:"Showing projects around "+a.label,b={msg:c,type:"info",confirmText:"OK",onYes:function(){}}}i.setNotification(b)},S=function(b){d(function(){var d;c.currentDrawingMode||(d=c.map.state.filter.state.distance.toFixed(1)),a.$broadcast("updateALVLocation",{label:b.label,type:b.type,cityLabel:b.cityLabel,distance:d,showPreviousLabel:b.showPreviousLabel})},10)},T=function(a,b,d){var e=c.map.state.filter.state,f={position:{lat:a.latitude.toFixed(4)/1,lng:a.longitude.toFixed(4)/1}};return d?(b.distance>e.maxDistance&&(b.distance=e.maxDistance),f.distance=parseFloat(b.distance)):f.distance=e.minDistance,f.distance=f.distance.toFixed(2)/1,y.filters.and=_.without(y.filters.and,A),A.geoDistance={geo:{distance:f.distance.toFixed(2)/1,lat:parseFloat(b.lat).toFixed(4)/1,lon:parseFloat(b.lon).toFixed(4)/1}},y.filters.and.push(A),e.maxStoredDistance=f.distance,f},U=function(a){var b,d,e,g=0,i=[];c.requestType="project";var j={equal:{localityId:[a.localityId]}};y.filters.and.push(j),y.fields=f.projectListData,o.getProjectList(h.mergeQueries(y),void 0,function(f,h){delete y.fields;var j=p.parseStats(f);for(g=0,b=f.data.items.length;b>g;g++)d=f.data.items[g],e=p.parseProject(d,!1,j),i.push(e.projectId);c._saveCatchment("myCatchment-"+(new Date).getTime(),i,"Inactive",{url:"/maps/"+a.url})})};c.inactiveLocalityNeighbourhood=function(){var a=$(".neighbourhood-dd-wrap");a.hasClass("active-neighbour")&&(a.removeClass("active-neighbour"),a.find("li").removeClass("active-neighbour"))};var V=function(b,c){return a.currentLocality&&a.currentLocality.localityId==b?void c(a.currentLocality):void k.getLocalityById([b],function(b){b&&(a.currentLocality=b[0],c(b[0]))})},W=function(b){e.search("geo",void 0);var d,g={};S({label:t,type:"builder",cityLabel:b.label}),y.filters.and=[],c.isBuilderCitySearchActive=!0,a.$broadcast("showMarkers",!1),a.$broadcast("setZoomLevels",{minZoom:c.map.state.minZoom,maxZoom:b.maxZoomLevel}),d={lat:b.centerLatitude,lng:b.centerLongitude},a.$broadcast("showMapFilter",!1),g.center=d,g.zoom=b.minZoomLevel,c._updateMap(g),c.map.state.filter.state.position=d,c.removeNeighbourhood(null,"project",c._inactiveProjectNeighbourhood),c.map.zoomincounter=0,c.map.zoomoutcounter=0,a.selValue="",z.equal.cityId[0]=b.id,y.filters.and.push(z),y.filters.and.push(x),y.paging.rows=9999,c.alvDisplayType="project",c.requestType="project",y.fields=f.projectListData,o.getProjectList(h.mergeQueries(y),void 0,function(b,d){c.refreshProjectsList({data:b,status:d},!1),delete y.fields,a.$broadcast("pageReady")},!1,!0,!0)};m.searchController=K}])}),define("text!views/directives/common/b2b-listingfilter.html",[],function(){return'<div class="searchFilterBar">\n    <div class="row-full">\n        <div class="searchLeftSide">\n            <div class="refineSearchInfo pull-left">\n                <i class="pt pt-icon-filter-o"></i> Refine Search\n            </div>\n            <div class="pull-left" data-ng-controller="filterCtrl" data-ng-show="showFilters">\n                <div class="pull-left flitClickInfo filBedInfo" data-ga-event="Options_Beds" data-ga-category="Catchment Analysis" equal-type filter=filters.bed></div>\n                <div class="pull-left flitClickInfo filBudgetInfo" data-ga-event="Select_Budget" budget data-ga-category="Catchment Analysis" filter=filters.budget></div>\n                <div class="pull-left flitClickInfo filListInfo" show-dropdown="true" data-ga-event="Options_Listing Type" data-ga-category="Catchment Analysis" equal-type filter=filters.listingType></div>\n                <div class="pull-left flitClickInfo filProjectInfo" data-ga-event="Options_Project Status" data-ga-category="Catchment Analysis" equal-type filter=filters.projectStatus></div>\n                <div class="pull-left flitClickInfo filMoreInfo">\n                    <div class="dropdown-toggle searchDropInfo" data-ng-click="closeSizeWidget($event);">\n                        <span data-ng-if="activeCount()">More ({{activeCount()}})</span>\n                        <span data-ng-if="!activeCount()">More </span>\n                        <i class="pt pt-icon-angle-down iconArrow"></i>\n                    </div>\n                    <ul class="clickListInfo centerTopClick moreFilterInfo" data-ng-click="closeSizeWidget($event);">\n                        <li class="row-full">\n                            <div class="moreFilterBGContInfo moreFiltListInfo" show-dropdown="false" equal-type filter=filters.listingType></div>\n                            <div class="moreFilterBGContInfo moreFiltProjStatInfo" show-dropdown="false" equal-type filter=filters.projectStatus></div>\n                            <div class="moreFilterSMContInfo"\n                                 data-ga-event="More_PossessionIn"\n                                 data-ga-category="Catchment Analysis"\n                                 range-type filter=filters.possessionDate>\n                            </div>\n                            <div class="moreFilterExSMContInfo"\n                                 data-ga-event="More_Baths"\n                                 data-ga-category="Catchment Analysis"\n                                 equal-type filter=filters.bath>\n                            </div>\n                            <div class="moreFilterSMContInfo"\n                                 data-ga-event="More_PropertyType"\n                                 data-ga-category="Catchment Analysis"\n                                 equal-type filter=filters.propertyType></div>\n                            <div class="moreFilterBGContInfo filterSizeShowInfo"\n                                 data-ga-category="Catchment Analysis" data-ga-event="square feet" size filter=filters.size></div>\n                        </li>\n                        <li class="row-full">\n                            <div dynamic-tags filter=filters.locality data-ng-if=\'!filters.locality.hide\'></div>\n                        </li>\n                    </ul>\n                </div>\n            </div>        \n        </div>\n        <div class="searchRightSide" data-ng-show="showFilters">\n            <div class="big_text catch">\n                <span class="textWrap pull-left">\n                    {{currentCatchment.name}}\n                </span>\n                <span class="dropdown">\n                    <a href="javascript:void(0)"\n                       analytics-on\n                       data-analytics-event="Click_New Catchments"\n                       data-analytics-category="Catchment Analysis"\n                       data-analytics-label=""\n                       data-toggle="dropdown" class="dropdown-toggle">\n                        <span data-ng-if="savedCatchment.length <= CatchmentRowCount">({{savedCatchment.length}}) </span>\n                        <span data-ng-if="savedCatchment.length > CatchmentRowCount">({{CatchmentRowCount}}+) </span>\n                        <i class="pt pt-icon-caret-down"></i>\n                    </a>\n                    <div class="dropdown-menu dd-list saved-data-list">\n                        <div class="contentHeader">\n                            <h6 class="paddingL10 marginT10">Saved Catchments</h6>\n                        </div>\n                        <ul>\n                            <li class="pt_row" data-ng-repeat="item in savedCatchment" data-ng-if="$index < CatchmentRowCount"><div class="pt_col-1-2 put-ellipsis" title="{{item.name}}" data-ng-click="fetchCatchment(item);">{{item.name}}</div> <a href="/analysis/catchment/{{item.id}}" class="pt_col-1-2 ta-right"><i class="pt  pt-icon-bar-chart-o"></i>Analyse</a></li>\n                            <li analytics-on\n                                data-analytics-event="Click_More Catchments Analyse"\n                                data-analytics-category="Catchment Analysis"\n                                data-analytics-label=""\n                                data-ng-if="savedCatchment.length > CatchmentRowCount">\n                                <a href="/knowledgebank"  style="color: #0076A3;">More catchments</a></li>\n                            <li analytics-on\n                                data-analytics-event="Click_New Catchments Analyse"\n                                data-analytics-category="Catchment Analysis"\n                                data-analytics-label=""\n                                data-ng-if="!savedCatchment || !savedCatchment.length">You\'ll see your list of saved catchments here, once you save any. Currently, you haven\'t saved any.</h6>\n                        </ul>\n                    </div>\n                </span>\n            </div>\n            <div class="pull-right paddingTB5">\n                <div pt-city-dropdown></div>\n            </div>\n       </div>\n    </div>\n    \n</div>\n'}),function(a,b){"object"==typeof exports?b(exports):"function"==typeof define&&define.amd?define("IntroJS",["exports"],b):b(a)}(this,function(a){function b(a){this._targetElement=a,this._options={nextLabel:"Next &rarr;",prevLabel:"&larr; Back",skipLabel:"Skip",doneLabel:"Done",tooltipPosition:"bottom",tooltipClass:"",exitOnEsc:!0,exitOnOverlayClick:!0,showStepNumbers:!0,keyboardNavigation:!0,showButtons:!0,showBullets:!0,scrollToElement:!0,overlayOpacity:.8}}function c(a){var b=[],c=this;if(this._options.steps)for(var e=[],i=0,k=this._options.steps.length;k>i;i++){var l=d(this._options.steps[i]);if(l.step=b.length+1,"string"==typeof l.element&&(l.element=document.querySelector(l.element)),"undefined"==typeof l.element||null==l.element){var m=document.querySelector(".introjsFloatingElement");null==m&&(m=document.createElement("div"),m.className="introjsFloatingElement",document.body.appendChild(m)),l.element=m,l.position="floating"}null!=l.element&&b.push(l)}else{var e=a.querySelectorAll("*[data-intro]");if(e.length<1)return!1;for(var i=0,n=e.length;n>i;i++){var p=e[i],q=parseInt(p.getAttribute("data-step"),10);q>0&&(b[q-1]={element:p,intro:p.getAttribute("data-intro"),header:p.getAttribute("data-header"),step:parseInt(p.getAttribute("data-step"),10),tooltipClass:p.getAttribute("data-tooltipClass"),position:p.getAttribute("data-position")||this._options.tooltipPosition})}for(var r=0,i=0,n=e.length;n>i;i++){var p=e[i];if(null==p.getAttribute("data-step")){for(;"undefined"!=typeof b[r];)r++;b[r]={element:p,intro:p.getAttribute("data-intro"),header:p.getAttribute("data-header"),step:r+1,tooltipClass:p.getAttribute("data-tooltipClass"),position:p.getAttribute("data-position")||this._options.tooltipPosition}}}}for(var s=[],t=0;t<b.length;t++)b[t]&&s.push(b[t]);return b=s,b.sort(function(a,b){return a.step-b.step}),c._introItems=b,o.call(c,a)&&(f.call(c),a.querySelector(".introjs-skipbutton"),a.querySelector(".introjs-nextbutton"),c._onKeyDown=function(b){27===b.keyCode&&1==c._options.exitOnEsc?(h.call(c,a),void 0!=c._introExitCallback&&c._introExitCallback.call(c)):37===b.keyCode?g.call(c):(39===b.keyCode||13===b.keyCode)&&(f.call(c),b.preventDefault?b.preventDefault():b.returnValue=!1)},c._onResize=function(a){j.call(c,document.querySelector(".introjs-helperLayer"))},window.addEventListener?(this._options.keyboardNavigation&&window.addEventListener("keydown",c._onKeyDown,!0),window.addEventListener("resize",c._onResize,!0)):document.attachEvent&&(this._options.keyboardNavigation&&document.attachEvent("onkeydown",c._onKeyDown),document.attachEvent("onresize",c._onResize))),!1}function d(a){if(null==a||"object"!=typeof a||"undefined"!=typeof a.nodeType)return a;var b={};for(var c in a)b[c]=d(a[c]);return b}function e(a){this._currentStep=a-2,"undefined"!=typeof this._introItems&&f.call(this)}function f(){if(this._direction="forward","undefined"==typeof this._currentStep?this._currentStep=0:++this._currentStep,this._introItems.length<=this._currentStep)return"function"==typeof this._introCompleteCallback&&this._introCompleteCallback.call(this),void h.call(this,this._targetElement);var a=this._introItems[this._currentStep];"undefined"!=typeof this._introBeforeChangeCallback&&this._introBeforeChangeCallback.call(this,a.element),k.call(this,a)}function g(){if(this._direction="backward",0===this._currentStep)return!1;var a=this._introItems[--this._currentStep];"undefined"!=typeof this._introBeforeChangeCallback&&this._introBeforeChangeCallback.call(this,a.element),k.call(this,a)}function h(a){var b=a.querySelector(".introjs-overlay");if(null!=b){b.style.opacity=0,setTimeout(function(){b.parentNode&&b.parentNode.removeChild(b)},500);var c=a.querySelector(".introjs-helperLayer");c&&c.parentNode.removeChild(c);var d=document.querySelector(".introjsFloatingElement");d&&d.parentNode.removeChild(d);var e=document.querySelector(".introjs-showElement");e&&(e.className=e.className.replace(/introjs-[a-zA-Z]+/g,"").replace(/^\s+|\s+$/g,""));var f=document.querySelectorAll(".introjs-fixParent");if(f&&f.length>0)for(var g=f.length-1;g>=0;g--)f[g].className=f[g].className.replace(/introjs-fixParent/g,"").replace(/^\s+|\s+$/g,"");window.removeEventListener?window.removeEventListener("keydown",this._onKeyDown,!0):document.detachEvent&&document.detachEvent("onkeydown",this._onKeyDown),this._currentStep=void 0}}function i(a,b,c,d){var e,f,g,h="";if(b.style.top=null,b.style.right=null,b.style.bottom=null,b.style.left=null,b.style.marginLeft=null,b.style.marginTop=null,c.style.display="inherit","undefined"!=typeof d&&null!=d&&(d.style.top=null,d.style.left=null),this._introItems[this._currentStep]){e=this._introItems[this._currentStep],h="string"==typeof e.tooltipClass?e.tooltipClass:this._options.tooltipClass,b.className=("introjs-tooltip "+h).replace(/^\s+|\s+$/g,"");var h=this._options.tooltipClass;switch(currentTooltipPosition=this._introItems[this._currentStep].position,currentTooltipPosition){case"top":b.style.left="15px",b.style.top="-"+(p(b).height+10)+"px",c.className="introjs-arrow bottom";break;case"right":b.style.left=p(a).width+20+"px",c.className="introjs-arrow left";break;case"left":1==this._options.showStepNumbers&&(b.style.top="15px"),b.style.right=p(a).width+20+"px",c.className="introjs-arrow right";break;case"floating":c.style.display="none",f=p(b),b.style.left="50%",b.style.top="50%",b.style.marginLeft="-"+f.width/2+"px",b.style.marginTop="-"+f.height/2+"px","undefined"!=typeof d&&null!=d&&(d.style.left="-"+(f.width/2+18)+"px",d.style.top="-"+(f.height/2+18)+"px");break;case"bottom-right-aligned":c.className="introjs-arrow top-right",b.style.right="0px",b.style.bottom="-"+(p(b).height+10)+"px";break;case"bottom-middle-aligned":g=p(a),f=p(b),c.className="introjs-arrow top-middle",b.style.left=g.width/2-f.width/2+"px",b.style.bottom="-"+(f.height+10)+"px";break;case"bottom-left-aligned":case"bottom":default:b.style.bottom="-"+(p(b).height+10)+"px",c.className="introjs-arrow top"}}}function j(a){if(a){if(!this._introItems[this._currentStep])return;var b=this._introItems[this._currentStep],c=p(b.element),d=10;"floating"==b.position&&(d=0),a.setAttribute("style","width: "+(c.width+d)+"px; height:"+(c.height+d)+"px; top:"+(c.top-5)+"px;left: "+(c.left-5)+"px;")}}function k(a){"undefined"!=typeof this._introChangeCallback&&this._introChangeCallback.call(this,a.element);var b=this,c=document.querySelector(".introjs-helperLayer");if(p(a.element),null!=c){var d=c.querySelector(".introjs-helperNumberLayer"),e=c.querySelector(".introjs-tooltiptext"),k=c.querySelector(".introjs-tooltipheadertext"),o=c.querySelector(".introjs-arrow"),q=c.querySelector(".introjs-tooltip"),r=c.querySelector(".introjs-skipbutton"),s=c.querySelector(".introjs-prevbutton"),t=c.querySelector(".introjs-nextbutton");if(q.style.opacity=0,null!=d){var u=this._introItems[a.step-2>=0?a.step-2:0];(null!=u&&"forward"==this._direction&&"floating"==u.position||"backward"==this._direction&&"floating"==a.position)&&(d.style.opacity=0)}j.call(b,c);var v=document.querySelectorAll(".introjs-fixParent");if(v&&v.length>0)for(var w=v.length-1;w>=0;w--)v[w].className=v[w].className.replace(/introjs-fixParent/g,"").replace(/^\s+|\s+$/g,"");var x=document.querySelector(".introjs-showElement");x.className=x.className.replace(/introjs-[a-zA-Z]+/g,"").replace(/^\s+|\s+$/g,""),b._lastShowElementTimer&&clearTimeout(b._lastShowElementTimer),b._lastShowElementTimer=setTimeout(function(){null!=d&&(d.innerHTML=a.step),e.innerHTML=a.intro,k.innerHTML=a.header||"",i.call(b,a.element,q,o,d),c.querySelector(".introjs-bullets li > a.active").className="",c.querySelector('.introjs-bullets li > a[data-stepnumber="'+a.step+'"]').className="active",q.style.opacity=1,d&&(d.style.opacity=1)},350)}else{var y=document.createElement("div"),z=document.createElement("div"),A=document.createElement("div"),B=document.createElement("div");tooltipTextLayer=document.createElement("div"),bulletsLayer=document.createElement("div"),buttonsLayer=document.createElement("div"),y.className="introjs-helperLayer",j.call(b,y),this._targetElement.appendChild(y),z.className="introjs-arrow",B.className="introjs-tooltipheadertext",B.innerHTML=a.header||"",tooltipTextLayer.className="introjs-tooltiptext",tooltipTextLayer.innerHTML=a.intro,bulletsLayer.className="introjs-bullets",this._options.showBullets===!1&&(bulletsLayer.style.display="none");for(var C=document.createElement("ul"),w=0,D=this._introItems.length;D>w;w++){var E=document.createElement("li"),F=document.createElement("a");F.onclick=function(){b.goToStep(this.getAttribute("data-stepnumber"))},w===a.step-1&&(F.className="active"),F.href="javascript:void(0);",F.innerHTML="&nbsp;",F.setAttribute("data-stepnumber",this._introItems[w].step),E.appendChild(F),C.appendChild(E)}if(bulletsLayer.appendChild(C),buttonsLayer.className="introjs-tooltipbuttons",this._options.showButtons===!1&&(buttonsLayer.style.display="none"),A.className="introjs-tooltip",A.appendChild(B),A.appendChild(tooltipTextLayer),A.appendChild(bulletsLayer),1==this._options.showStepNumbers){var G=document.createElement("span");G.className="introjs-helperNumberLayer",G.innerHTML=a.step,y.appendChild(G)}A.appendChild(z),y.appendChild(A);var t=document.createElement("a");t.onclick=function(){b._introItems.length-1!=b._currentStep&&f.call(b)},t.href="javascript:void(0);",t.innerHTML=this._options.nextLabel;var s=document.createElement("a");s.onclick=function(){0!=b._currentStep&&g.call(b)},s.href="javascript:void(0);",s.innerHTML=this._options.prevLabel;var r=document.createElement("a");r.className="introjs-button introjs-skipbutton seoclick",r.href="javascript:void(0);",r.innerHTML=this._options.skipLabel,r.onclick=function(){b._introItems.length-1==b._currentStep&&"function"==typeof b._introCompleteCallback&&b._introCompleteCallback.call(b),b._introItems.length-1!=b._currentStep&&"function"==typeof b._introExitCallback&&b._introExitCallback.call(b),h.call(b,b._targetElement)},buttonsLayer.appendChild(r),this._introItems.length>1&&(buttonsLayer.appendChild(s),buttonsLayer.appendChild(t)),A.appendChild(buttonsLayer),i.call(b,a.element,A,z,G)}0==this._currentStep&&this._introItems.length>1?(s.className="introjs-button introjs-prevbutton introjs-disabled",t.className="introjs-button introjs-nextbutton",r.innerHTML=this._options.skipLabel):this._introItems.length-1==this._currentStep||1==this._introItems.length?(r.innerHTML=this._options.doneLabel,s.className="introjs-button introjs-prevbutton",t.className="introjs-button introjs-nextbutton introjs-disabled"):(s.className="introjs-button introjs-prevbutton",t.className="introjs-button introjs-nextbutton",r.innerHTML=this._options.skipLabel),t.focus(),a.element.className+=" introjs-showElement";var H=l(a.element,"position");"absolute"!==H&&"relative"!==H&&(a.element.className+=" introjs-relativePosition");for(var I=a.element.parentNode;null!=I&&"body"!==I.tagName.toLowerCase();){var J=l(I,"z-index"),K=parseFloat(l(I,"opacity")),L=l(I,"transform")||l(I,"-webkit-transform")||l(I,"-moz-transform")||l(I,"-ms-transform")||l(I,"-o-transform");(/[0-9]+/.test(J)||1>K||"none"!==L)&&(I.className+=" introjs-fixParent"),I=I.parentNode}if(!n(a.element)&&this._options.scrollToElement===!0){var M=a.element.getBoundingClientRect(),N=m().height,O=M.bottom-(M.bottom-M.top),P=M.bottom-N;0>O||a.element.clientHeight>N?window.scrollBy(0,O-30):window.scrollBy(0,P+100)}"undefined"!=typeof this._introAfterChangeCallback&&this._introAfterChangeCallback.call(this,a.element)}function l(a,b){var c="";return a.currentStyle?c=a.currentStyle[b]:document.defaultView&&document.defaultView.getComputedStyle&&(c=document.defaultView.getComputedStyle(a,null).getPropertyValue(b)),c&&c.toLowerCase?c.toLowerCase():c}function m(){if(void 0!=window.innerWidth)return{width:window.innerWidth,height:window.innerHeight};var a=document.documentElement;return{width:a.clientWidth,height:a.clientHeight}}function n(a){var b=a.getBoundingClientRect();return b.top>=0&&b.left>=0&&b.bottom+80<=window.innerHeight&&b.right<=window.innerWidth}function o(a){var b=document.createElement("div"),c="",d=this;if(b.className="introjs-overlay","body"===a.tagName.toLowerCase())c+="top: 0;bottom: 0; left: 0;right: 0;position: fixed;",b.setAttribute("style",c);else{var e=p(a);e&&(c+="width: "+e.width+"px; height:"+e.height+"px; top:"+e.top+"px;left: "+e.left+"px;",b.setAttribute("style",c))}return a.appendChild(b),b.onclick=function(){1==d._options.exitOnOverlayClick&&(h.call(d,a),void 0!=d._introExitCallback&&d._introExitCallback.call(d))},setTimeout(function(){c+="opacity: "+d._options.overlayOpacity.toString()+";",b.setAttribute("style",c)},10),!0}function p(a){var b={};b.width=a.offsetWidth,b.height=a.offsetHeight;for(var c=0,d=0;a&&!isNaN(a.offsetLeft)&&!isNaN(a.offsetTop);)c+=a.offsetLeft,d+=a.offsetTop,a=a.offsetParent;return b.top=d,b.left=c,b}function q(a,b){var c={};for(var d in a)c[d]=a[d];for(var d in b)c[d]=b[d];return c}var r="0.9.0",s=function(a){if("object"==typeof a)return new b(a);if("string"==typeof a){var c=document.querySelector(a);if(c)return new b(c);throw new Error("There is no element with given selector.")}return new b(document.body)};return s.version=r,s.fn=b.prototype={clone:function(){return new b(this)},setOption:function(a,b){return this._options[a]=b,this},setOptions:function(a){return this._options=q(this._options,a),this},start:function(){return c.call(this,this._targetElement),this},goToStep:function(a){return e.call(this,a),this},nextStep:function(){return f.call(this),this},previousStep:function(){return g.call(this),this},exit:function(){h.call(this,this._targetElement)},refresh:function(){return j.call(this,document.querySelector(".introjs-helperLayer")),this},onbeforechange:function(a){if("function"!=typeof a)throw new Error("Provided callback for onbeforechange was not a function");return this._introBeforeChangeCallback=a,this},onchange:function(a){if("function"!=typeof a)throw new Error("Provided callback for onchange was not a function.");return this._introChangeCallback=a,this},onafterchange:function(a){if("function"!=typeof a)throw new Error("Provided callback for onafterchange was not a function");return this._introAfterChangeCallback=a,this},oncomplete:function(a){if("function"!=typeof a)throw new Error("Provided callback for oncomplete was not a function.");return this._introCompleteCallback=a,this},onexit:function(a){if("function"!=typeof a)throw new Error("Provided callback for onexit was not a function.");return this._introExitCallback=a,this}},a.introJs=s,s}),define("services/introJsService",["app","IntroJS","services/b2b/CookieService"],function(a,b){a.factory("IntroJsService",["$location","$rootScope","CookieService",function(a,b,c){var d=function(a,b){return!1},e=function(a){return!1};return{checkUrlValidity:d,callIntroJs:e}}])}),define("validators/commonValidators",["app"],function(a){a.factory("CommonValidators",[function(){var a="^((\\d+\\.?\\d{1,2})|(\\.?\\d{1,2}))$",b="^\\d+$",c="[^A-Za-z0-9.-]",d="^[^<>'\"]*$",e="^[a-zA-Z0-9]+$",f="^(19|20)dd[- /.](0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])$",g=function(a,b){var c=new RegExp(b),d=c.test(a);return d},h=function(a){return g(a,b)},i=function(b){return g(b,a)},j=function(a){return g(a,e)},k=function(a){return g(a,f)},l=function(a){return g(a,c)},m=function(a){return g(a,d)},n=function(a){var b="^[^<>'\"]{1,dynamic}$",c=b.replace("dynamic",a);return c},o=function(a){return a&&a.trim().length>0?!0:!1},p=function(a){var b=/[a-zA-Z ]+/;return a&&b.test(a.trim())?!0:!1},q=function(a){var b=/[a-zA-Z ]+/;return a&&b.test(a.trim())?!0:!1},r=function(a){return h(a)&&10===a.trim().length?!0:!1},s=function(a){var b=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return a&&b.test(a.trim())?!0:!1};return{isName:p,isDate:k,isEmail:s,isMobile:r,haveTags:m,isInteger:h,isNumeric:i,isValidString:o,getlengthRegex:n,isAlphanumeric:j,haveSpecialCharacters:l,isCountry:q}}])}),define("services/signupService",["require","app","services/globalService"],function(a,b){b.factory("SignupService",["$rootScope","$modal","GlobalService",function(b,c,d){var e="",f=function(d){return d||(d=""),b.redirectUrl=d,e=c.open({templateUrl:"views/modal/signInRegister.html",controller:"signUpCtrl",resolve:{deps:["$q","$rootScope",function(b,c){var d=b.defer(),e=["scripts/controllers/common/signUpCtrl.js"];return a(e,function(){c.$apply(function(){d.resolve()})}),d.promise}]}})},g=function(){if(e.close)try{e.close()}catch(a){window.console.log("Error closing model: "+a.message)}};return b.$watch("userDetails",function(a,c){a&&a!==c&&g(),a?(b.$broadcast("$signupRes"),b.loggedIn=!0):b.loggedIn=!1}),{openSignUp:f,closeSignUp:g}}])}),define("directives/base/pt-placeholder",["app","services/globalService"],function(a){a.directive("ptPlaceholder",["$rootScope","GlobalService",function(a,b){return{restrict:"A",require:"ngModel",link:function(c,d,e,f){var g;c.$on("$destroy",function(){d.unbind("focus"),d.unbind("blur")});var h,i=!1,j=function(c){var d=b.getObjectValuebyString(a,c);return d?d:c},g=function(){d.val(""),d.removeClass("exampleonly"),i&&d.attr("type","password")};c.$watch(e.ngModel,function(a){h=a||""}),c.$watch(function(){return e.ptPlaceholder},function(a){return a&&!h&&d[0]!==document.activeElement?(k(),h="",j(e.ptPlaceholder)):void 0}),d.bind("focus",function(){""===h&&g()}),d.bind("blur",function(){""===d.val()&&k()}),f.$formatters.unshift(function(a){return a||d[0]===document.activeElement?a:(k(),h="",j(e.ptPlaceholder))});var k=function(){d[0].value=j(e.ptPlaceholder),d.addClass("exampleonly"),"password"===d.attr("type")&&(d.attr("type","text"),i=!0)};d[0].value||k()}}}])}),function(a,b){function c(b,c){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,b.href&&f&&"map"===e.nodeName.toLowerCase()?(g=a("img[usemap=#"+f+"]")[0],!!g&&d(g)):!1):(/input|select|textarea|button|object/.test(h)?!b.disabled:"a"===h?b.href||c:c)&&d(b)}function d(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}var e=0,f=/^ui-id-\d+$/;a.ui=a.ui||{},a.extend(a.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({focus:function(b){return function(c,d){return"number"==typeof c?this.each(function(){var b=this;setTimeout(function(){a(b).focus(),d&&d.call(b)},c)}):b.apply(this,arguments)}}(a.fn.focus),scrollParent:function(){var b;return b=a.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.css(this,"position"))&&/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length)for(var d,e,f=a(this[0]);f.length&&f[0]!==document;){if(d=f.css("position"),("absolute"===d||"relative"===d||"fixed"===d)&&(e=parseInt(f.css("zIndex"),10),!isNaN(e)&&0!==e))return e;f=f.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})},removeUniqueId:function(){return this.each(function(){f.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),e&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var f="Width"===d?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return"number"!=typeof b?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),a.support.selectstart="onselectstart"in document.createElement("div"),a.fn.extend({disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c){var d,e=a.plugins[b];if(e&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(d=0;e.length>d;d++)a.options[e[d][0]]&&e[d][1].apply(a.element,c)}},hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)}})}(jQuery),define("jqueryCore",["jquery"],function(){}),function(a,b){var c=0,d=Array.prototype.slice,e=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(f){}e(b)},a.widget=function(c,d,e){var f,g,h,i,j={},k=c.split(".")[0];c=c.split(".")[1],f=k+"-"+c,e||(e=d,d=a.Widget),a.expr[":"][f.toLowerCase()]=function(b){return!!a.data(b,f)},a[k]=a[k]||{},g=a[k][c],h=a[k][c]=function(a,c){return this._createWidget?(arguments.length&&this._createWidget(a,c),b):new h(a,c)},a.extend(h,g,{version:e.version,_proto:a.extend({},e),_childConstructors:[]}),i=new d,i.options=a.widget.extend({},i.options),a.each(e,function(c,e){return a.isFunction(e)?(j[c]=function(){var a=function(){return d.prototype[c].apply(this,arguments)},b=function(a){return d.prototype[c].apply(this,a);
};return function(){var c,d=this._super,f=this._superApply;return this._super=a,this._superApply=b,c=e.apply(this,arguments),this._super=d,this._superApply=f,c}}(),b):(j[c]=e,b)}),h.prototype=a.widget.extend(i,{widgetEventPrefix:g?i.widgetEventPrefix||c:c},j,{constructor:h,namespace:k,widgetName:c,widgetFullName:f}),g?(a.each(g._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,h,c._proto)}),delete g._childConstructors):d._childConstructors.push(h),a.widget.bridge(c,h)},a.widget.extend=function(c){for(var e,f,g=d.call(arguments,1),h=0,i=g.length;i>h;h++)for(e in g[h])f=g[h][e],g[h].hasOwnProperty(e)&&f!==b&&(c[e]=a.isPlainObject(f)?a.isPlainObject(c[e])?a.widget.extend({},c[e],f):a.widget.extend({},f):f);return c},a.widget.bridge=function(c,e){var f=e.prototype.widgetFullName||c;a.fn[c]=function(g){var h="string"==typeof g,i=d.call(arguments,1),j=this;return g=!h&&i.length?a.widget.extend.apply(null,[g].concat(i)):g,h?this.each(function(){var d,e=a.data(this,f);return e?a.isFunction(e[g])&&"_"!==g.charAt(0)?(d=e[g].apply(e,i),d!==e&&d!==b?(j=d&&d.jquery?j.pushStack(d.get()):d,!1):b):a.error("no such method '"+g+"' for "+c+" widget instance"):a.error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+g+"'")}):this.each(function(){var b=a.data(this,f);b?b.option(g||{})._init():a.data(this,f,new e(g,this))}),j}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e,f,g,h=c;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof c)if(h={},e=c.split("."),c=e.shift(),e.length){for(f=h[c]=a.widget.extend({},this.options[c]),g=0;e.length-1>g;g++)f[e[g]]=f[e[g]]||{},f=f[e[g]];if(c=e.pop(),1===arguments.length)return f[c]===b?null:f[c];f[c]=d}else{if(1===arguments.length)return this.options[c]===b?null:this.options[c];h[c]=d}return this._setOptions(h),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(c,d,e){var f,g=this;"boolean"!=typeof c&&(e=d,d=c,c=!1),e?(d=f=a(d),this.bindings=this.bindings.add(d)):(e=d,d=this.element,f=this.widget()),a.each(e,function(e,h){function i(){return c||g.options.disabled!==!0&&!a(this).hasClass("ui-state-disabled")?("string"==typeof h?g[h]:h).apply(g,arguments):b}"string"!=typeof h&&(i.guid=h.guid=h.guid||i.guid||a.guid++);var j=e.match(/^(\w+)\s*(.*)$/),k=j[1]+g.eventNamespace,l=j[2];l?f.delegate(l,k,i):d.bind(k,i)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.unbind(b).undelegate(b)},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.apply(this.element[0],[c].concat(d))===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?e===!0||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}})}(jQuery),define("jqueryUIWidget",["jqueryCore"],function(){}),function(a){var b=!1;a(document).mouseup(function(){b=!1}),a.widget("ui.mouse",{version:"1.10.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){return!0===a.data(c.target,b.widgetName+".preventClickEvent")?(a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(c){if(!b){this._mouseStarted&&this._mouseUp(c),this._mouseDownEvent=c;var d=this,e=1===c.which,f="string"==typeof this.options.cancel&&c.target.nodeName?a(c.target).closest(this.options.cancel).length:!1;return e&&!f&&this._mouseCapture(c)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&(this._mouseStarted=this._mouseStart(c)!==!1,!this._mouseStarted)?(c.preventDefault(),!0):(!0===a.data(c.target,this.widgetName+".preventClickEvent")&&a.removeData(c.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),c.preventDefault(),b=!0,!0)):!0}},_mouseMove:function(b){return a.ui.ie&&(!document.documentMode||9>document.documentMode)&&!b.button?this._mouseUp(b):this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted)},_mouseUp:function(b){return a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),define("jqueryUIMouse",["jqueryUIWidget"],function(){}),function(a){var b=5;a.widget("ui.slider",a.ui.mouse,{version:"1.10.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var b,c,d=this.options,e=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),f="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",g=[];for(c=d.values&&d.values.length||1,e.length>c&&(e.slice(c).remove(),e=e.slice(0,c)),b=e.length;c>b;b++)g.push(f);this.handles=e.add(a(g.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(b){a(this).data("ui-slider-handle-index",b)})},_createRange:function(){var b=this.options,c="";b.range?(b.range===!0&&(b.values?b.values.length&&2!==b.values.length?b.values=[b.values[0],b.values[0]]:a.isArray(b.values)&&(b.values=b.values.slice(0)):b.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=a("<div></div>").appendTo(this.element),c="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(c+("min"===b.range||"max"===b.range?" ui-slider-range-"+b.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){var a=this.handles.add(this.range).filter("a");this._off(a),this._on(a,this._handleEvents),this._hoverable(a),this._focusable(a)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(b){var c,d,e,f,g,h,i,j,k=this,l=this.options;return l.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),c={x:b.pageX,y:b.pageY},d=this._normValueFromMouse(c),e=this._valueMax()-this._valueMin()+1,this.handles.each(function(b){var c=Math.abs(d-k.values(b));(e>c||e===c&&(b===k._lastChangedValue||k.values(b)===l.min))&&(e=c,f=a(this),g=b)}),h=this._start(b,g),h===!1?!1:(this._mouseSliding=!0,this._handleIndex=g,f.addClass("ui-state-active").focus(),i=f.offset(),j=!a(b.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=j?{left:0,top:0}:{left:b.pageX-i.left-f.width()/2,top:b.pageY-i.top-f.height()/2-(parseInt(f.css("borderTopWidth"),10)||0)-(parseInt(f.css("borderBottomWidth"),10)||0)+(parseInt(f.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(b,g,d),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(a){var b={x:a.pageX,y:a.pageY},c=this._normValueFromMouse(b);return this._slide(a,this._handleIndex,c),!1},_mouseStop:function(a){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(a){var b,c,d,e,f;return"horizontal"===this.orientation?(b=this.elementSize.width,c=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,c=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),d=c/b,d>1&&(d=1),0>d&&(d=0),"vertical"===this.orientation&&(d=1-d),e=this._valueMax()-this._valueMin(),f=this._valueMin()+d*e,this._trimAlignValue(f)},_start:function(a,b){var c={handle:this.handles[b],value:this.value()};return this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("start",a,c)},_slide:function(a,b,c){var d,e,f;this.options.values&&this.options.values.length?(d=this.values(b?0:1),2===this.options.values.length&&this.options.range===!0&&(0===b&&c>d||1===b&&d>c)&&(c=d),c!==this.values(b)&&(e=this.values(),e[b]=c,f=this._trigger("slide",a,{handle:this.handles[b],value:c,values:e}),d=this.values(b?0:1),f!==!1&&this.values(b,c))):c!==this.value()&&(f=this._trigger("slide",a,{handle:this.handles[b],value:c}),f!==!1&&this.value(c))},_stop:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("stop",a,c)},_change:function(a,b){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._lastChangedValue=b,this._trigger("change",a,c)}},value:function(a){return arguments.length?(this.options.value=this._trimAlignValue(a),this._refreshValue(),void this._change(null,0)):this._value()},values:function(b,c){var d,e,f;if(arguments.length>1)return this.options.values[b]=this._trimAlignValue(c),this._refreshValue(),void this._change(null,b);if(!arguments.length)return this._values();if(!a.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(b):this.value();for(d=this.options.values,e=arguments[0],f=0;d.length>f;f+=1)d[f]=this._trimAlignValue(e[f]),this._change(null,f);this._refreshValue()},_setOption:function(b,c){var d,e=0;switch("range"===b&&this.options.range===!0&&("min"===c?(this.options.value=this._values(0),this.options.values=null):"max"===c&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),a.isArray(this.options.values)&&(e=this.options.values.length),a.Widget.prototype._setOption.apply(this,arguments),b){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),d=0;e>d;d+=1)this._change(null,d);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a)},_values:function(a){var b,c,d;if(arguments.length)return b=this.options.values[a],b=this._trimAlignValue(b);if(this.options.values&&this.options.values.length){for(c=this.options.values.slice(),d=0;c.length>d;d+=1)c[d]=this._trimAlignValue(c[d]);return c}return[]},_trimAlignValue:function(a){if(this._valueMin()>=a)return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=this.options.step>0?this.options.step:1,c=(a-this._valueMin())%b,d=a-c;return 2*Math.abs(c)>=b&&(d+=c>0?b:-b),parseFloat(d.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var b,c,d,e,f,g=this.options.range,h=this.options,i=this,j=this._animateOff?!1:h.animate,k={};this.options.values&&this.options.values.length?this.handles.each(function(d){c=100*((i.values(d)-i._valueMin())/(i._valueMax()-i._valueMin())),k["horizontal"===i.orientation?"left":"bottom"]=c+"%",a(this).stop(1,1)[j?"animate":"css"](k,h.animate),i.options.range===!0&&("horizontal"===i.orientation?(0===d&&i.range.stop(1,1)[j?"animate":"css"]({left:c+"%"},h.animate),1===d&&i.range[j?"animate":"css"]({width:c-b+"%"},{queue:!1,duration:h.animate})):(0===d&&i.range.stop(1,1)[j?"animate":"css"]({bottom:c+"%"},h.animate),1===d&&i.range[j?"animate":"css"]({height:c-b+"%"},{queue:!1,duration:h.animate}))),b=c}):(d=this.value(),e=this._valueMin(),f=this._valueMax(),c=f!==e?100*((d-e)/(f-e)):0,k["horizontal"===this.orientation?"left":"bottom"]=c+"%",this.handle.stop(1,1)[j?"animate":"css"](k,h.animate),"min"===g&&"horizontal"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({width:c+"%"},h.animate),"max"===g&&"horizontal"===this.orientation&&this.range[j?"animate":"css"]({width:100-c+"%"},{queue:!1,duration:h.animate}),"min"===g&&"vertical"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({height:c+"%"},h.animate),"max"===g&&"vertical"===this.orientation&&this.range[j?"animate":"css"]({height:100-c+"%"},{queue:!1,duration:h.animate}))},_handleEvents:{keydown:function(c){var d,e,f,g,h=a(c.target).data("ui-slider-handle-index");switch(c.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(c.preventDefault(),!this._keySliding&&(this._keySliding=!0,a(c.target).addClass("ui-state-active"),d=this._start(c,h),d===!1))return}switch(g=this.options.step,e=f=this.options.values&&this.options.values.length?this.values(h):this.value(),c.keyCode){case a.ui.keyCode.HOME:f=this._valueMin();break;case a.ui.keyCode.END:f=this._valueMax();break;case a.ui.keyCode.PAGE_UP:f=this._trimAlignValue(e+(this._valueMax()-this._valueMin())/b);break;case a.ui.keyCode.PAGE_DOWN:f=this._trimAlignValue(e-(this._valueMax()-this._valueMin())/b);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(e===this._valueMax())return;f=this._trimAlignValue(e+g);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(e===this._valueMin())return;f=this._trimAlignValue(e-g)}this._slide(c,h,f)},click:function(a){a.preventDefault()},keyup:function(b){var c=a(b.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(b,c),this._change(b,c),a(b.target).removeClass("ui-state-active"))}}})}(jQuery),define("jqueryUISlider",["jqueryUIMouse"],function(){}),function(a){a.widget("ui.draggable",a.ui.mouse,{version:"1.10.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(b){var c=this.options;return this.helper||c.disabled||a(b.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(b),this.handle?(a(c.iframeFix===!0?"iframe":c.iframeFix).each(function(){a("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(a(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(b){var c=this.options;return this.helper=this._createHelper(b),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),this._setContainment(),this._trigger("start",b)===!1?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_mouseDrag:function(b,c){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),!c){var d=this._uiHash();if(this._trigger("drag",b,d)===!1)return this._mouseUp({}),!1;this.position=d.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var c=this,d=!1;return a.ui.ddmanager&&!this.options.dropBehaviour&&(d=a.ui.ddmanager.drop(this,b)),this.dropped&&(d=this.dropped,this.dropped=!1),"original"!==this.options.helper||a.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!d||"valid"===this.options.revert&&d||this.options.revert===!0||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)?a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){c._trigger("stop",b)!==!1&&c._clear()}):this._trigger("stop",b)!==!1&&this._clear(),!1):!1},_mouseUp:function(b){return a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){return this.options.handle?!!a(b.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b])):"clone"===c.helper?this.element.clone().removeAttr("id"):this.element;return d.parents("body").length||d.appendTo("parent"===c.appendTo?this.element[0].parentNode:c.appendTo),d[0]===this.element[0]||/(fixed|absolute)/.test(d.css("position"))||d.css("position","absolute"),d},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options;return e.containment?"window"===e.containment?void(this.containment=[a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,a(window).scrollLeft()+a(window).width()-this.helperProportions.width-this.margins.left,a(window).scrollTop()+(a(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===e.containment?void(this.containment=[0,0,a(document).width()-this.helperProportions.width-this.margins.left,(a(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):e.containment.constructor===Array?void(this.containment=e.containment):("parent"===e.containment&&(e.containment=this.helper[0].parentNode),c=a(e.containment),d=c[0],void(d&&(b="hidden"!==c.css("overflow"),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(b?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(b?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=c))):void(this.containment=null)},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:e.scrollTop(),left:e.scrollLeft()}),{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*d}},_generatePosition:function(b){var c,d,e,f,g=this.options,h="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=b.pageX,j=b.pageY;return this.offset.scroll||(this.offset.scroll={top:h.scrollTop(),left:h.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(d=this.relative_container.offset(),c=[this.containment[0]+d.left,this.containment[1]+d.top,this.containment[2]+d.left,this.containment[3]+d.top]):c=this.containment,b.pageX-this.offset.click.left<c[0]&&(i=c[0]+this.offset.click.left),b.pageY-this.offset.click.top<c[1]&&(j=c[1]+this.offset.click.top),b.pageX-this.offset.click.left>c[2]&&(i=c[2]+this.offset.click.left),b.pageY-this.offset.click.top>c[3]&&(j=c[3]+this.offset.click.top)),g.grid&&(e=g.grid[1]?this.originalPageY+Math.round((j-this.originalPageY)/g.grid[1])*g.grid[1]:this.originalPageY,j=c?e-this.offset.click.top>=c[1]||e-this.offset.click.top>c[3]?e:e-this.offset.click.top>=c[1]?e-g.grid[1]:e+g.grid[1]:e,f=g.grid[0]?this.originalPageX+Math.round((i-this.originalPageX)/g.grid[0])*g.grid[0]:this.originalPageX,i=c?f-this.offset.click.left>=c[0]||f-this.offset.click.left>c[2]?f:f-this.offset.click.left>=c[0]?f-g.grid[0]:f+g.grid[0]:f)),{top:j-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:i-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(b,c,d){return d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d]),"drag"===b&&(this.positionAbs=this._convertPositionTo("absolute")),a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c){var d=a(this).data("ui-draggable"),e=d.options,f=a.extend({},c,{item:d.element});d.sortables=[],a(e.connectToSortable).each(function(){var c=a.data(this,"ui-sortable");c&&!c.options.disabled&&(d.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",b,f))})},stop:function(b,c){var d=a(this).data("ui-draggable"),e=a.extend({},c,{item:d.element});a.each(d.sortables,function(){this.instance.isOver?(this.instance.isOver=0,d.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,"original"===d.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,e))})},drag:function(b,c){var d=a(this).data("ui-draggable"),e=this;a.each(d.sortables,function(){var f=!1,g=this;this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(f=!0,a.each(d.sortables,function(){return this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this!==g&&this.instance._intersectsWith(this.instance.containerCache)&&a.contains(g.instance.element[0],this.instance.element[0])&&(f=!1),f})),f?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(e).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=d.offset.click.top,this.instance.offset.click.left=d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,d._trigger("toSortable",b),d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),d._trigger("fromSortable",b),d.dropped=!1)})}}),a.ui.plugin.add("draggable","cursor",{start:function(){var b=a("body"),c=a(this).data("ui-draggable").options;
b.css("cursor")&&(c._cursor=b.css("cursor")),b.css("cursor",c.cursor)},stop:function(){var b=a(this).data("ui-draggable").options;b._cursor&&a("body").css("cursor",b._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c){var d=a(c.helper),e=a(this).data("ui-draggable").options;d.css("opacity")&&(e._opacity=d.css("opacity")),d.css("opacity",e.opacity)},stop:function(b,c){var d=a(this).data("ui-draggable").options;d._opacity&&a(c.helper).css("opacity",d._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(){var b=a(this).data("ui-draggable");b.scrollParent[0]!==document&&"HTML"!==b.scrollParent[0].tagName&&(b.overflowOffset=b.scrollParent.offset())},drag:function(b){var c=a(this).data("ui-draggable"),d=c.options,e=!1;c.scrollParent[0]!==document&&"HTML"!==c.scrollParent[0].tagName?(d.axis&&"x"===d.axis||(c.overflowOffset.top+c.scrollParent[0].offsetHeight-b.pageY<d.scrollSensitivity?c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop+d.scrollSpeed:b.pageY-c.overflowOffset.top<d.scrollSensitivity&&(c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop-d.scrollSpeed)),d.axis&&"y"===d.axis||(c.overflowOffset.left+c.scrollParent[0].offsetWidth-b.pageX<d.scrollSensitivity?c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft+d.scrollSpeed:b.pageX-c.overflowOffset.left<d.scrollSensitivity&&(c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft-d.scrollSpeed))):(d.axis&&"x"===d.axis||(b.pageY-a(document).scrollTop()<d.scrollSensitivity?e=a(document).scrollTop(a(document).scrollTop()-d.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<d.scrollSensitivity&&(e=a(document).scrollTop(a(document).scrollTop()+d.scrollSpeed))),d.axis&&"y"===d.axis||(b.pageX-a(document).scrollLeft()<d.scrollSensitivity?e=a(document).scrollLeft(a(document).scrollLeft()-d.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<d.scrollSensitivity&&(e=a(document).scrollLeft(a(document).scrollLeft()+d.scrollSpeed)))),e!==!1&&a.ui.ddmanager&&!d.dropBehaviour&&a.ui.ddmanager.prepareOffsets(c,b)}}),a.ui.plugin.add("draggable","snap",{start:function(){var b=a(this).data("ui-draggable"),c=b.options;b.snapElements=[],a(c.snap.constructor!==String?c.snap.items||":data(ui-draggable)":c.snap).each(function(){var c=a(this),d=c.offset();this!==b.element[0]&&b.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:d.top,left:d.left})})},drag:function(b,c){var d,e,f,g,h,i,j,k,l,m,n=a(this).data("ui-draggable"),o=n.options,p=o.snapTolerance,q=c.offset.left,r=q+n.helperProportions.width,s=c.offset.top,t=s+n.helperProportions.height;for(l=n.snapElements.length-1;l>=0;l--)h=n.snapElements[l].left,i=h+n.snapElements[l].width,j=n.snapElements[l].top,k=j+n.snapElements[l].height,h-p>r||q>i+p||j-p>t||s>k+p||!a.contains(n.snapElements[l].item.ownerDocument,n.snapElements[l].item)?(n.snapElements[l].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,b,a.extend(n._uiHash(),{snapItem:n.snapElements[l].item})),n.snapElements[l].snapping=!1):("inner"!==o.snapMode&&(d=p>=Math.abs(j-t),e=p>=Math.abs(k-s),f=p>=Math.abs(h-r),g=p>=Math.abs(i-q),d&&(c.position.top=n._convertPositionTo("relative",{top:j-n.helperProportions.height,left:0}).top-n.margins.top),e&&(c.position.top=n._convertPositionTo("relative",{top:k,left:0}).top-n.margins.top),f&&(c.position.left=n._convertPositionTo("relative",{top:0,left:h-n.helperProportions.width}).left-n.margins.left),g&&(c.position.left=n._convertPositionTo("relative",{top:0,left:i}).left-n.margins.left)),m=d||e||f||g,"outer"!==o.snapMode&&(d=p>=Math.abs(j-s),e=p>=Math.abs(k-t),f=p>=Math.abs(h-q),g=p>=Math.abs(i-r),d&&(c.position.top=n._convertPositionTo("relative",{top:j,left:0}).top-n.margins.top),e&&(c.position.top=n._convertPositionTo("relative",{top:k-n.helperProportions.height,left:0}).top-n.margins.top),f&&(c.position.left=n._convertPositionTo("relative",{top:0,left:h}).left-n.margins.left),g&&(c.position.left=n._convertPositionTo("relative",{top:0,left:i-n.helperProportions.width}).left-n.margins.left)),!n.snapElements[l].snapping&&(d||e||f||g||m)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,b,a.extend(n._uiHash(),{snapItem:n.snapElements[l].item})),n.snapElements[l].snapping=d||e||f||g||m)}}),a.ui.plugin.add("draggable","stack",{start:function(){var b,c=this.data("ui-draggable").options,d=a.makeArray(a(c.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});d.length&&(b=parseInt(a(d[0]).css("zIndex"),10)||0,a(d).each(function(c){a(this).css("zIndex",b+c)}),this.css("zIndex",b+d.length))}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c){var d=a(c.helper),e=a(this).data("ui-draggable").options;d.css("zIndex")&&(e._zIndex=d.css("zIndex")),d.css("zIndex",e.zIndex)},stop:function(b,c){var d=a(this).data("ui-draggable").options;d._zIndex&&a(c.helper).css("zIndex",d._zIndex)}})}(jQuery),define("jqueryUIDraggable",["jqueryUIMouse"],function(){}),define("directives/base/pt-rangeSlider",["app","jqueryDeParam","jqueryUISlider","jqueryUIDraggable"],function(a,b){a.directive("ptRangeslider",["$filter","$rootScope","$location",function(a,c,d){return{restrict:"A",transclude:!0,scope:{filter:"=",name:"@"},link:function(e,f,g){var h,i,j,k,l,m=e.filter,n=d.search(),o=!1;f=$(f),j=a("priceFormat"),i={budget:function(a){var b;return b=(Math.log(a)-Math.log(799400))/.05889},area:function(a){var b;return b=(Math.log(a)-Math.log(78.4768))/.048475},"default":function(a){var b=m.range.min;return m.range.max,(a-b)/1e5}},h={budget:function(a){var b;return b=799400*Math.exp(.05889*a)},area:function(a){var b;return b=78.4768*Math.exp(.048475*a)},"default":function(a){var b=m.range.min;return m.range.max,1e5*a+b}},e.updateValues=function(a){var b,c,d=m.range;return b=Math.floor(i[e.name](a[0]))+d.min-parseInt(d.min),c=Math.floor(i[e.name](a[1]))+d.max-parseInt(d.max),b=b<=d.min?d.min:b,c=c>=d.max?d.max:c,d=[b,c]},k=function(a){var b="",c=e.name,d=h[c](m.range.min),f=h[c](m.range.max),g=h[c](a[0]),i=h[c](a[1]);g=d>=g?d:g,i=i>=f?f:i;var k=j(g,void 0,void 0,void 0,-1),l=j(i,void 0,"",void 0,-1);a[1]>=m.range.max&&(l+="",l=l.split(".")[0],b="+"),i>=1e7&&(b+=" Cr"),l+=b,$("."+c+"-min-size").text(k),$("."+c+"-max-size").text(l)},f.slider({step:1,min:e.filter.range.min,max:e.filter.range.max,range:!0,values:[e.filter.range.min,e.filter.range.max],stop:function(a,b){var f={},i=[h[e.name](b.values[0]),h[e.name](b.values[1])],k=e.updateValues([m.initial.min,m.initial.max]);(b.values[0]>k[0]||b.values[1]<k[1])&&(f={from:i[0],to:i[1]});var o=j(i[0]),p=j(i[1]),q=g.elem,r="",s="",t={},u=c.CURRENT_ACTIVE_PAGE;s=o+"-"+p,r=m.gaKey+":"+s+"-"+u,t["Filter Name"]=q,t["Filter Value"]=s,t["Page Name"]=u,e.$apply(function(){l=[],f.from&&f.to&&(l=[f.from,f.to]),l&&l.length?n[m.key]=l.join():delete n[m.key],d.search(n)})},slide:function(a,b){k(b.values)}}).draggable();var p=function(){if(!o){var a=e.updateValues([m.initial.min,m.initial.max]);m.from=m.initial.min,m.to=m.initial.max,f.slider("option","values",a),k(a),m.active=!1}},q=function(){var a=m.range;_.has(n,m.key)?(a=n[m.key].split(","),m.from=a[0],m.to=a[1],a=e.updateValues(a),k(a),f.slider("option","values",a),m.active=!0,o=!0):m.initial&&(o=!1,p())};e.$watch("filter.initial",function(a,b){a&&p(a)}),e.$on("$locationChangeSuccess",function(a,e,f){var g,h,i=e.split("?")[1],j=f.split("?")[1],k=e.split("?")[0],l=f.split("?")[0],o=!_.isEqual(k,l);i&&(g=b(i)[m.key]),j&&(h=b(j)[m.key]),n=d.search(),_.isEqual(g,h)||(q(),c.$broadcast("FiltersUpdate",{hasPathChanged:o}))}),e.$on("$destroy",function(){f.slider("destroy").draggable("destroy")}),q()}}}])}),define("text!views/directives/filters/equal-type.html",[],function(){return'<div ng-class="{\'dropdown-toggle\' : isdropdown}" class="searchDropInfo dropdown-toggle">\n    <span data-ng-if=\'filter.activeCount && isdropdown\'> \n        {{filter.tempLabel}}\n    </span>\n    <span data-ng-if=\'!filter.activeCount && isdropdown\'> {{filter.label}} </span>\n    <label data-ng-if=\'!isdropdown\'> {{filter.label}} </label>\n    <i class="pt pt-icon-angle-down iconArrow" data-ng-if=\'isdropdown\'></i>\n</div>\n<ul class="rightTopClick" data-ng-class="{\'filtClickListInfo\' : isdropdown, \'filtMoreContInfo\' : !isdropdown}">\n    <li class="checkboxInfo" data-ng-repeat="option in filter.options" data-ng-class="{\'active\': option.selected || option.selectedFromUrl, \'disable\':option.disable || option.disabledFromUrl}" data-ng-click="filterChanged(option, $event)">\n        <span class="checkIconInfo">\n            <i class="pt pt-icon-square-o"></i>\n            <i class="pt pt-icon-check-square-o"></i>\n        </span>\n        <label>{{option.label}}</label>\n    </li>\n</ul>'}),define("directives/filters/equal-type",["app","text!views/directives/filters/equal-type.html"],function(a,b){a.directive("equalType",["$rootScope","$location","GoogleAnalyticsService",function(a,c,d){return{restrict:"A",scope:{filter:"=",showDropdown:"=?",gaEvent:"@?",gaCategory:"@?"},template:b,controller:["$scope","$rootScope",function(a,b){var e=a.filter;c.search(),a.isdropdown=e.dropdown,0==a.showDropdown?a.isdropdown=!1:1==a.showDropdown&&(a.isdropdown=!0),a.filterChanged=function(c,f){f.stopPropagation(),d.gaEventSelectEqualType(a.gaEvent,a.gaCategory,c),c.disable||c.disabledFromUrl||b.$broadcast("filterChanged",c,e)}}]}}])}),define("text!views/directives/filters/range-type.html",[],function(){return'<span class="searchDropInfo dropdown-toggle" ng-class="{\'dropdown-toggle\' : filter.dropdown}">\n    \n    <label data-ng-if=\'!filter.dropdown\'> {{filter.label}} </label>\n\n    <i class="caret" data-ng-if=\'filter.dropdown\'></i>\n</span>\n<ul class="rightTopClick" data-ng-class="{\'filtClickListInfo\' : filter.dropdown, \'filtMoreContInfo\' : !filter.dropdown, \'disable\':filter.disable || filter.disabledFromUrl}">\n    <li class="checkboxInfo" data-ng-repeat="option in filter.options" data-ng-class="{\'active\': option.selected}" data-ng-click="filterChanged(option, $event)">\n        <span class="checkIconInfo">\n        	<i class="pt pt-icon-square-o"></i>\n        	<i class="pt pt-icon-check-square-o"></i>\n        </span>\n        <label>{{option.label}}</label>\n    </li>\n</ul>'}),define("directives/filters/range-type",["app","text!views/directives/filters/range-type.html","jqueryDeParam"],function(a,b,c){a.directive("rangeType",["$rootScope","$location","GoogleAnalyticsService",function(a,c,d){return{restrict:"A",scope:{filter:"=",gaEvent:"@?",gaCategory:"@?"},template:b,controller:["$scope",function(b){var e=b.filter,f=c.search();b.$on("$destroy",function(){e=void 0,f=void 0}),b.filterChanged=function(c,f){f.stopPropagation(),e.disable||e.disabledFromUrl||(a.$broadcast("filterChanged",c,e),d.gaEventRangeType(b.gaEvent,b.gaCategory,c))}}]}}])}),define("text!views/directives/filters/budget.html",[],function(){return'<div class="dropdown-toggle searchDropInfo">\n    <span data-ng-if=\'filter.active\' ng-bind-html="filter.tempLabel">\n    </span>\n    <span data-ng-if=\'!filter.active\'> {{filter.label}} </span>\n    <i class="pt pt-icon-angle-down iconArrow" data-ng-if=\'filter.dropdown\'></i>\n</div>\n<div data-ga-event="gaEvent" pt-rangemanager data-ga-category="gaCategory" filter="filter"></div>'}),define("text!views/directives/common/pt-rangemanager.html",[],function(){return'<ul class="rightTopClick" ng-click="$event.stopPropagation()" data-ng-class="{\'clickListInfo\' : filter.dropdown, \'disable\' : filter.fromurl}">\n    <li>\n        <div class="dualBoxInfo">\n            <div class="budgetBoxInfo">\n                <i data-ng-if="filter.key == \'primaryOrResaleBudget\'" class="pt pt-icon-inr"></i>\n                <input ng-readonly="filter.fromurl" data-ng-model="filter.tmpFrom" data-ng-keyup="onMinValueEnter(filter.tmpFrom, $event)" data-ng-focus="showMaxRange=false" type="text" placeholder="Min">\n            </div>\n            <div class="budgetLineInfo">&nbsp;</div>\n            <div class="budgetBoxInfo">\n                <i data-ng-if="filter.key == \'primaryOrResaleBudget\'" class="pt pt-icon-inr"></i>\n                <input ng-readonly="filter.fromurl" data-ng-model="filter.tmpTo" ng-keydown="sendRequest($event)" data-ng-keyup="onMaxValueEnter(filter.tmpTo, $event)" data-ng-focus="showMax()" type="text" placeholder="Max">\n            </div>\n        </div>\n        <div class="dualBoxInfo switContInfo">\n            <div class="switDataContInfo minContInfo" data-ng-class="{\'selected\': !showMaxRange}">\n                <div class="switRowContInfo"\n                     data-ng-click="minRangeSelected(item.value)"\n                     data-ng-class="{\'active\' : item.value==from}"\n                     data-ng-repeat="item in filter.range.min">\n                    <i data-ng-if="filter.key == \'primaryOrResaleBudget\'" class="pt pt-icon-inr"></i> {{item.value | priceFormat : null:null:\' L\':null:2}}</div>\n            </div>\n            <div class="switDataContInfo maxContInfo" data-ng-class="{\'selected\': showMaxRange}">\n                <div class="switRowContInfo"\n                     data-ng-class="{\'active\' : item.value==to}"\n                     data-ng-click="maxRangeSelected(item.value)"\n                     data-ng-repeat="item in filter.range.max">\n                    <div ng-if="item.value != \'Any\'">\n                        <i data-ng-if="filter.key == \'primaryOrResaleBudget\'" class="pt pt-icon-inr"></i>\n                        {{item.value | priceFormat : null:null:\' L\':null:2}}\n                    </div>\n                    <div ng-if="item.value == \'Any\'">{{item.value}}</div>\n                </div>\n            </div>\n        </div>\n    </li>\n</ul>\n'}),define("directives/common/pt-rangemanager",["app","text!views/directives/common/pt-rangemanager.html","formatters/common"],function(a,b){a.directive("ptRangemanager",["$timeout","GoogleAnalyticsService",function(a,c){return{restrict:"A",template:b,scope:{filter:"=",gaCategory:"=",gaEvent:"="},controller:["$scope","$rootScope","Formatter",function(b,d,e){b.showMax=function(){b.filter.fromurl||(b.showMaxRange=!0)},b.disabled=!0,b.from=b.filter.from,b.to=b.filter.to,b.amountAny=!1,b.amountZero=!1,b.$on("budgetFilterReset",function(){b.from=b.filter.from,b.to=b.filter.to});var f=function(a,b){switch(a){case 75:b=b.replace(/[k|K]/,"000");break;case 76:b=b.replace(/[l|L]/,"00000");break;case 67:b=b.replace(/[c|C]/,"0000000")}return b};b.onMinValueEnter=function(c,g){b.filter.fromurl||(b.amountZero=0==c?!0:!1,g&&(c=f(g.keyCode,c)),0!==c&&""!==c&&(c=parseInt(c.toString().split(",").join(""))),0===c?(b.filter.from="0",b.filter.tmpFrom="0"):isNaN(c)?(b.filter.from="",b.filter.tmpFrom="",b.filter.active=!0):(b.filter.from=""==c?"":parseInt(c.toString().split(",").join("")),b.filter.tmpFrom=e.formatPriceWithComma(b.filter.from),""!=b.filter.to&&parseInt(b.filter.from)>parseInt(b.filter.to)&&b.onMaxValueEnter("Any",!0)),d.$broadcast("minRangeSelected",b.filter)),g&&13==g.keyCode&&a(function(){angular.element('input[data-ng-model="filter.tmpTo"]').focus(),b.showMaxRange=!0})},b.onMaxValueEnter=function(a,g){b.filter.fromurl||("Any"==a?(b.amountAny=!0,b.filter.amountAny=!0):(b.amountAny=!1,b.filter.amountAny=!1),g&&g.keyCode&&(a=f(g.keyCode,a)),"Any"!==a&&""!==a&&(a=parseInt(a.toString().split(",").join(""))),"Any"===a?(b.filter.to="",b.filter.tmpTo="Any"):isNaN(a)&&""!=a?(b.filter.to="",b.filter.tmpTo="",b.filter.active=!0):(b.filter.to=""==a?"":parseInt(a.toString().split(",").join("")),b.filter.tmpTo=e.formatPriceWithComma(b.filter.to)),d.$broadcast("maxRangeSelected",b.filter)),g||(""!==b.filter.to&&parseInt(b.filter.from)>parseInt(b.filter.to)&&b.onMaxValueEnter("Any"),b.applyFilter()),c.gaEventSelectPropertyType(b.filter,b.gaCategory,b.gaEvent)},b.minRangeSelected=function(c){b.filter.fromurl||a(function(){angular.element('input[data-ng-model="filter.tmpTo"]').focus(),b.showMaxRange=!0,b.onMinValueEnter(c)})},b.maxRangeSelected=function(a){b.filter.fromurl||b.onMaxValueEnter(a)},b.applyFilter=function(){b.filter.to==b.to&&b.filter.from==b.from||!(b.filter.tmpTo||b.filter.tmpFrom||b.amountAny||b.amountZero)||(b.filter.active=!1,b.filter.scrollAmount=!1,a(function(){angular.element(".flitClickInfo.open").length>0&&$(document).trigger("click")}),b.from=b.filter.from,b.to=b.filter.to,b.disabled=!0,b.amountAny=!1,b.amountZero=!1,d.$broadcast("filterChanged",null,b.filter),b.showMaxRange=!1)},b.sendRequest=function(a){(9==a.keyCode||13==a.keyCode)&&(""!==b.filter.to&&parseInt(b.filter.from)>parseInt(b.filter.to)&&b.onMaxValueEnter("Any"),b.applyFilter())}}]}}])}),define("directives/filters/budget",["app","text!views/directives/filters/budget.html","directives/common/pt-rangemanager"],function(a,b){a.directive("budget",["$rootScope","$location",function(a,c){return{restrict:"A",scope:{filter:"=",gaCategory:"@?",gaEvent:"@?"},template:b}}])}),define("text!views/directives/filters/dynamic-tags.html",[],function(){return'<div class="row-full filtLocalDetInfo">\n    <label>{{filter.label}}</label>                               \n    <div class="autoCompleteSearch" tags-input data-ng-model="filter.selected" \n        placeholder="{{filter.placeholder}}"\n        temp-placeholder="{{filter.placeholder}}"\n        replace-spaces-with-dashes="false"                                   \n        add-from-autocomplete-only="true"\n        allowed-tags-pattern = "[a-zA-Z0-9\\.]*"                                \n        max-tags = "6"\n        min-length="2"\n        on-tag-added="update($tag.label)"\n        on-tag-removed="update($tag.label)"\n        >\n        <div auto-complete source="loadData($query)" min-length="2" debounce-delay="0" max-results-to-show="5"></div>\n    </div>\n\n    <div class="row-full filter-recommended">\n        <span class="filtRecHeadInfo">Popular {{filter.label}}:</span>\n        <span class="filtRecLink" data-ng-repeat="(id, item) in filter.recommended" data-ng-click="add(item, model, label)" data-ng-show="!item.notVisible" once-title="item.label" once-text="item.label"></span>\n    </div>\n    <div class="row-full requireText">\n            <strong>Note:</strong> You can add upto 6 {{filter.label}}\n    </div> \n    \n</div>\n'}),define("directives/filters/dynamic-tags",["app","text!views/directives/filters/dynamic-tags.html","jqueryDeParam"],function(a,b,c){a.directive("dynamicTags",["$rootScope","$location",function(a,d){return{restrict:"A",scope:{filter:"="},template:b,controller:["$scope",function(b){var e=b.filter,f=d.search(),g=[];b.update=function(a,b){e.selected.length?f[e.key]=_.pluck(e.selected,"label").join():delete f[e.key],d.search(f)},b.add=function(a,c,d){return e.selectedItem="",e.selected.length>=6?!1:(e.selected.push(a),e.specific&&e.specific(),void b.update(a.label,!0))},b.loadData=function(){return e.data};var h=function(){$.each(e.recommended,function(a,b){b.notVisible=_.contains(g,b.label)})},i=function(){_.has(f,e.key)?(g=f[e.key].split(","),e.activeCount=0,e.selected=[],_.each(g,function(a){e.selected.push({label:a}),e.activeCount++}),h()):(e.selected=[],e.activeCount=0,g.length=0,h())};b.$watch("filter.recommended",function(a){a&&a.length&&h()}),b.$on("$locationChangeSuccess",function(b,g,h){var j,k,l=g.split("?")[1],m=h.split("?")[1],n=g.split("?")[0],o=h.split("?")[0],p=!_.isEqual(n,o);l&&(j=c(l)[e.key]),m&&(k=c(m)[e.key]),f=d.search(),_.isEqual(j,k)||(i(),a.$broadcast("FiltersUpdate",{hasPathChanged:p}))}),i()}]}}])}),define("text!views/directives/filters/size.html",[],function(){return'<div ng-click="openSizeWidget=!openSizeWidget" class="searchDropInfo selectBoxInfo" ng-class="{\'arroDownInfo\': openSizeWidget}">    \n     <label data-ng-if=\'filter.active\'> \n        {{filter.tempLabel}} (sq ft)\n    </label>\n    <label data-ng-if=\'!filter.active\'> {{filter.label}} (sq ft)</label>\n    <i class="pt pt-icon-angle-down iconArrow"></i>\n</div>\n<div class="rightTopClick filterSizeContInfo"\n     ng-class="{\'showBoxInfo\': openSizeWidget}"\n     data-ga-category="gaCategory" data-ga-event="gaEvent" pt-rangemanager filter="filter"></div>\n'}),define("directives/filters/size",["app","text!views/directives/filters/size.html","directives/common/pt-rangemanager"],function(a,b){a.directive("size",["$rootScope",function(a){return{restrict:"A",scope:{filter:"=",gaCategory:"@?",gaEvent:"@?"},template:b}}])}),define("controllers/filterCtrl",["app","jqueryDeParam","underscore","services/pageSettings","services/projectService","services/localityService","services/builderService","services/filterService","directives/base/pt-rangeSlider","directives/base/pt-placeholder","directives/filters/equal-type","directives/filters/range-type","directives/filters/budget","directives/filters/dynamic-tags","directives/filters/size","services/flags","formatters/common"],function(a,b){a.controller("filterCtrl",["$rootScope","$scope","$window","$location","$state","$timeout","$stateParams","pageSettings","ProjectService","LocalityService","BuilderService","FilterService","Flags","$filter","Formatter",function(a,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q,r=e.search(),s=[],t=[],u=function(){var a;return"equal"===q.type&&s&&s.length?(a=s.sort()[0],_.each(q.options,function(b,c){b.key===a&&(a=b.label)}),q.activeCount>1&&(a+="+"+(q.activeCount-1))):"range"!==q.type||q.options||s&&s.length&&q.active&&(a=""===s[1]&&""!==s[0]&&q.amountAny?"budget"===q.gaKey?'<i class="pt pt-icon-inr"></i> '+o("priceFormat")(s[0],null,null," L",null,2)+" - Any":o("priceFormat")(s[0],null,null," L")+" - Any":""!==s[1]||""===s[0]||q.amountAny?""===s[0]&&""!==s[1]?"budget"===q.gaKey?'Up To <i class="pt pt-icon-inr"></i> '+o("priceFormat")(s[1],null,null," L",null,2):"Up To "+o("priceFormat")(s[1],null,null," L"):"budget"===q.gaKey?'<i class="pt pt-icon-inr"></i> '+o("priceFormat")(s[0],null,null," L",null,2)+' - <i class="pt pt-icon-inr"></i> '+o("priceFormat")(s[1],null,null," L",null,2):o("priceFormat")(s[0],null,null," L")+" - "+o("priceFormat")(s[1],null,null," L"):"budget"===q.gaKey?'<i class="pt pt-icon-inr"></i> '+o("priceFormat")(s[0],null,null," L",null,2)+" +":o("priceFormat")(s[0],null,null," L")+" +"),a},v=function(){if(q.keys)for(var a=0;a<q.keys.length;a++)if(_.has(r,q.keys[a])){q.key=q.keys[a];break}return _.has(r,q.key)?!0:!1},w=function(){var b;if("equal"===q.type)_.has(r,q.key)?(q.backwardCompatibility&&(b=q.backwardCompatibility(r[q.key])),b||(s=r[q.key].split(","),c.urlData=s,q.activeCount=0,_.each(q.options,function(a){_.contains(s,a.key)?(a.selected=!0,q.activeCount++):a.selected=!1}),q.tempLabel=u())):(_.each(q.options,function(a){a.selected=!1}),q.activeCount=0,s=[]);else if("range"===q.type)if(q.options)_.has(r,q.key)?(q.backwardCompatibility&&(b=q.backwardCompatibility(r[q.key])),b||(s=r[q.key].split(","),_.each(q.options,function(a){a.selected=s[0]==a.from&&s[1]==a.to}),q.active=!0)):(_.each(q.options,function(a){a.selected=!1}),q.active=!1,s.length=0);else{if(v()){s=r[q.key].split(",");var d=r[q.key].split(",");q.tmpFrom=p.formatPriceWithComma(d[0]),q.tmpTo=p.formatPriceWithComma(d[1]),q.from=d[0],q.to=d[1],q.active=!0,q.tempLabel=u()}else q.fromurl?(q.tmpFrom=p.formatPriceWithComma(q.from),q.tmpTo=p.formatPriceWithComma(q.to)):(q.active=!1,s.length=0,q.from="",q.to="",q.tmpFrom="",q.tmpTo="",a.$broadcast("budgetFilterReset"));q.getMaxRange(q.from),q.selectMinMaxRange(q.from,q.to)}var e=0;if("projectStatus"===q.key&&q.options){for(e=0;e<q.options.length;e++){if(!q.activeCount||"underConstruction"===q.options[e].key&&q.options[e].selected){c.filters.possessionDate.disable=!1;break}c.filters.possessionDate.disable=!0}if(c.filters.possessionDate.disable)for(e=0;e<c.filters.possessionDate.options.length;e++)"undefined"!=typeof c.filters.possessionDate.options[e].selected&&c.filters.possessionDate.options[e].selected===!0&&a.$broadcast("filterChanged",c.filters.possessionDate.options[e],c.filters.possessionDate)}if("possessionDate"===q.key&&q.options){var f=c.filters.projectStatus.options.length;if(q.active)for(e=0;f>e;e++)"underConstruction"!=c.filters.projectStatus.options[e].key&&(c.filters.projectStatus.options[e].disable=!0);else for(e=0;f>e;e++)"underConstruction"!=c.filters.projectStatus.options[e].key&&(c.filters.projectStatus.options[e].disable=!1)}},x=function(){angular.forEach(c.filters,function(a,b){q=a,w()})},y=function(){var a=[];return r[q.key]&&(a=r[q.key].split(",")),a},z=c.$on("minRangeSelected",function(a,b){q=b,q.getMaxRange(q.from),q.selectMinMaxRange(q.from,q.to)});t.push(z);var A=c.$on("maxRangeSelected",function(a,b){q=b,q.selectMinMaxRange(q.from,q.to)});t.push(A);var B=c.$on("filterChanged",function(a,b,c){q=c,r=e.search(),s=y(),"equal"==q.type?(b.selected?(s=_.without(s,b.key),_.each(q.options,function(a,c){_.isEqual(a,b)&&(a.selected=!1)})):(_.each(q.options,function(a,c){_.isEqual(a,b)&&(a.selected=!0)}),s?s.push(b.key):(s.length=0,s.push(b.key))),s&&s.length?r[q.key]=s.join():delete r[q.key]):"range"===q.type&&(b?b.selected?(delete r[q.key],s=[],_.each(q.options,function(a,c){_.isEqual(a,b)&&(a.selected=!1)})):(_.each(q.options,function(a,c){_.isEqual(a,b)?a.selected=!0:a.selected=!1}),s=[b.from,b.to]):q.active||""===q.from&&""===q.to?(delete r[q.key],s=[]):s=[q.from,q.to],s&&s.length&&(r[q.key]=s.join())),delete r.page,e.search(r)});t.push(B);var C=c.$on("$locationChangeSuccess",function(c,d,f){var g,h,i=d.split("?")[1],j=f.split("?")[1],k=d.split("?")[0],l=f.split("?")[0],m=!_.isEqual(k,l);i&&(g=b(i)),j&&(h=b(j)),r=e.search(),x(),angular.forEach(g,function(a,b){-1==E.indexOf(b)&&delete g[b]}),angular.forEach(h,function(a,b){-1===E.indexOf(b)&&delete h[b]}),h=h||{},g=g||{},_.isEqual(g,h)||a.$broadcast("FiltersUpdate",{hasPathChanged:m})});t.push(C);var D=c.$watch("selectedCity",function(a){if(a&&a.label){var b={filters:{and:[{equal:{cityLabel:a.label.toLowerCase()}}]}};m.fetchStats(b)}});t.push(D),c.$on("$destroy",function(){for(var a in t)t[a]()}),c.filters=m.filters;var E=[];angular.forEach(c.filters,function(a,b){a.key&&E.push(a.key)}),E.push("price"),c.activeCount=function(){var a=0;return _.each(c.filters,function(b){b.dropdown||(b.activeCount||b.active)&&a++}),a},c.enableReset=function(){var a=c.activeCount()||m.filters.listingType.activeCount||m.filters.budget.active||m.filters.projectStatus.activeCount||m.filters.bed.activeCount||m.filters.possessionDate.active||m.filters.propertyType.activeCount;return a},c.clearAll=function(a){var b=a||{};if(c.enableReset()){var d=e.search().geo||null,f=e.search()._keys||null,g=e.search().q||null;f?e.search({_keys:f}):d?e.search({geo:d}):g?e.search({q:g}):e.search(b),r=b,x()}};var F=a.userDetails;if(F&&F.preference&&F.preference.preference&&F.preference.preference.unitType&&F.preference.preference.unitType.length){var G={};c.filters.propertyType.selected=F.preference.preference.unitType,_.each(F.preference.preference.unitType,function(a,b){G[a]=!0}),c.filters.propertyType.selection=G}x()}])}),define("text!views/directives/common/pt-search.html",[],function(){return'<div class="propSearchBox">\n    <div data-ng-click="handleZIndex(true, false,$event)" class="propSearchBoxInfo row-full">\n	   <div class="clickInfo searchCityListMenu">\n            <div data-ng-click="handleZIndex(true, false, $event,true)" class="dropdown-toggle topMenuLinkBtn">\n                <i class="pt pt-icon-map-marker-o"></i> \n                <span>{{$root.cityToShow}}</span> \n                <span class="pt pt-icon-angle-down iconArrow"></span>\n            </div>\n            <div class="cityContListInfo rightTopClick">\n                <div class="cityContDetailInfo">\n                    <div class="anchHoveUpAnimInfo" ng-mouseleave="stop()" ng-mouseenter="up()" data-ng-class="{\'disable\': !upActive}"><i class="pt pt-icon-angle-up"></i></div>\n                    <div class="anchHoveDownAnimInfo" ng-mouseleave="stop()" ng-mouseenter="down()" data-ng-class="{\'disable\': !dnActive}"><i class="pt pt-icon-angle-down"></i></div>\n                    \n                    <ul class="clickAnchListInfo"id="city-list">\n                        <li>\n                            <a data-ng-click="$root.cityChanged(\'All Cities\')">All Cities</a>\n                        </li>\n                        <li data-ng-if="city.displayPriority == 1 || city.displayPriority == 2" data-ng-repeat="city in $root.cityList" class="{{city.class}}">\n                            <a data-ng-click="$root.cityChanged(city.label, city.id)" data-ng-class="{\'city-bold\' : city.displayPriority === 1}">{{city.label}}</a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n                            \n        </div>\n\n	    <div class="searchTypoMenu pull-left">\n            <div class="searchTypoContInfo">\n                <input data-ng-class="$root.validateInputClass" class="pull-left" type="search" data-ng-focus="showMsgForList=false;" data-ng-model="selValue" data-ng-keydown="selectDropDown($event)" data-ng-keypress="formFill($event)" data-ng-paste="formFill($event)" typeahead="result.displayText for result in searchSuggestions($viewValue, mode) | limitTo:8" typeahead-template-url="views/static/searchTypeAhead.html" typeahead-on-select="searchOptionSelected($item, $model, $label, mode)" typeahead-min-length=\'2\' typeahead-input-formatter="$model = \'\'" pt-placeholder="{{placeholder}}" data-ng-blur="gaStartFlag=true;no_suggestions=false"/>\n    	    	<div data-ng-show="loadingSearch" class="pt pt-icon-cog pt-spin searchloading"></div>\n                <ul data-ng-if="!$root.hideSearchSuggestions" class="dropdown-menu" data-ng-class="{ \'dropsearch-menu\' : cityRecentSearch }">\n                    <li data-ng-click="recentSearchSelected(match.model, mode, $event)" data-ng-repeat="match in cityRecentSearch track by $index" data-ng-class="{\'active\' : $index==0}" pt-search-type-ahead></li>\n                </ul>\n                <div class="paddingTB5 noSuggestions pull-left" data-ng-show="no_suggestions">\n                    <input value="No Result Found!" disabled>\n                    <input data-ng-model="search_msg" disabled>\n                </div>\n            </div>\n	    </div>\n	    <div class="searchActionInfo pull-left" pt-blur="hideMsg()" data-ng-click="textSearch($model, mode, $event)">\n        	<span class="searchIconInfo">\n        		<i class="pt pt-icon-search"></i>\n        	</span>\n        	<span class="searchBtnInfo">\n        		<i class="pt pt-icon-search"></i> Search\n        	</span>\n	    </div>\n    </div>\n    <div data-ng-show="showMsg" class="paddingT10" >\n        Sorry! Results for typed keyword cannot be displayed on map.<br>\n        <a data-ng-href="/filters?q={{selValue}}" data-ng-click="textSearchInListViewGA()">See results in List View</a> or Select an option from suggestions.\n    </div>\n    <div data-ng-show="showMsgForList" class="paddingT10" >\n        Sorry! Results for typed keyword cannot be displayed on map.<br>\n        <a data-ng-click="showMsgForList = false;" data-ng-href="/{{selectedItemUrl}}">See results in List View</a> or Select an option from suggestions.\n    </div>\n\n</div>    \n'}),define("text!views/static/searchTypeAhead.html",[],function(){return'\n<span class="search-line" data-ng-if="match.model.showLine"></span>\n<span class="search-text-info" data-ng-if="match.model.showRecentSearches">Recent Searches</span>\n<span class="search-text-info" data-ng-if="match.model.showPopularLocations">Popular Locations</span>\n<span class="search-text-info" data-ng-if="match.model.showSuggestedSearches">Suggested Searches</span>\n<span class="search-text-info" data-ng-if="match.model.showLocations">Locations</span>\n<span class="search-text-info" data-ng-if="match.model.showProjects">Projects</span>\n<span class="search-text-info" data-ng-if="match.model.showBuilders">Builders</span>\n<span class="search-text-info" data-ng-if="match.model.showSuggestion">Popular suggestions</span>\n<i class="pt {{match.model.applyClass}} search-icon"></i>\n<a bind-html-unsafe="match.model.displayText | typeaheadHighlight:query"></a>\n';
}),define("directives/common/pt-search-type-ahead",["app","text!views/static/searchTypeAhead.html"],function(a,b){a.directive("ptSearchTypeAhead",[function(){return{restrict:"A",template:b}}])}),define("directives/common/pt-search",["app","text!views/directives/common/pt-search.html","services/searchService","services/globalService","services/maps/mapConfig","formatters/common","directives/base/pt-placeholder","directives/common/pt-search-type-ahead"],function(a,b){a.directive("ptSearch",[function(){return{restrict:"A",scope:{mode:"@"},template:b,controller:["$scope","$rootScope","$modal","$timeout","$element","$location","SearchService","Formatter","GlobalService","NotificationService","PtMapsConfig",function(a,b,c,d,e,f,g,h,i,j,k){a.recentSearch={},b.validateInputClass="",a.$watch("mode",function(b,c){b&&(a.mode=b)}),a.mapConfig=k.mapConfig,a.placeholder="Enter a location, builder or a project",a.showMsg=!1,a.showMsgForList=!1,a.validateInputClass="",a.gaStartFlag=!0,a.gaBackwardFlag=!1,a.setDefaultSort=function(){a.validateInputClass="",(void 0===a.selValue||""===a.selValue)&&(a.validateInputClass="redBorder")};var l="",m=b.VIEW_TYPES,n=[],o=function(b,c,d){angular.forEach(b,function(a){delete a[0].model.showSuggestedSearches,delete a[0].model.showPopularLocations,delete a[0].model.showLocations,delete a[0].model.showProjects,delete a[0].model.showBuilders,delete a[0].model.showSuggestion,delete a[0].model.showRecentSearches});var e=b[c][0],f=-1;if(!d){for(var g=0;g<a.recentSearch[c].length;g++)a.recentSearch[c][g].model.url==e.model.url&&(f=g),a.recentSearch[c][g].model.showRecentSearches&&(delete a.recentSearch[c][g].model.showRecentSearches,delete a.recentSearch[c][g].model.showLine);-1!=f&&a.recentSearch[c].splice(f,1)}e.model.isuggestion||(e.model.showRecentSearches=!0,e.model.showLine=!0),d?$.extend(a.recentSearch,b):a.recentSearch[c].unshift(e)},p=function(c,d,e,f){var g={};!e.cityId&&b.selectedCity&&b.selectedCity.id&&(e.cityId=b.selectedCity.id),e.cityId&&(e.url||("PROJECT"===e.type?e.isRecentSearch===!0?e.url=h.getUrlWithParam(e.url).__url:e.url=e.redirectUrl:e.url=d),g[e.cityId]=[]),g[c].push({model:e}),f&&delete g[e.cityId][0].model.isPopularlocality;var i=[];if(a.recentSearch[c]&&a.recentSearch[c].length>1&&(i[0]=a.recentSearch[c].pop(),i[1]=a.recentSearch[c].pop()),!e.isuggestion&&(e.showPopularLocations&&delete e.showPopularLocations,a.recentSearch[c]))for(var j=0;j<a.recentSearch[c].length;j++)if(a.recentSearch[c][j].model.hasOwnProperty("isPopularlocality")){delete a.recentSearch[c];break}!e.isuggestion&&a.recentSearch[c]&&a.recentSearch[c].length>4&&a.recentSearch[c].pop(),!e.isuggestion&&a.recentSearch.hasOwnProperty(c)?o(g,c):e.isuggestion||o(g,c,!0),a.recentSearch[c]&&(a.recentSearch[c].push(i[1]),a.recentSearch[c].push(i[0]))},q=function(){return n.indexOf(b.cityToShow)>-1?!0:!1},r=function(a){var b=window.setTimeout(function(){a.indexOf("?")>-1?f.path(a.split("?")[0]).search(a.split("?")[1]):f.path(a)},5e3);j.setNotification({msg:"Sorry! Nothing to show on map. Switching to list of projects @TS@-"+(new Date).getTime(),onNo:function(){window.clearTimeout(b)},cancelText:"Don't Switch"})},s=function(a){"PROJECT"===a.type?p(a.cityId,a.id,a):p(a.cityId,a.redirectUrl,a)};a.searchOptionSelected=function(c,i,j,k){b.removeBackDrop();var l=(b.CURRENT_ACTIVE_PAGE,1);angular.forEach(a.tempSuggestion,function(a,b){c.label===a.label&&(l=b+1)}),"undefined"!=typeof mixpanel&&mixpanel.people.increment("Auto Search"),a.selValue="",d(function(){e.find("input").blur()});var o;if(("map"==k||g.getViewType()==m.MAP)&&!c.isGooglePlace&&-1==n.indexOf(c.city)&&(!c.isSuggestion||c.isSuggestion&&!t)&&(!q()||"BUILDERCITY"!=c.type))return void(f.path().indexOf("/maps")>-1?r(c.redirectUrl):(a.selectedItemUrl=c.redirectUrl,a.showMsgForList=!0));if(c.isGooglePlace)return void u(c,k);if(g.getViewType()==m.MAP)c.cityId&&s(c),b.searchHandler(c);else if(o=h.getUrlWithParam(c.redirectUrl),"map"==k)if("PROJECT"==c.type){var v="/maps/"+c.localityURL+"?projectId="+c.id.split("-")[2];if(c.latitude&&c.longitude){var w=a.mapConfig.state.filter.state.minDistance||3,x={distance:w.toFixed(2)/1,lat:c.latitude.toFixed(4)/1,lon:c.longitude.toFixed(4)/1};x=[x.distance,x.lat,x.lon].join(","),v+="&geo="+x}c.cityId&&p(c.cityId,c.id,c),f.url(v)}else c.cityId&&_.keys(o.__search).length?p(c.cityId,o.__url+"?"+o.__search,c):c.cityId&&p(c.cityId,o.__url,c),f.path("/maps/"+o.__url).search(o.__search);else c.isGooglePlace||(c.cityId&&s(c),f.path("/"+o.__url).search(o.__search))};var t,u=function(a,c){var d,e=!1,i={};g.findAllLandmarkProperties(a.googlePlaceId,function(k){angular.forEach(k,function(a,b){"undefined"!=typeof a.data.placeId&&""!==a.data.placeId?(i.placeDetailData=a.data,d=i.placeDetailData.url):(i.projectListingCnt=a.totalCount,i.projectListingCnt>0&&(e=!0))}),e&&i.placeDetailData&&i.placeDetailData.cityid?b.waitUpdateCity(null,function(b){if(b&&b.label){var e={cityId:b.id,applyClass:a.applyClass,displayText:a.displayText};p(b.id,d,e);var i=h.getUrlWithParam(d),k="";if(g.getViewType()==m.MAP||"map"==c){if(!(n.indexOf(b.label)>-1))return void j.setNotification({msg:"Selected place is not supported in our maps currently. Switch to list view.",type:"alert",isConfirm:!0,onYes:function(){f.path("/"+i.__url).search(i.__search)},onNo:function(){}});k="/maps/"}f.path(k+i.__url).search(i.__search)}},null,i.placeDetailData.cityid):(j.removeNotification(),j.setNotification({msg:"Sorry! No projects found in this area. Continue exploring.@TS@-"+(new Date).getTime(),type:"error"}))})},v=i.getHomeCity();v&&v.id&&(t=v.id),a.$on("cityChangedBySearch",function(c,d){a.selValue="",t=d,a.cityRecentSearch=a.recentSearch[d],b.hideSearchSuggestions=!1,a.showMsgForList=!1}),b.removeBackDrop=function(){angular.element("#backdrop").removeClass("backDropInfo"),angular.element("body").removeClass("contentOverflow"),b.hideSearchSuggestions=!0,a.handleZIndex(!1,!0)},b.showBackDrop=function(){angular.element("#backdrop").addClass("backDropInfo"),angular.element("body").addClass("contentOverflow")},a.$watch("selValue",function(c){""===c&&angular.element('input[type="search"]').is(":focus")&&(b.hideSearchSuggestions=!1,a.cityRecentSearch=a.recentSearch[t])}),a.recentSearchSelected=function(c,d,e){e.stopPropagation(),a.selValue="";var g=h.getUrlWithParam(c.url);b.removeBackDrop();var i=g.__url;if(c.isRecentSearch=!0,"PROJECT"===c.type?p(c.cityId,c.id,c,!0):p(c.cityId,i,c,!0),"map"==d||f.path().indexOf("/maps")>-1)if("PROJECT"==c.type){var j="/maps/"+c.localityURL;f.path(j).search("projectId="+c.id.split("-")[2])}else c.showSuggestedSearches===!0?f.path(i).search(g.__search):f.path("/maps/"+i).search(g.__search);else i.indexOf("/maps")>-1&&(i=i.split("/maps")[1]),f.path(i).search(g.__search)};var w=(new Date).getTime(),x=function(c){var d,e,f,g={},i=!1,j=!1;angular.forEach(c,function(a,c){e=c.split("cityId=")[1].split("&")[0];for(var k=0;k<b.cityList.length;k++)if(b.cityList[k].id==e){f=b.cityList[k].cityPropertyCount;break}if(g[e]=[],a.data&&a.data.length){i=!0,j=!0,d="",angular.forEach(a.data,function(a,b){d=a.url.split("/")[0],g[e].push({model:{url:a.url,showLine:i,showPopularLocations:j,displayText:a.label,applyClass:"pt-icon-map-marker-o",isPopularlocality:!0,cityId:e}}),i=!1,j=!1}),g[e].push({model:{url:d+"-real-estate",showLine:!0,isuggestion:!0,showSuggestedSearches:!0,displayText:"Know more about "+h.ucword(d)+" (See Trends, photos, neighbourhood etc)",cityId:e}}),g[e].push({model:{url:"projects-in-"+d,isuggestion:!0,displayText:"See all properties in "+h.ucword(d)+" ("+f+" properties)",cityId:e}});var l=new Date;g.updateTime=l.getTime()}});var k=_.difference(_.keys(g),_.keys(a.recentSearch));if(_.isEmpty(a.recentSearch)===!0||0!==k.length)$.extend(!0,a.recentSearch,g);else{var l,m;angular.forEach(a.recentSearch,function(b,c){"updateTime"!=c&&("boolean"==typeof a.recentSearch[c][0].model.isPopularlocality&&a.recentSearch[c][0].model.isPopularlocality===!0&&_.isEmpty(g[c])===!1&&(a.recentSearch[c]=g[c]),_.isEmpty(g[c])===!1&&(l=b.length-1,m=g[c].length-1,-1===g[c][m].model.displayText.indexOf("undefined")&&(a.recentSearch[c][l]=g[c][m]),a.recentSearch[c][l-1]=g[c][m-1]))}),a.recentSearch.updateTime=g.updateTime}};b.$watch("cityList",function(b){if(b&&angular.forEach(b,function(a,b){a.displayPriority<3&&n.push(a.label)}),_.isEmpty(a.recentSearch)===!0||"undefined"==typeof a.recentSearch.updateTime||w-a.recentSearch.updateTime>108e5){var c,d=[],e=0,f=[];if(b){for(c=0;c<b.length;c++)b[c].displayPriority<3&&(e+=1);for(c=0;e>c;c++)d.push("data/v1/entity/locality/popular?cityId="+b[c].id+'&selector={"paging":{"start":0,"rows":5},"fields":["label","url"]}'),c&&c%14==0&&(f.push(d),d=[]);e%15&&f.push(d),$.each(f,function(a,b){i.makeCompositeCall(b).then(x)})}}});var y=[];a.no_suggestions=!1,a.searchSuggestions=function(c,d){return a.loadingSearch=!0,a.tempSuggestion=[],l=c,b.hideSearchSuggestions=!0,g.getSearchSuggestions(c,b.cityToShow).then(function(c){a.searchSuggestionVersion=c.data.version,a.tempSuggestion=c.data.data,a.loadingSearch=!1;for(var d=[],e=[],f=0;c&&c.data.data&&f<c.data.data.length;f++){var g=c.data.data[f];g.isGooglePlace&&(g.type="near-by");var h=g.type.toLowerCase();g.isSuggestion?(g.displayType="Suggestion",e.push(g)):(g.displayType=g.type,"builder"===h||"buildercity"===h?g.applyClass="pt-icon-builder":"project"===h?g.applyClass="pt-icon-building-o":g.applyClass="pt-icon-map-marker-o",d.push(g))}if(e.length&&(e[0].showSuggestion=!0,e.length&&(e[0].showLine=!0)),"A"===a.searchSuggestionVersion){var i=[],j=[],k=[];angular.forEach(d,function(a){"BUILDER"===a.type||"BUILDERCITY"===a.type?(i.push(a),i[0].showBuilders=!0,i[0].showLine=!0):"PROJECT"===a.type?(j.push(a),j[0].showProjects=!0,j[0].showLine=!0):(k.push(a),k[0].showLocations=!0,k[0].showLine=!0)});var l=[];angular.forEach(d,function(a){"BUILDER"===a.type||"BUILDERCITY"===a.type?(l=l.concat(i),i=[]):"PROJECT"===a.type?(l=l.concat(j),j=[]):(l=l.concat(k),k=[])}),l=l.concat(e),d=l}else d=d.concat(e);return d.length||(a.no_suggestions=!0,"All Cities"==b.cityToShow?a.search_msg="Try modifying your search to get better results":a.search_msg="Try changing query/city to get better results"),y=d,d})},a.handleZIndex=function(c,e,f,g){if(f&&angular.element(f.currentTarget).parent().hasClass("open"))return angular.element(f.currentTarget).parent().removeClass("open"),void(a.selValue="");var h=$("[pt-searchwidget]").length,i=$("[pt-search]").length;1===i&&1===h?c?(angular.element(".propSearchInfo").addClass("back-index"),b.showBackDrop(),g?d(function(){angular.element("body").trigger("click"),b.hideSearchSuggestions=!0,a.selValue=""}):(b.hideSearchSuggestions=!1,a.cityRecentSearch=a.recentSearch[t])):e&&angular.element(".propSearchInfo").removeClass("back-index"):c?(angular.element(".header").addClass("header-index"),angular.element(".searchTopHeader").addClass("search-index"),b.showBackDrop(),g?d(function(){angular.element("body").trigger("click"),b.hideSearchSuggestions=!0}):(b.hideSearchSuggestions=!1,a.cityRecentSearch=a.recentSearch[t])):e&&(angular.element(".header").removeClass("header-index"),angular.element(".searchTopHeader").removeClass("search-index"),angular.element(".searchTopHeader").css("width",""))},a.textSearch=function(c,d,e){return angular.element("body").trigger("click"),e.stopPropagation(),b.removeBackDrop(),b.validateInputClass="",!b.cityToShow||void 0!==a.selValue&&""!==a.selValue?("map"===d||g.getViewType()==m.MAP?f.path().indexOf("/maps")>-1?r("filters?q="+a.selValue):a.showMsg=!0:(a.showMsg=!1,"All Cities"!==b.cityToShow?f.path("/filters").search({q:a.selValue,cityLabel:b.cityToShow}).hash(""):f.path("/filters").search({q:a.selValue}).hash("")),void(b.selectedCity=void 0)):"All Cities"===b.cityToShow?void(b.validateInputClass="redBorder"):void("map"===d||0===f.path().indexOf("/maps/")?b.redirectToPage("/maps/projects-in-"+b.cityToShow.toLowerCase().replace(/ /g,"-")):b.redirectToPage("projects-in-"+b.cityToShow.toLowerCase().replace(/ /g,"-")))},a.textSearchInListViewGA=function(){},a.hideMsg=function(b,c){a.validateInputClass="",a.showMsg=!1,a.showMsgForList=!1},a.formFill=function(c){d(function(){a.showMsgForList=!1,a.showMsg=!1,a.gaBackwardFlag=!0,b.CURRENT_ACTIVE_PAGE,"undefined"==typeof a.mode&&(a.mode=""),a.gaStartFlag&&"undefined"!=typeof a.selValue&&("paste"==c.type&&a.selValue.length>1||"keypress"==c.type&&2==a.selValue.length)&&(a.gaStartFlag=!1)})},a.upActive=!1,a.dnActive=!0,a.down=function(){a.upActive=!0;var b=angular.element(".clickAnchListInfo"),c=0-(b.outerHeight()-angular.element(".cityContDetailInfo").outerHeight());b.css("position","absolute").animate({top:c},1500,function(){a.dnActive=!1,a.$digest()})},a.up=function(){a.dnActive=!0,angular.element(".clickAnchListInfo").css("position","absolute").animate({top:"0px"},1500,function(){a.upActive=!1,a.$digest()})},a.stop=function(){angular.element(".clickAnchListInfo").stop()};var z=function(b,c){if(a.gaBackwardFlag&&"undefined"!=typeof a.selValue&&8==b.keyCode&&a.selValue.length>1){a.gaBackwardFlag=!1,a.no_suggestions=!1;for(var d=[],e=[],f=0;f<c.length&&0==c[f].isSuggestion;f++)d[f]=c[f].id,e[f]=c[f].displayText}};a.selectDropDown=function(a){a.stopPropagation(),b.hideSearchSuggestions||(40==a.keyCode?$(".dropsearch-menu .active").next().length?$(".dropsearch-menu .active").removeClass("active").next().addClass("active"):($(".dropsearch-menu .active").removeClass("active"),$(".dropsearch-menu :first").addClass("active")):38==a.keyCode?$(".dropsearch-menu .active").prev().length?$(".dropsearch-menu .active").removeClass("active").prev().addClass("active"):($(".dropsearch-menu .active").removeClass("active"),$(".dropsearch-menu :last").parent().addClass("active")):13==a.keyCode?d(function(){angular.element(".dropsearch-menu .active").trigger("click"),b.removeBackDrop()}):27==a.keyCode&&d(function(){b.removeBackDrop(),e.find("input").blur()})),z(a,y)}}]}}])}),define("services/catchmentService",["app","services/getHttpService","services/globalService"],function(a){a.config(["$httpProvider",function(a){"use strict";delete a.defaults.headers.common["X-Requested-With"]}]).factory("CatchmentService",["$http","GlobalService","GetHttpService",function(a,b,c){"use strict";var d={"Content-Type":"application/json"},e=b.getAPIURL("data/v1/entity/user/catchment"),f=function(b,c,f,g,h,i){var j,k,l={},m="POST";if(!angular.isString(c)||!c.trim())return{status:"error",msg:"Please provide a valid name"};if(!f||!f.length)return{status:"error",msg:"Please include a project to create a valid catchment"};if(b)for(m="PUT",l.id=b,l.name=c.trim(),l.catchmentProjects=[],j=0,k=f.length;k>j;j++)l.catchmentProjects.push({projectId:f[j]});else for(l.name=c.trim(),l.catchmentProjects=[],j=0,k=f.length;k>j;j++)l.catchmentProjects.push({projectId:f[j]});l.status=g?g:"Active",h&&_.isObject(h)&&(l.metaAttributes=h),a({method:m,url:e,data:l,headers:d}).then(function(a){i(a)})},g=function(a,c){var d="data/v1/entity/user/catchment?filters=id=="+a;return b.makeGetCall(d,"application/json",!0,!0).then(function(a){200===a.status&&c(a.data.data)})},h=function(a,c,d,e){var f="";f+="?sort=-id",a&&(f+="&rows="+a,f+=c?"&start="+c:"&start=0"),d&&(f+="&filters=status=="+d);var g="data/v1/entity/user/catchment"+f;return b.makeGetCall(g,"application/json",!0,!0).then(function(a){200===a.status&&e(a.data.data)})};return{updateCatchment:f,getCatchment:g,getAllCatchment:h}}])}),define("directives/common/b2b-listingfilter",["app","text!views/directives/common/b2b-listingfilter.html","services/globalService","services/searchService","services/notificationService","services/introJsService","validators/commonValidators","services/signupService","services/flags","directives/base/pt-placeholder","controllers/filterCtrl","directives/common/pt-search","services/catchmentService","services/b2b/CookieService"],function(a,b){a.directive("b2bListingfilter",[function(){return{restrict:"AE",replace:!0,template:b,controller:["$scope","$rootScope","$location","$modal","GlobalService","SearchService","NotificationService","CommonValidators","IntroJsService","SignupService","Flags","$timeout","$element","CatchmentService","CookieService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){a.isGrids=o.get("grid"),c.path().indexOf("maps")>-1?(a.toggleMLGbtns[2].active=!0,r(a.toggleMLGbtns[2])):a.isGrids?(a.toggleMLGbtns[1].active=!0,r(a.toggleMLGbtns[1])):(a.toggleMLGbtns[0].active=!0,r(a.toggleMLGbtns[0]))}a.$watch("selectedCity",function(a,b){a&&(k.set("cityMapSupport",a),k.broadcast("cityMapSupport"))}),a.cityMapSupport=k.get("cityMapSupport"),a.validateInputClass="",a.$on("cityMapSupportMessage",function(b,c){a.cityMapSupport=k.get("cityMapSupport"),a.toggleMLGbtns[2].ngshow=k.get("cityMapSupport"),a.toggleMLGbtns[2].ngshow?a.toggleMLGbtns[1].css="":a.toggleMLGbtns[1].css="mapView"}),a.$watch("urlData",function(c,d){var e=b.VIEW_TYPES;c?(f.getViewType()==e.MAP?a.mode="map":a.mode="list",a.initialize=!1,c.pageType?(c.pageType=c.pageType.toLowerCase(),b.PARSED_URL_DATA={TYPE:c.pageType,BASE:c.builder,VIEW_TYPE:f.getViewType(c.pageType),SEARCH_OBJ:c}):console.log("ERROR GOT EMPTY PAGETYPE FOR THIS URL")):b.PARSED_URL_DATA=void 0}),a.saveSearchClicked=function(){var a=d.open({templateUrl:"views/modal/saveSearch.html",controller:["$scope",function(b){b.dismiss=function(){b.errMsg="",a.dismiss()},b.saveSearch=function(d){if(h.isValidString(d))if(a.close(),e.isLoggedIn()){var g=f.saveSearch(d);g&&(b.errMsg="")}else{var i=c.url();c.hash()&&c.hash().length>0&&(i=c.url()+"#"+c.hash());var k=d+"#_#_#"+i.trim();e.setCookie("save_search",k),j.openSignUp()}else b.errMsg="Please enter a valid string"}}]});b.CURRENT_ACTIVE_PAGE};var q=function(){var a=c.path();return-1!=a.indexOf("maps")};a.isMaps=q,a.toggleMLGbtns=[{label:"List",key:"list",active:!1,css:"listView",icon:"pt-icon-list-ul",ngshow:!0},{label:"Grid",key:"grid",active:!1,css:"",icon:"pt-icon-th",ngshow:!0},{label:"Map",key:"maps",active:!1,css:"mapView",icon:"pt-icon-map-marker",ngshow:a.cityMapSupport}],a.toggleMapListGrid=function(d){var e=!1,f=d.key;if("maps"==f?e=!0:c.search("geo",void 0),"grid"==f){var g=c.path();o.set("grid",!0),a.isGrids=o.get("grid"),b.$broadcast("viewchange",{view:"grid"}),c.path(g.replace("/maps",""))}else{o.set("grid",!1),"list"==f&&(a.isGrids=o.get("grid"),b.$broadcast("viewchange",{view:"list"}));var g=c.path();q()&&!e&&c.path(g.replace("/maps","")),!q()&&e&&c.path("/maps"+g)}_.each(a.toggleMLGbtns,function(a){d!=a?a.active=!1:a.active=!0})};var r=function(d){var e=!1,f=d.key;if("maps"==f&&(e=!0),"grid"==f){var g=c.path();o.set("grid",!0),a.isGrids=o.get("grid"),b.$broadcast("viewchange",{view:"grid"}),c.path(g.replace("/maps",""))}else{o.set("grid",!1),"list"==f&&(a.isGrids=o.get("grid"),b.$broadcast("viewchange",{view:"list"}));var g=c.path();!q()&&e&&c.path("/maps"+g)}_.each(a.toggleMLGbtns,function(a){d!=a?a.active=!1:a.active=!0})};p(),a.$on("$locationChangeSuccess",function(){p()}),a.setDefaultSort=function(){a.validateInputClass="",(void 0===a.selValue||""==a.selValue)&&(a.validateInputClass="redBorder")},a.CatchmentRowCount=5,n.getAllCatchment(a.CatchmentRowCount+1,0,"Active",function(b){a.savedCatchment=b}),a.fetchCatchment=function(a){b.$broadcast("fetchCatchment",a)},a.textSearch=function(d,e){return a.validateInputClass="",void 0===a.selValue||""==a.selValue?void(a.validateInputClass="redBorder"):void("map"!==e&&(c.path("/filters").search({q:a.selValue}).hash(""),a.selValue="",b.selectedCity=void 0))}}]}}])}),define("text!views/directives/b2b/builderSearch/grid-head.html",[],function(){return"<div class=\"pt_row bl-head\">\n	<div grid-head-unit unit='unit' update-table='updateTable' sort='sort' data-ng-repeat='unit in units'></div>                \n</div>\n\n            "}),define("text!views/directives/b2b/builderSearch/grid-head-unit.html",[],function(){return'<div class="ta-center {{unit.class}}">\n	<span data-ng-class="{\'showHand\': unit.sortable}" data-ng-click="sort(unit)"> \n		<span data-ng-if="!unit.options">\n			{{unit.label}}  {{$index}} <small data-ng-if="unit.isPricePerUnitArea">(<i class="pt  pt-icon-inr"></i>/sq ft)</small>\n			<i data-ng-if="unit.sortOrder"  data-ng-class="{\'pt  pt-icon-chevron-up\': unit.sortOrder==\'ASC\', \'pt  pt-icon-chevron-down\': unit.sortOrder==\'DESC\'}"> </i>\n\n			<!-- Help text -->\n			<span data-ng-if=\'unit.helpText\'>\n				<i class="pt  pt-icon-question-circle" tooltip="{{unit.helpText}}"> </i>\n			</span>\n			<!-- Sort arrows -->\n			<a href="javascript:void(0)" class="sorter" data-ng-if="unit.sortable && !unit.sortOrder">\n				<i class="pt pt-icon-sort"></i>\n			</a>\n		</span>\n\n		<span data-ng-if="unit.options">\n			<span>\n			{{unit.selected(unit.options).label}} <small data-ng-if="unit.isPricePerUnitArea">(<i class="pt pt-icon-inr"></i>/sq ft)</small>\n				<i data-ng-if="unit.selected(unit.options).sortOrder" data-ng-class="{\'pt pt-icon-chevron-up\': unit.selected(unit.options).sortOrder==\'ASC\', \'pt  pt-icon-chevron-down\': unit.selected(unit.options).sortOrder==\'DESC\'}"> </i> \n			</span>\n			\n			<a href="javascript:void(0)" class="sorter" data-ng-if="unit.sortable && !unit.selected(unit.options).sortOrder">\n				<i class="pt pt-icon-sort"></i>\n			</a>\n		</span>\n		\n	<span>\n\n\n	<!-- Options section -->\n    <div class="toggle-cols" data-ng-if="unit.options">\n        <i class="pt  pt-icon-caret-square-o-down dropdown-toggle" data-toggle="dropdown"></i>\n        <ul class="dropdown-menu dd-list">\n        	<li data-ng-repeat=\'option in unit.options\' data-ng-click="unit.selected(unit.options).selected = false; option.selected = true; updateTable(unit, option)">{{option.label}} </li>\n        </ul>\n	</div>\n</div>	\n'}),define("directives/b2b/builderSearch/grid-head-unit",["app","text!views/directives/b2b/builderSearch/grid-head-unit.html"],function(a,b){a.directive("gridHeadUnit",[function(){return{scope:{unit:"=",updateTable:"=",sort:"="},template:b}}])}),define("directives/b2b/builderSearch/grid-head",["app","text!views/directives/b2b/builderSearch/grid-head.html","directives/b2b/builderSearch/grid-head-unit"],function(a,b){a.directive("gridHead",[function(){return{scope:{units:"=",updateTable:"=",sort:"="},template:b}}])}),define("text!views/directives/b2b/maps/alvLocalities.html",[],function(){return'<div data-ng-show="showList" class="clear" id="target">\n    <div class="view-all-wrapper fixed-header">\n        <span grid-head units=\'localityHeaderUnits\' sort=\'sort\'></span>\n    </div>\n	<div class="view-all-wrapper" id="locDiv">\n        <div id="header-fixed"></div>\n        <div data-ng-hide="localitiesList && localitiesList.length">\n            <span> No Localities Found.</span>\n        </div>\n        <div class="pt_row body row-alt-color" data-ng-repeat="loc in localitiesList | limitTo:perPageItem" data-ng-if="loc.data.authorized">\n            <div class="pt_col-1-8 ta-left"><span class="put-ellipsis" once-text="loc.data.label"></span></div>\n            <div class="pt_col-1-8">\n                <a href="javascript:void(0)" class=""><i class="pt  pt-icon-map-marker" tooltip="View Projects" data-ng-click="viewProjects(loc.data)"></i></a>\n                <a href="javascript:void(0)" class="" tooltip="View Analysis"><i class="pt  pt-icon-bar-chart-o" data-ng-click="viewAnalysis(loc.data)"></i></a>\n            </div>\n            <div class="pt_col-1-8"><i class="pt  pt-icon-inr" data-ng-if="loc.data.avgPricePerUnitArea !== \'NA\'"></i><span once-text="loc.data.avgPricePerUnitArea"></span></div>\n            <div class="pt_col-1-8" once-html="loc.data.priceRise6MonthsHtml"></div>\n            <div class="pt_col-1-8" once-text="loc.data.localityUnitsLaunched6Months"></div>\n            <div class="pt_col-1-8" once-text="loc.data.localityUnitsSold6Months"></div>\n            <div class="pt_col-1-8" once-text="loc.data.localityUnitsDelivered6Months"></div>\n            <div class="pt_col-1-8">6 months</div>\n        </div>\n    </div>\n</div>\n\n<div class="viewall-project-open" data-ng-click="toggleALV()">\n    <span data-ng-show="!showList"\n          analytics-on\n          data-analytics-event="Click_All Localities"\n          data-analytics-category="Catchment Analysis"\n          data-analytics-label="View">View all Localities</span>\n    <span data-ng-show="showList"\n          analytics-on\n          data-analytics-event="Click_All Localities"\n          data-analytics-category="Catchment Analysis"\n          data-analytics-label="Hide">Hide all Localities</span>\n    <span><i data-ng-class="{\'pt  pt-icon-caret-up\':showList, \'pt  pt-icon-caret-down\':!showList}" ></i></span>\n</div>'}),define("directives/b2b/maps/alvLocalities",["app","text!views/directives/b2b/maps/alvLocalities.html","directives/b2b/builderSearch/grid-head"],function(a,b){a.directive("alvLocalities",["$rootScope","$timeout",function(a,c){return{scope:{},template:b,link:function(b,d,e){b.localitiesList=[],b.showList=!1,b.perPageItem=20,b.localityHeaderUnits=[{label:"Locality",key:"label",sortable:!0,"class":"pt_col-1-8 ta-left"},{label:"","class":"pt_col-1-8"},{label:"Rate",key:"orgAvgPricePerUnitArea",sortable:!0,isPricePerUnitArea:!0,"class":"pt_col-1-8"},{label:"","class":"pt_col-1-8"},{label:"New Launched",key:"oLocalityUnitsLaunched6Months",sortable:!0,"class":"pt_col-1-8"},{label:"Sold",key:"oLocalityUnitsSold6Months",sortable:!0,"class":"pt_col-1-8"},{label:"Delivered",key:"oLocalityUnitsDelivered6Months",sortable:!0,"class":"pt_col-1-8"},{label:"Duration","class":"pt_col-1-8"}];var f=function(a){var c=a.options?a.selected(a.options):a;b.sort(a),"DESC"==c.sortOrder&&(b.localitiesList.reverse(),c.sortOrder="ASC")};b.sort=function(a){var c,d=a.options?a.selected(a.options):a;a.sortable&&(_.each(b.localityHeaderUnits,function(b){b!=a&&void 0!=b.sortOrder&&(b.sortOrder=void 0)}),c=_.sortBy(b.localitiesList,function(a){return a.data[d.key]}),d.sortOrder&&"ASC"==d.sortOrder?(b.localitiesList=c.reverse(),d.sortOrder="DESC"):(b.localitiesList=c,d.sortOrder="ASC"))};var g=function(){$("#locDiv").scroll(function(){$("#locDiv").prop("scrollHeight")-$("#locDiv").scrollTop()<=$("#locDiv").height()&&h()})},h=function(){!b.localitiesList||b.localitiesList.length<=b.perPageItem||(b.perPageItem+=20,c(function(){b.$apply()},0))};b.toggleALV=function(){b.showList=!b.showList,b.showList&&g()},b.viewProjects=function(b){a.$broadcast("viewProjects",b)},b.viewAnalysis=function(b){a.$broadcast("viewAnalysis",b)},b.$on("alvLocalities",function(a,c){b.localitiesList=c,f(b.localityHeaderUnits[0])}),b.$on("openLocalitiesALV",function(a,c){b.showList=c,b.perPageItem=20})}}}])}),define("text!views/directives/b2b/maps/alvProjects.html",[],function(){return' <div data-ng-show="showList" class="clear" id="target">\n    <div class="view-all-wrapper v-projs" style="min-height:0px; overflow:none;">\n        <span grid-head units=\'projectHeaderUnits\' sort=\'sort\'></span>\n    </div>\n	<div class="view-all-wrapper v-projs" id="projDiv">\n        <div data-ng-hide="projectsList && projectsList.length">\n            <span> No Projects Found.</span>\n        </div>\n        <div class="pt_row body" data-ng-repeat="proj in projectsList | limitTo:perPageItem" data-ng-if="proj.authorized">\n            <div class="pt_col-2-12 ta-left">\n                <input type="checkbox" data-ng-click="projectTicked(proj)" data-ng-checked="proj.projectSelected" class="cbox">\n                <a href="/phase-detail?projectId={{proj.projectId}}" target="_blank">\n                    <span class="put-ellipsis w85" once-text="proj.fullName" tooltip="{{proj.fullName}}" tooltip-placement="right"></span>            \n                </a>\n                </input>\n            </div>\n            <div class="pt_col-1-12"><a href="javascript:void(0)" class=""><i class="pt  pt-icon-map-marker" tooltip="Show on Map" data-ng-click="projectClick(proj)"></i></a></div>\n            <div class="pt_col-2-12" once-text="proj.projectStatus"></div>\n            <div class="pt_col-1-12" ><i class="pt-icon-{{proj.projectType}}" once-title="proj.bhkInfo"></i></div>\n            <div class="pt_col-1-12" tooltip="{{proj.displayPriceunitsHtmlHover}}" once-html="proj.displayPriceunitsHtml"></div>\n            <div class="pt_col-2-12" tooltip="{{proj.totalUnitsHover}}" once-text="proj.totalUnits"></div>\n            <div class="pt_col-1-12" tooltip="{{proj.totalSoldHover}}" once-text="proj.totalSold"></div>\n            <!--<div class="pt_col-1-12" once-text="proj.totalUnits-proj.derivedAvailability"></div> -->\n            <div class="pt_col-1-12" once-text="proj.launchDate"></div>\n            <div class="pt_col-1-12" once-text="proj.possessionDate"></div>\n        </div>\n    </div>\n</div>\n\n<div class="viewall-project-open loc-btn" data-ng-click="toggleALV()">\n    <span data-ng-show="!showList">View all Projects</span>\n    <span data-ng-show="showList">Hide all Projects</span>\n    <span><i data-ng-class="{\'pt  pt-icon-caret-up\':showList, \'pt  pt-icon-caret-down\':!showList}"></i></span>\n</div>'}),define("directives/b2b/maps/alvProjects",["app","text!views/directives/b2b/maps/alvProjects.html","directives/b2b/builderSearch/grid-head"],function(a,b){a.directive("alvProjects",["$rootScope","$timeout",function(a,c){return{scope:{},template:b,link:function(b,d,e){b.projectsList=[],b.showList=!1,b.perPageItem=20,b.projectHeaderUnits=[{label:"Project",key:"fullName",sortable:!0,"class":"pt_col-2-12 ta-left"},{label:"","class":"pt_col-1-12"},{label:"Status",key:"projectStatus",sortable:!0,"class":"pt_col-2-12"},{label:"Type","class":"pt_col-1-12"},{label:"Rate",key:"orgAvgPricePerUnitArea",sortable:!0,isPricePerUnitArea:!0,"class":"pt_col-1-12"},{label:"Units Launched","class":"pt_col-2-12"},{label:"Total Sold(%)","class":"pt_col-1-12"},{label:"Launch Date",key:"launchDateTstamp",sortable:!0,"class":"pt_col-1-12"},{label:"Completion Date",key:"possessionDateTstamp",sortable:!0,"class":"pt_col-1-12"}];var f=function(a){var c=a.options?a.selected(a.options):a;b.sort(a),"DESC"==c.sortOrder&&(b.projectsList.reverse(),c.sortOrder="ASC")};b.sort=function(a){var c,d=a.options?a.selected(a.options):a;a.sortable&&(_.each(b.projectHeaderUnits,function(b){b!=a&&void 0!=b.sortOrder&&(b.sortOrder=void 0)}),c=_.sortBy(b.projectsList,function(a){return a[d.key]}),d.sortOrder&&"ASC"==d.sortOrder?(b.projectsList=c.reverse(),d.sortOrder="DESC"):(b.projectsList=c,d.sortOrder="ASC"))};var g=function(){$("#projDiv").scroll(function(){$("#projDiv").prop("scrollHeight")-$("#projDiv").scrollTop()<=$("#projDiv").height()&&h()})},h=function(){!b.projectsList||b.projectsList.length<=b.perPageItem||(b.perPageItem+=20,c(function(){b.$apply()},0))};b.projectClick=function(b){a.$broadcast("projectClicked",b)},b.projectTicked=function(b){a.$broadcast("projectTicked",b)},b.toggleALV=function(){b.showList=!b.showList,b.showList&&g()},b.$on("alvProjects",function(a,c){b.projectsList=c,f(b.projectHeaderUnits[0])}),b.$on("openProjectsALV",function(a,c){b.showList=c,b.perPageItem=20})}}}])}),define("directives/b2b/maps/b2b-markers",["app","services/localityService","services/markerFactory"],function(a){a.directive("btobMarkers",["$rootScope","PtMapsConfig","LocalityService","markerFactory","$timeout",function(a,b,c,d,e){return{restrict:"A",link:function(f,g){f.map=b.mapConfig,f.$on("b2bLocalityClicked",function(a,b){var c=$("#"+b.selector),d=$(".l-mrkr");c.hasClass("active")?c.removeClass("active"):(d.removeClass("active"),c.addClass("active"))}),f.$on("removeAllProjectPopup",function(){$(".p-mrkr").removeClass("active")}),f.$on("markerClicked",function(a,b){var c=$(".p-mrkr");c.removeClass("active"),$("#project_"+b.data.projectId).addClass("active")}),f.$on("showProjectMarkers",function(a,b){b?$(".p-mrkr").show():$(".p-mrkr").hide()}),f.$on("showMarkers",function(a,b){b?$(".mrkr").show():$(".mrkr").hide()}),f.$on("addNeighbourhood",function(a,b){h(b.type,b.level,b.position,b.radius,b.direction)}),f.$on("showNeighbourhood",function(a,b){
b?$(".neighbour-icons").show():$(".neighbour-icons").hide()}),f.$on("removeNeighbourhood",function(a,b){var c,d=0,e=b.types||_.keys(f.map.state.neighbourhood[b.level]);for(d=0,c=e.length;c>d;d++)j(e[d],b.level)}),f.$on("$destroy",function(){f.map=void 0,g.remove()}),f.$on("showLocalityMarkers",function(a,b){b?$(".l-mrkr").show():$(".l-mrkr").hide()});var h=function(b,d,g,h,j){if(g=g||f.map.state.filter.state.position,h=h||f.map.state.filter.state.distance,j=j||!1,$("#neighbourhoodLoaderProject").show(),"airport"===b[0]){var k=[];a.selectedCity.amenities&&(k=_.filter(a.selectedCity.amenities,function(a){return a.localityAmenityTypes?"airport"===a.localityAmenityTypes.name:!1})),e(function(){i(b,d,g,h,j,k)},10)}else c.getNeighbourhood(g,h,b[0],function(a){i(b,d,g,h,j,a)})},i=function(b,c,e,g,h,i){var j,k,l=0,m=null,n=[],o=!1;for("airport"===b[0]&&(o=!0),$("#neighbourhoodLoaderProject").hide(),l=0,k=i.length;k>l;l++)m=i[l],m.__direction__=h,h||(m.__tooltip__=m.name),j=new d.marker(b,m),n.push(j);f.map.state.neighbourhood[c][b]=n,a.$broadcast("readyToDrawNeighbourhoodMarkers",{type:b,level:c,project:e,direction:h,showMultipleDirections:o})},j=function(b,c){e(function(){a.$broadcast("readyToDrawNeighbourhoodMarkers",{type:b,level:c,removeState:!0})},10)}}}}])}),define("text!views/directives/b2b/maps/downloadAlvData.html",[],function(){return'<div class="pull-right relativePostion" data-ng-click="downloadAlvList()">\n	<a class="inblk" tooltip="{{tooltip}}">\n		<i class="pt pt-icon-arrow-circle-down"></i>\n	</a>\n</div>'}),define("directives/b2b/maps/downloadAlvData",["app","text!views/directives/b2b/maps/downloadAlvData.html"],function(a,b){a.directive("ptAlvDownloadData",["$modal",function(a){return{restrict:"AE",template:b,scope:{builderId:"="},link:function(b,c,d){b.builderId?b.tooltip="Download builder's project data.":b.tooltip="Download the data of selected projects.",b.downloadAlvList=function(){a.open({backdrop:"static",templateUrl:"views/directives/b2b/modal/download-catchment-listing.html",controller:["$scope","$modalInstance","$rootScope",function(a,c,d){b.builderId?a.title="Download Builder Information":a.title="Download Catchment Information",a.listing={},a.listing.fromDate=new Date,a.listing.toDate=new Date,a.msg="",a.disableDownload=!1,a.aggregated,a.setAggregated=function(){$("#aggregatedCheckbox").prop("checked")?a.aggregated=!0:a.aggregated=void 0},a.cancel=function(){h()},a.validateAndProcess=function(){var c=(a.listing.fromDate,a.listing.toDate,i());return c?void(a.msg=c):void d.$broadcast("alvDownloadDataValid",{fromDate:a.listing.fromDate,toDate:a.listing.toDate,builderId:b.builderId,aggregated:a.aggregated})};var e=a.$on("alvDownloadDataValidationError",function(b,c){a.msg=c,a.disableDownload=!1}),f=a.$on("dismissAlvDownloadDataModal",function(a){h()}),g=a.$on("disableDownloadButton",function(b,c){a.disableDownload=c}),h=function(){a.disableDownload=!1,e(),f(),g(),c.dismiss("cancel")},i=function(){var b=a.listing.fromDate,c=a.listing.toDate;return b&&c?angular.isDate(b)&&angular.isDate(c)?b>c?"Please ensure the From Date is of earlier duration than the To Date":c>new Date?"Please choose a date before today's date":void 0:"Please provide a valid Date":"Please provide valid Date"}}]})}}}}])}),define("services/b2b/DownloadService",["app","formatters/common"],function(a){a.factory("DownloadService",["$http","GlobalService","$window","Formatter",function(a,b,c,d){var e="app/v1/report/price-and-absorption",f=function(c){return a({method:"GET",url:b.getAPIURL(e+h(c)),timeout:1e4}).then(function(a){return a})},g=function(a){var b=c.location;b.href=b.protocol+"//"+b.host+"/app/v1/report/download?key="+a},h=function(a){var b,c=new Date(a.fromDate),e=new Date(a.toDate),f=[],g=[];c.setDate(1),e.setDate(1),f.push("(month=ge="+d.getYYYYMMDD(c,"-")+")"),f.push("(month=le="+d.getYYYYMMDD(e,"-")+")");for(var h=0,i=a.projectIds.length;i>h;h++)g.push("(projectId=="+a.projectIds[h]+")");return f.push("("+g.join(",")+")"),b=a.aggregated?"?aggregatedOnly=true&filters=("+f.join(";")+")":"?filters=("+f.join(";")+")"};return{getCatchmentInfoFileName:f,getCatchmentInfoFile:g}}])}),define("text!views/directives/b2b/maps/pt-b2b-projectdetail.html",[],function(){return'<div data-ng-show="showDetailFlag" class="proj-card-wrap">\n    <div data-ng-show="data.authorized">\n        <div data-ng-if="data.projectId" class="proj-name-wrap" id="projectDetail_{{data.projectId}}">\n            <a class="proj-name" tooltip="{{data.builder.name}} {{data.name}}" tooltip-placement="bottom" data-ng-href="/phase-detail?projectId={{data.projectId}}" target="_blank">{{data.builder.name}} {{data.name}}</a> \n            <a class="goto-link" data-ng-href="/phase-detail?projectId={{data.projectId}}" target="_blank" tooltip="Go to this project" tooltip-placement="right"> <i class="pt pt-icon-external-link"></i> </a>\n            <a class="close" data-ng-click="close()">&#120;</a>\n            <div class="clearfix"></div>\n        </div>\n        <div class="loc-name-wrap">\n            <span class="loc-name" tooltip-placement="bottom" tooltip="{{ data.locality.label }}, {{ data.locality.suburb.city.label }}">{{ data.locality.label }}, {{ data.locality.suburb.city.label }}</span>\n            <div pt-rating ratings="data.locality.ratings" data-ng-if="data.locality.ratings" ></div>\n            <div class="clearfix" ></div>\n        </div>\n\n        <ul tabset class="projectDetailsTabs">\n            <li tab heading="Project Details" id="project-details" data-ng-click="tabSwitch(\'project-details\')">\n                <div class="key-val-wrap">\n                    <div class="key-col">Rise / Fall: </div>\n                    <div class="val-col">\n                        <span data-ng-if="data.avgPriceRisePercentage < 0" class="rise-fall grey" tooltip="in past {{ data.avgPriceRiseMonths }} months" tooltip-placement="right">\n                            ({{ -data.avgPriceRisePercentage}} % <i class="pt pt-icon-arrow-down"></i>)\n                        </span>\n                        <span data-ng-if="data.avgPriceRisePercentage > 0" class="rise-fall green" tooltip="in past {{ data.avgPriceRiseMonths }} months" tooltip-placement="right">\n                            ({{ data.avgPriceRisePercentage}} % <i class="pt pt-icon-arrow-up"></i>)\n                        </span>\n                    </div>\n                </div>\n                <div class="key-val-wrap">\n                    <div class="key-col">Price/Area: </div>\n                    <div class="val-col">\n                        <span data-ng-bind-html="data.displayPriceunitsHtmlMarker"></span>\n                    </div>\n                </div>\n                <div class="key-val-wrap">\n                    <div class="key-col">Total Launched Units: </div>\n                    <div class="val-col">{{ data.totalUnits }} </div>\n                </div>\n                <div class="key-val-wrap">\n                    <div class="key-col">Total Supply: </div>\n                    <div class="val-col">{{ data.supply }} </div>\n                </div>\n                <div data-ng-show="data.builderMarketingShare" class="key-val-wrap">\n                    <div class="key-col">Builder Marketing Share: </div>\n                    <div class="val-col">{{ data.builderMarketingShare }} % </div>\n                </div>\n                <div data-ng-show="data.isRedevelopementProject" class="key-val-wrap">\n                    <div class="key-col">Redevelopment Project: </div>\n                    <div class="val-col">Yes</div>\n                </div>\n                <div class="key-val-wrap">\n                    <div class="key-col">Sold Percentage: </div>\n                    <div class="val-col">{{ data.totalSold }} </div>\n                </div>\n                <div class="key-val-wrap">\n                    <div class="key-col">Total Area: </div>\n                    <div class="val-col">{{ data.projectSize }}</div>\n                </div>\n                <div class="key-val-wrap">\n                    <div class="key-col">Property Type: </div>\n                    <div class="val-col">{{ data.bhkInfo }}</div>\n                </div>\n                <div class="key-val-wrap">\n                    <div class="key-col">Launch Date: </div>\n                    <div class="val-col">{{ data.launchDate }} </div>\n                </div>\n                <div class="key-val-wrap">\n                    <div class="key-col">Project Status: </div>\n                    <div class="val-col">{{data.projectStatus}}</div>\n                </div>\n            </li>\n            <li tab data-ng-hide="data.unMapped" heading="Neighbourhood" id="neighbourhood" data-ng-click="tabSwitch(\'neighbourhood\')">\n                <div pt-nearby-amenities shared-obj="data.item"></div>\n            </li>\n        </ul>\n        <!-- Card Footer Buttons -->\n        <div class="card-footer">\n            <div class="addRemoveCatchment" data-ng-class="{active : projectSelected}" data-ng-click="selectProject()">\n                <div class="remCatch">\n                    <span class="">Remove from catchment</span>\n                    <a class="addRemLink"><i class="pt pt-icon-check-square"></i></a>\n                </div>\n                <div class="addCatch">\n                    <span class="">Add in catchment</span>\n                    <a class="addRemLink"><i class="pt pt-icon-square-o"></i></a>\n                </div>\n            </div>\n            <div class="clear"></div>\n        </div>\n    </div>\n    <div data-ng-show="!data.authorized" class="buy-wrap">\n        <a class="close spcl" data-ng-click="close()">&#120;</a>\n        <i class="pt pt-icon-shopping-cart"></i>\n        <div class="txt">Oops! you need to upgrade your package to view this data.</div>\n        <a class="btn btn-large btn-primary">Upgrade Plan</a>\n    </div>\n</div>\n'}),define("controllers/common/commonFullScreenCtrl",["app"],function(a){a.controller("commonfullscreenctrl",["$scope","$rootScope","$modalInstance","images","index","unique","leadData","has3dimages","setFloorPlanFromListing","landmarkCount","$timeout",function(a,b,c,d,e,f,g,h,i,j,k){a.optionsFullView={width:1330,height:800,imageWidth:1040,imageHeight:780,width100Proc:!0,height100Proc:!0,ptzoomControlVisible:!0,thumbnailWidth:100,thumbnailHeight:50,thumbnailMargin:5},a.images=d,a.index=e,a.unique=f,a.leadData=g,a.has3dimages=h,a.setFloorPlanFromListing=i,a.landmarkCount=j,a.collapse=function(){c.close(a.index),b.CURRENT_ACTIVE_PAGE,b.$broadcast("youtubeCollapse","collapse")}}])}),define("text!views/directives/common/pt-carousel.html",[],function(){return'<div data-ng-keyup="keypress($event)" tabindex="1" class="pt-carousel {{options.skin}}">\n    <div class="pt-carousel-collection" data-ng-style="{height: options.height+\'px\'}">\n        <div class="pt-carousel-left-panel" data-ng-class="{\'carousel-fullPhoto\' : collapseleadform || !leadData}">\n            <div data-ng-if="totalImages>1" class="bannerControls">\n                <div data-ng-click="Previous()"\n                     analytics-on\n                     data-analytics-event="Gallery View"\n                     data-analytics-category="Project Details View"\n                     data-analytics-label="Previous"\n                     class="leftNav"><i class="pt pt-icon-chevron-circle-left"></i></div>\n                <div data-ng-click="Next()"\n                     analytics-on\n                     data-analytics-event="Gallery View"\n                     data-analytics-category="Project Details View"\n                     data-analytics-label="Next"\n                     class="rightNav"><i class="pt pt-icon-chevron-circle-right"></i></div>\n            </div>\n            <ul class="carouselImageViewer">\n                <li data-ng-repeat="slide in ptslides">\n                    <div class="pt-cont-info" data-ng-if="slide.visible">\n                        <div data-ng-if="slide.mainTitle && slide.locality && slide.city">\n                            <div class="pt-cont-buil-text-info pull-left">\n                                <div class="pt-cout-buil-city-info">\n                                    {{slide.mainTitle}}, <span>{{slide.locality}}, {{slide.city}}</span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div data-ng-if="slide.walkThrough && $root.floorImageTypeWT" class="projDescInfo">This video is an artistic impression of the apartment. It may not be exact representation.</div>\n                    <div data-ng-if="slide.visible && slide.type==\'Construction\'" class="gallWrapperInfo">\n                        <span class="gallDropdownInfo">{{selectedconstructionImage.type}}<i class="pt pt-icon-angle-down"></i></span>\n                        <div class="gallPanor-overlay statViewInfo">\n                            <div class="panorDetailViewInfo">\n                                <ul class="ulTableView">\n                                    <li data-ng-click="SetImage(conf.startindex, null, null, null, true)" data-ng-repeat="conf in constructionDetail.config">\n                                        <span data-ng-bind-html="conf.type"></span>\n                                    </li>\n                                </ul>\n                            </div>\n                        </div>\n                    </div>\n                    <div data-ng-if="slide.visible && slide.type==\'Neighborhood\'" class="gallWrapperInfo">\n                        <span class="gallDropdownInfo">{{selectedneighborImage.type}} ({{selectedneighborImage.count}})<i class="pt pt-icon-angle-down"></i></span>\n                        <div class="gallPanor-overlay statViewInfo">\n                            <div class="panorDetailViewInfo">\n                                <ul class="ulTableView">\n                                    <li data-ng-click="SetImage(conf.startindex, null, null, null, true)" data-ng-repeat="conf in neighbourDetail.config">\n                                        <span>{{conf.type}} <span class="font-weight">({{conf.count}})</span></span>\n                                    </li>\n                                </ul>\n                            </div>\n                        </div>\n                    </div>\n                    <div data-ng-if="slide.visible && slide.type==\'Project & Floor Plans\' && slide.unitName" class="gallWrapperInfo">\n                        <span class="gallDropdownInfo">\n                                                    <span class="pull-left">{{selectedProperty.unitName}}\n                                                        <span class="gallPropSizeInfo" data-ng-if="selectedProperty.size">{{selectedProperty.size}}&nbsp;{{selectedProperty.measure}}</span>\n                        <span class="gallPropSizeInfo" data-ng-if="!selectedProperty.size && selectedProperty.carpetArea">{{selectedProperty.carpetArea}}&nbsp;{{selectedProperty.measure}} (Carpet Area)</span>\n                        </span>\n                        <i class="pt pt-icon-angle-down"></i>\n                        </span>\n                        <div class="gallPanor-overlay" pt-property-config-overlay></div>\n                    </div>\n                    <!--panorama-->\n                    <div data-ng-if="slide.visible && slide.floor3dImage && slide.panoramaViewPath" data-ng-click="expandTour(leadData.projectId, slide.panoramaUnit, slide.panoramaViewPath, null, \'name\')" class="panor-top-view">\n                        <div class="panor-view-info pull-left marginL10">\n                            <i class="pt pt-icon-panorama panor-icon-view"></i>\n                            <span class="panor-iconText-view">360&deg;</span>\n                            <span class="panor-text-info">Panorama View</span>\n                        </div>\n                    </div>\n                    <div class="pt-carousel-img-cont-info" data-ng-if="slide.visible">\n                        <div class="pt-cont-text-info">\n                            <span class="cont-img-info">({{currentIndex + 1}}/{{totalImages}})</span>\n                            <span data-ng-if="options.height100Proc || options.showLabel" class="proj-desc-img-info">{{slide.displayAltText}}</span>\n                        </div>\n                    </div>\n                    <!-- if slide is not vedio -->\n                    <div data-ng-if="!options.height100Proc && slide.visible && !slide.internalVideo" class="imagerContainer {{slide.imageClass}}" data-ng-style="{width: calWidth+10+\'px\', height: options.height+\'px\'}">\n                        <div data-ng-if="isloadervisible && !$root.floorImageTypeWT" class="carouselLoader">\n                            <div pt-loading-block class="carouselSpin"></div>\n                        </div>\n                        <div data-ng-style="{width: calWidth+10+\'px\', height: options.height+\'px\'}" pt-draggable="{{options.ptzoomControlVisible}}" class="image-info" itemscope="" itemtype="http://schema.org/ImageObject">\n                            <i data-ng-if="slide.video || (slide.walkThrough && $root.floorImageTypeWT)" class="pt pt-icon-youtube-play cursorPointer player" data-ng-click="expand()"></i>\n                            <!--WT-->\n                            <img data-ng-if="slide.walkThrough && $root.floorImageTypeWT" data-ng-click="expand()" class="cursorZoomIn {{slide.slideClass}}" data-ng-src="{{slide.walkThroughThumb}}" alt="{{slide.text}}" data-ng-style="{width: calWidth, height: calHeight+\'px\', left: calLeft, top: calTop}" bn-load="imageLoaded()" itemprop="contentURL">\n                            <!--image-->\n                            <img data-ng-if="!slide.floor3dImage && !(slide.walkThrough && $root.floorImageTypeWT)"\n                                 analytics-on\n                                 data-analytics-event="Gallery Zoom"\n                                 data-analytics-category="Project Details View"\n                                 data-analytics-label="View: {{slide.text}}"\n                                 data-ng-click="expand()" class="cursorZoomIn {{slide.slideClass}}" data-ng-src="{{slide.largeImage}}" alt="{{slide.text}}" data-ng-style="{width: calWidth, height: calHeight+\'px\', left: calLeft, top: calTop}" bn-load="imageLoaded()" itemprop="contentURL">\n                            <!--3d-->\n                            <img data-ng-if="slide.floor3dImage && $root.floorImageType3dImg" data-ng-click="expand()" class="cursorZoomIn {{slide.slideClass}}" data-ng-src="{{slide.floor3dImage}}" alt="{{slide.text}}" data-ng-style="{width: calWidth, height: calHeight+\'px\', left: calLeft, top: calTop}" bn-load="imageLoaded()" itemprop="contentURL">\n                            <!--2d-->\n                            <img data-ng-if="slide.floor3dImage && $root.floorImageTypeImg" data-ng-click="expand()" class="cursorZoomIn {{slide.slideClass}}" data-ng-src="{{slide.largeImage}}" alt="{{slide.text}}" data-ng-style="{width: calWidth, height: calHeight+\'px\', left: calLeft, top: calTop}" bn-load="imageLoaded()" itemprop="contentURL">\n                        </div>\n                    </div>\n                    <!--resale Listing videos-->\n                    <div data-ng-if="!options.height100Proc && slide.visible && slide.internalVideo" class="imagerContainer {{slide.imageClass}}" data-ng-style="{width: calWidth+10+\'px\', height: options.height+\'px\'}">\n                        <div data-ng-if="isloadervisible" class="carouselLoader">\n                            <div pt-loading-block class="carouselSpin"></div>\n                        </div>\n                        <div data-ng-style="{width: calWidth+10+\'px\', height: options.height+\'px\'}" pt-draggable="{{options.ptzoomControlVisible}}" class="image-info" itemscope="" itemtype="http://schema.org/ImageObject">\n                            <i class="pt pt-icon-youtube-play cursorPointer player" data-ng-click="expand()"></i>\n                            <!--WT-->\n                            <img data-ng-click="expand()" class="cursorZoomIn {{slide.slideClass}}" data-ng-src="{{slide.walkThroughThumb}}" alt="{{slide.text}}" data-ng-style="{width: calWidth, height: calHeight+\'px\', left: calLeft, top: calTop}" bn-load="imageLoaded()" itemprop="contentURL">\n                        </div>\n                    </div>\n                    <!-- is slide is full screen and not vedio -->\n                    <div data-ng-if="options.height100Proc && slide.visible && !slide.video && !$root.floorImageTypeWT" class="imagerContainer {{slide.imageClass}}" data-ng-style="{width: calWidth+10+\'px\', height: options.divHeight+\'px\'}">\n                        <div data-ng-if="isloadervisible  && !$root.floorImageTypeWT" class="carouselLoader">\n                            <div pt-loading-block class="carouselSpin"></div>\n                        </div>\n                        <div data-ng-style="{width: calWidth+10+\'px\', height: options.divHeight+\'px\'}" pt-draggable="{{options.ptzoomControlVisible}}" class="image-info">\n                            <img data-ng-if="!slide.floor3dImage" data-ng-src="{{slide.largeImage}}" class="{{slide.slideClass}}" alt="{{slide.text}}" data-ng-style="{width: calWidth+\'px\', height: calHeight+\'px\', left: calLeft, top: calTop}" bn-load="imageLoaded()">\n                            <div data-ng-if="slide.floor3dImage && $root.floorImageType3dImg" data-ng-style="{width: calWidth+\'px\', height: calHeight+\'px\', top:0, left:0}" class="{{slide.slideClass}} isometric_svg">\n                                <img data-ng-src="{{slide.floor3dImage}}" alt="{{slide.text}}" data-ng-style="{width: calWidth+\'px\', height: calHeight+\'px\', left:0, top:0}" bn-load="imageLoaded()">\n                                <div class="floor_detail_tooltip">\n                                    <div class="position_Right tooltip_arrow"></div>\n                                    <div class="position_Left tooltip_arrow"></div>\n                                    <div class="position_Top tooltip_arrow"></div>\n                                    <div class="position_Bottom tooltip_arrow"></div>\n                                    <div class="floor_tooltip">\n                                        <div class="header">Header</div>\n                                        <div class="content">\n                                            <div class="details">\n                                            </div>\n                                            <p class="tip"></p>\n                                        </div>\n                                    </div>\n                                </div>\n                                <svg class="svgInfo" data-ng-style="{width: calWidth, height: calHeight+\'px\'}" preserveAspectRatio="xMinYMin meet" viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="top:0px; left:0px;">\n                                    <g data-ng-repeat="svg in svg_details">\n                                        <polygon class="{{svg.polygon_class}} polygon panor-top-view" data-ng-click="expandTour(leadData.projectId, slide.panoramaUnit, slide.panoramaViewPath, svg.polygon_class, svg.name)" ng-attr-points="{{svg.per_points}}" data-ng-mouseover="svg_mouseenter(svg.polygon_class, svg.name, svg.tooltip_pos, svg.tooltip_top, svg.tooltip_left, svg.length, svg.width, slide.panoramaViewPath)" data-ng-mouseleave="svg_mouseout(svg.polygon_class)" style="opacity:0.01" />\n                                    </g>\n                                </svg>\n                            </div>\n                            <img data-ng-if="slide.floor3dImage && $root.floorImageTypeImg" data-ng-src="{{slide.largeImage}}" class="{{slide.slideClass}}" alt="{{slide.text}}" data-ng-style="{width: calWidth, height: calHeight+\'px\', left: calLeft, top: calTop}" bn-load="imageLoaded()">\n                        </div>\n                    </div>\n\n                    <div data-ng-style="{ height: options.divHeight+\'px\'}" data-ng-if="options.height100Proc && slide.visible && slide.internalVideo" class="ta-center">\n                        <div style="height:0px; width:100%;"></div>\n                        <span pt-playerjw isopen=\'options.height100Proc\' params="params" slide-data="slide" width="100%" height="90%"></span>\n                    </div>\n\n                    <!-- if slide is walkThrough and full screen mode -->\n                    <div data-ng-style="{ height: options.divHeight+\'px\'}" data-ng-if="options.height100Proc && slide.visible && $root.floorImageTypeWT && slide.walkThrough && !slide.internalVideo" class="ta-center">\n                        <div style="height:0px; width:100%;"></div>\n                        <span pt-playerjw isopen=\'options.height100Proc\' params="params" slide-data="slide" width="100%" height="90%"></span>\n                    </div>\n                    <!-- if slide is video and full screen mode -->\n                    <div data-ng-style="{ height: options.divHeight+\'px\'}" data-ng-if="options.height100Proc && slide.visible && slide.video">\n                        <div style="height:52px; width:100%;"></div>\n                        <span pt-youtube id="{{slide.videoId}}" player-id="\'project-gallery\'" slide-data="slide" width="100%" height="90%"></span>\n                    </div>\n                    <div data-ng-if="options.ptzoomControlVisible && !slide.video && !$root.floorImageTypeWT && slide.visible" class="ptZoomInOutControls buttons">\n                        <ul class="pt-carousel-control">\n                            <li data-ng-if="has3dimages && !hideswitch" class="panor-wrapper">\n                                <div class="floorPlanTextViewer">Floor Plan also available in</div>\n                                <div class="floorPlanViewerInfo">\n                                    <div data-ng-click="Set3DImageForFirstClick()" class="threeD-view pull-left">\n                                        <i class="pt pt-icon-cube"></i>\n                                        <span>3D</span>\n                                    </div>\n                                    <div class="panor-view pull-left marginL10">\n                                        <i class="pt pt-icon-panorama panor-icon-view"></i>\n                                        <span class="panor-iconText-view">360&deg;</span>\n                                    </div>\n                                    <div class="panor-overlay" pt-property-config-overlay></div>\n                                </div>\n                            </li>\n                            <li>\n                                <button data-ng-click="ZoomIn()" class="zoom-in pt pt-icon-search-plus {{isZoomIn}}"></button>\n                                <button data-ng-click="ZoomOut()" class="zoom-out pt pt-icon-search-minus {{isZoomOut}}"></button>\n                            </li>\n                        </ul>\n                    </div>\n                    <div class="img-tab-viewer">\n                        <div class="img-viewer-info">\n                            <a data-ng-if="slide.largeImage && (slide.floor3dImage || slide.walkThrough)" data-ng-class="{\'active\': $root.floorImageTypeImg, \'cursorDefault\': $root.floorImageTypeImg}" data-ng-click="setImageFloorType(\'2D\')">2D</a>\n                            <a data-ng-if="slide.floor3dImage && (slide.largeImage || slide.walkThrough)" data-ng-class="{\'active\': $root.floorImageType3dImg, \'cursorDefault\': $root.floorImageType3dImg}" data-ng-click="setImageFloorType(\'3D\')">3D</a>\n                            <a data-ng-if="slide.walkThrough && (slide.floor3dImage || slide.largeImage)" data-ng-class="{\'active\': $root.floorImageTypeWT, \'cursorDefault\': $root.floorImageTypeWT}" data-ng-click="setImageFloorType(\'WT\')"><i class="pt pt-icon-video-camera"></i></a>\n                        </div>\n                    </div>\n                </li>\n            </ul>\n        </div>\n        <div data-ng-keyup="$event.stopPropagation();" class="pt-carousel-right-panel" data-ng-if="leadData">\n            <div pt-enquireform city-enabled="leadConfig.cEnabled" locality-enabled="leadConfig.lEnabled" is-modal="leadConfig.isModal" initial="leadData" class="pt-carousel-lead"></div>\n            <div class="leadCollapInfo" data-ng-click="toggleform()">\n                <i class="pt pt-icon-angle-double-right" data-ng-if="!collapseleadform"></i>\n                <i class="pt pt-icon-angle-double-left" data-ng-if="collapseleadform"></i>\n            </div>\n        </div>\n    </div>\n    <div data-ng-if="errorMesageBox">3D floor plan is not available for this property</div>\n    <div class="pt-thums-viewer" data-ng-if="options.showBottomNav">\n        <div class="photoGalleryTab">\n            <button class="thumbViewerInfo" data-ng-click="toggelThumbviewer()">Thumbnails\n                <i class="pt pt-icon-angle-double-down" data-ng-if="!hidethumbs"></i>\n                <i class="pt pt-icon-angle-double-up" data-ng-if="hidethumbs"></i>\n            </button>\n            <ul>\n                <li data-ng-repeat="bucket in buckets">\n                    <span analytics-on\n                          data-analytics-event="Gallery View Type"\n                          data-analytics-category="Project Details View"\n                          data-analytics-label="{{bucket.name}}" data-ng-click="SetImage(bucket.minRange)" class="{{bucket.class}}" data-ng-bind-html="bucket.name"></span>\n                </li>\n            </ul>\n        </div>\n        <div class="pt-thums-img-gallery">\n            <ul class="carouselIndicators" data-ng-style="{width: carouselWidth+\'px\'}">\n                <li class="sliderTab" data-ng-repeat="slide in ptslides">\n                    <a data-ng-click="SetImage($index, undefined ,$event, true)" data-ng-href="{{slide.pageUrl}}">\n                        <div class="thumbsHolder_ThumbOFF {{slide.thumbClass}}">\n                            <i data-ng-if="slide.video" class="pt pt-icon-youtube-play player"></i>\n                            <img data-ng-if="!slide.floor3dImage" data-ng-src="{{slide.thumbImage}}" data-ng-style="{width: options.thumbnailWidth+\'px\', height: options.thumbnailHeight+\'px\'}" alt="{{slide.text}}">\n                            <img data-ng-if="slide.floor3dImage && $root.floorImageType3dImg" data-ng-src="{{slide.thumbImage}}" data-ng-style="{width: options.thumbnailWidth+\'px\', height: options.thumbnailHeight+\'px\'}" alt="{{slide.text}}">\n                            <img data-ng-if="slide.floor3dImage && $root.floorImageTypeImg" data-ng-src="{{slide.thumbImage}}" data-ng-style="{width: options.thumbnailWidth+\'px\', height: options.thumbnailHeight+\'px\'}" alt="{{slide.text}}">\n                            <img data-ng-if="slide.floor3dImage && ($root.floorImageTypeWT || $root.floorImageTypeImg)" data-ng-src="{{slide.thumbImage}}" data-ng-style="{width: options.thumbnailWidth+\'px\', height: options.thumbnailHeight+\'px\'}" alt="{{slide.text}}">\n                        </div>\n                        <div data-ng-if=\'slide.floor3dImage || slide.walkThrough\' class="threeD-thums-view check3d_{{$index}} pt_check3d"><i data-ng-if=\'slide.floor3dImage\' class="pt pt-icon-cube"></i><i data-ng-if=\'slide.walkThrough\' class="pt pt-icon-video-camera"></i></div>\n                    </a>\n                </li>\n            </ul>\n        </div>\n        <div data-ng-if="carouselSteps > 1">\n            <div data-ng-click="scrollThumbnailsRight()" class="carouselLeftNav {{leftScrollClass}}"><i class="pt pt-icon-chevron-circle-left"></i></div>\n            <div data-ng-click="scrollThumbnailsLeft()" class="carouselRightNav {{rightScrollClass}}"><i class="pt pt-icon-chevron-circle-right"></i></div>\n        </div>\n    </div>\n    <div data-ng-click="expand()"  class="expand-btn"><i class="pt pt-icon-expand"></i></div>\n    <div data-ng-click="Set3DImageForFirstClick()" data-ng-if="has3dimages && !hideswitch" class="threeD-btn">\n        <i class="pt pt-icon-cube"></i> 3D\n        <div class="threeTooltip"> This Project has <strong>3D</strong> floor plans.\n            <span>Click to view now!</span>\n        </div>\n    </div>\n</div>\n<div style="display:none">\n    <ul>\n        <li data-ng-repeat="item in ptslides">\n            <img data-ng-if="$index == currentIndex+1" data-ng-src="{{item.largeImage}}" />\n        </li>\n    </ul>\n</div>';
}),define("text!views/directives/common/pt-enquireForm.html",[],function(){return'<div data-ng-if="stage === \'step1\'" >\n  <div pt-lead city-enabled="cityEnabled" locality-enabled="localityEnabled" is-modal="isModal" initial="initial" redirect-to="redirectTo"></div>\n  <span class="btnfrgallery" data-ng-click="closeform()">No Thanks</span>\n</div>\n<div data-ng-if="stage === \'step2\'">\n  <div pt-leadVerification lead="leadData"></div>\n</div>\n<div data-ng-if="stage === \'step3\'">\n  <div class="enq-crousel-lead-info">\n  		<div class="enq-crousel-mess-info">\n        	<i class="pt pt-icon-check-circle-o"></i>\n            <span class="paddingT5">Thanks for your query, our agent will get back to you shortly</span>\n        </div>\n        <div class="enq-crousel-link-info text-right clear"><a data-ng-click="closeform()">Dismiss</a></div>\n  </div>		\n  <div class="enq-form-info">\n    <div class="contentHeader">\n      <span class="contSubHeadViewInfo">Thank you for your interest</span>\n    </div>\n    <p> One of our executives will get back to you shortly.</p>\n    <p> \n      <span class="font-weight displayBlock paddingB10 paddingT40">Till then you can</span>\n      <a href="/portfolio/index" data-ng-if="loggedIn"> Make your personalised portfolio </a>\n      <a href="" data-ng-click="openSignIn()" data-ng-if="!loggedIn"> Make your personalised portfolio </a> <br />\n      <a href="/guide" target="_self"> Checkout our PropGuide </a> <br />\n      <a href="https://play.google.com/store/apps/details?id=com.proptiger"> Download our Mobile App </a>\n    </p>   \n  </div>\n</div>\n<div data-ng-if="stage === \'step4\'">\n  <div class="enq-form-info">\n    <div class="contentHeader">\n      <span class="contSubHeadViewInfo">You have already enquired for this project</span>\n    </div>\n    <p> One of our executives will get back to you shortly.</p>\n    <p> \n    	<span class="font-weight displayBlock paddingB10 paddingT30">Till then you can</span>\n    	<a href="/portfolio/index" data-ng-if="loggedIn"> Make your personalised portfolio </a>\n      <a href="" data-ng-click="openSignIn()" data-ng-if="!loggedIn"> Make your personalised portfolio </a> <br />\n      <a href="/guide" target="_self"> Checkout our PropGuide </a> <br />\n      <a href="https://play.google.com/store/apps/details?id=com.proptiger"> Download our Mobile App </a>\n    </p>   \n  </div>\n</div>\n\n<div data-ng-if="stage === \'step5\'">\n    <div pt-leadforwardflow lead="leadData" displaythanks="displaythanks"></div>\n</div>\n'}),define("text!views/directives/common/pt-lead.html",[],function(){return'<div class="row-full">\n<form name="enqForm" class="lead-form" id="enquiry-form" novalidate>\n    <div class="enq-form-info">\n        <div class="formHeader">\n            <span class="formSubHeadInfo" data-ng-bind-html="formTitle"></span>\n        </div>\n        <!-- <p data-ng-if="formData && formData.interested" data-ng-bind-html="formData.interested"> </p> -->\n        <div class="formFieldArea form-info">\n            <!--div class="formRow" data-ng-class="{error:(isSubmitted && (enqForm.fullname.$error.required || enqForm.fullname.$error.name))}">\n      <input type="text" name="fullname" pt-namevalid pt-required id="fullname" data-ng-model="formData.name" placeholder="{{placeholder.FULL_NAME}}" />\n      <span data-ng-show="enqForm.fullname.$error.required && isSubmitted" class="error-info" > Name is required </span>\n      <span data-ng-show="enqForm.fullname.$error.name && isSubmitted && !enqForm.fullname.$error.required" class="error-info" > Name is invalid </span>\n    </div-->\n            <div class="formRow" data-ng-class="{error:((enqForm.email.$error.required || enqForm.email.$error.email) && isSubmitted)}">\n                <input type="text" name="email" id="email" pt-emailvalid pt-required data-ng-model="formData.email" placeholder="{{placeholder.EMAIL}}" />\n                <span data-ng-show="enqForm.email.$error.required && isSubmitted" class="error-info"> Email is required </span>\n                <span data-ng-show="enqForm.email.$error.email && isSubmitted && !enqForm.email.$error.required" class="error-info"> Email is invalid </span>\n            </div>\n            <!-- <div class="formRow" data-ng-if="cityEnabled" data-ng-class="{error:(enqForm.city.$error.required && isSubmitted)}">\n                <select name="city" data-ng-disabled="(cityList && cityList.length === 0)" data-ng-model="formData.city" pt-required data-ng-options="c.label for c in cityList">\n                    <option value=""> City </option>\n                </select>\n                <span data-ng-show="enqForm.city.$error.required && isSubmitted" class="error-info"> City is required </span>\n            </div> -->\n            <div class="formRow" data-ng-if="localityEnabled" data-ng-class="{error:(enqForm.locality.$error.required && isSubmitted)}">\n                <select name="locality" data-ng-model="formData.locality" data-ng-disabled="(localityList && localityList.length === 0)" pt-required data-ng-options="l.label for l in localityList">\n                    <option value=""> Locality </option>\n                </select>\n                <span data-ng-show="enqForm.locality.$error.required && isSubmitted" class="error-info"> Locality is required </span>\n            </div>\n            <div class="formRow">\n                <div class="leadleftColInfo formAutoRow" data-ng-disabled="!countryList" data-ng-class="{error:((enqForm.country.$error.required || enqForm.country.$error.country) && isSubmitted)}">\n                    <select name="country" data-ng-model="formData.country" data-ng-disabled="(countryList && countryList.length === 0)" pt-countryvalid pt-required data-ng-change="updateCountryCode(formData.country)" data-ng-options="c.name for c in countryList">\n                        <option value=""> Country </option>\n                    </select>\n                    <span data-ng-show="(enqForm.country.$error.required || enqForm.country.$error.country) && isSubmitted" class="error-info"> Country is required </span>\n                </div>\n                <div class="leadRightColInfo formAutoRow" data-ng-class="{error:((enqForm.mobile.$error.required || enqForm.mobile.$error.mobile) && isSubmitted)}">\n                    <span class="contCodeInfo" data-ng-if="formData.country.code">{{formData.country.code}}</span>\n                    <input type="text" name="mobile" id="mobile" data-ng-model="formData.mobile" data-country="{{ formData.country | getName }}" placeholder="{{placeholder.MOBILE}}" pt-mobilevalid pt-required class="input-mobile" />\n                    <span data-ng-show="enqForm.mobile.$error.required && isSubmitted" class="error-info"> Contact is required </span>\n                    <span data-ng-show="enqForm.mobile.$error.mobile && isSubmitted && !enqForm.mobile.$error.required" class="error-info"> Contact is invalid </span>\n                </div>\n            </div>\n            <div data-ng-class="{error:(enqForm.query.$error.required && isSubmitted), formAutoRow: contactPage}">\n                <input type="hidden" name="query" data-ng-model="formData.query" data-ng-if="!contactPage" />\n                <textarea name="query" class="formTextareaInfo" data-ng-model="formData.query" data-ng-if="contactPage" style="width: 100%;" placeholder="Enter your message here" pt-required></textarea>\n                <span data-ng-show="enqForm.query.$error.required && isSubmitted" class="error-info"> Message is required </span>\n            </div>\n            <div class="formRow marginT10">\n                <button class="btn-action" data-ng-click="save(formData)" data-ng-disabled="isSaving" data-ng-show="!isSaving">\n                    <i class="pt pt-icon-phone paddingR5"></i> Get Call Back\n                </button>\n                <button class="btn-action disabled" data-ng-show="isSaving">\n                    Please wait...\n                </button>\n            </div>\n        </div>\n    </div>\n</form>\n<div class="promLeadInfo">\n    <div class="promHeadInfo">Our Promise </div>\n    <ul class="promLeadListInfo">\n        <li>\n            <span class="promCirInfo">\n                <i class="pt pt-icon-stamp"></i>\n            </span>\n            <span class="promLeadListTextInfo">Best Price</span>\n        </li>\n        <li>\n            <span class="promCirInfo">\n                <i class="pt pt-icon-Sec-o"></i>\n            </span>\n            <span class="promLeadListTextInfo">Assured Privacy</span>\n        </li>\n        <li>\n            <span class="promCirInfo">\n                <i class="pt pt-icon-car-o"></i>\n            </span>\n            <span class="promLeadListTextInfo">Free Site Visit</span>\n        </li>\n        <li>\n            <span class="promCirInfo">\n                <i class="pt pt-icon-Mai-o"></i>\n            </span>\n            <span class="promLeadListTextInfo">Expert consultation</span>\n        </li>\n    </ul>\n\n</div>\n<div class="formTermsInfo"> \n  *<span class="cursorPointer seoLink" data-ng-click="clickOnTnc(); $root.redirectToPage(\'/disclaimer\',\'blank\');">Terms</span> & <span class="cursorPointer seoLink" data-ng-click="clickOnTnc(); $root.redirectToPage(\'/privacy-policy\',\'blank\');">Privacy</span>\n</div>\n\n\n<!--div class="formListViewInfo">\n  <ul class="formListContInfo">\n    <li><i class="pt pt-icon-circle"></i> Free site visit</li>\n    <li data-ng-if="totalCount"><i class="pt pt-icon-circle"></i> Over <span>{{totalCount | number}}</span> projects to choose from <span class="formListCityName" data-ng-if="formData.city">in {{formData.city}}</span></li>\n  </ul>\n</div>\n\n<div class="formTermsInfo"> We do not share your information.  \n  For more details, read our <span class="cursorPointer seoLink" data-ng-click="$root.redirectToPage(\'/privacy-policy\',\'blank\')">privacy policy</span><br /> \n  *<span class="cursorPointer seoLink" data-ng-click="$root.redirectToPage(\'/disclaimer\',\'blank\')">Terms & conditions</span> applied\n\n</div-->\n\n\n</div>'}),define("services/leadService",["app","services/globalService","directives/common/pt-enquireForm"],function(a){a.factory("LeadService",["$rootScope","$modal","GlobalService","$http",function(a,b,c,d){var e=function(a,b){a.title="Interested in this project?";var c="",d=[];if(a.propertyDetail&&(a.propertyDetail.unitName?d=a.propertyDetail.unitName.split("+"):a.propertyDetail.property&&a.propertyDetail.property.unitName&&(d=a.propertyDetail.property.unitName.split("+")),c="undefined"!=typeof d?d[0]:""),a.projectName?(a.interested='Thanks for showing your interest in <span class="font-weight">'+a.projectName+"</span>.",b?c?a.title='Interested in <span class="font-weight">'+c+" of "+a.projectName+"</span>?":a.title='Interested in <span class="font-weight">'+a.builderName+" "+a.projectName+"</span>?":a.title='Interested in <span class="font-weight">'+a.projectName+"</span>?"):a.areaName?(a.interested='Thanks for showing your interest in <span class="font-weight">'+a.areaName+"</span>.",a.title='Interested in <span class="font-weight">'+a.areaName+"</span>?"):a.cityLabel?(a.interested='Thanks for showing your interest in <span class="font-weight">'+a.cityLabel+"</span>.",a.title='Interested in <span class="font-weight">'+a.cityLabel+"</span>?"):(a.interested="Thanks for showing your interest",a.homePage&&(a.title="Interested in a property?")),a.interested="Please fill in your details below and we will get in touch with you shortly",a.type){var e="",f="",g="";a.propertyDetail&&(e=a.propertyDetail.unitName?a.propertyDetail.unitName:"",f=e+",",g=a.propertyDetail.size?a.propertyDetail.size+" "+a.propertyDetail.measure+", ":""),"floorPlan"===a.type?(a.query="Please send me floor plan of "+f+a.builderName+", "+a.projectName,b&&(c?a.title="Interested in floor plan of "+c+" - "+a.projectName:a.title="Interested in floor plan of "+a.builderName+", "+a.projectName+" ?")):"moreInfo"===a.type?(a.query="Please send me more information of "+f+a.builderName+", "+a.projectName,b&&(e?a.title="Interested to know more about "+e+"?":a.title="Interested to know more about "+a.builderName+", "+a.projectName+" ?")):"size"===a.type?(a.query="Please arrange callback for me about "+f+g+a.builderName+", "+a.projectName,c?a.title="Interested in size of "+c+" - "+a.projectName+"?":a.title="Interested in the size of this project?"):"newPrice"===a.type||"resalePrice"===a.type?(a.query="Please send me price list of "+f+g+a.builderName+", "+a.projectName,c?a.title="Interested in price of "+c+" - "+a.projectName+"?":a.title="Interested in this price list?"):"homeloan"===a.type?(a.title="Interested in taking a homeloan?",a.homeloan_flag="true",a.query="I am interested in taking a homeloan for "+f+a.builderName+", "+a.projectName):"locality-city"===a.type?b||(a.title="Interested in a property?",a.query="I am interested in {locality}, {city}. Please arrange a callback for me."):"home-page"===a.type?(a.title="Interested in a property?",a.query="I am interested in {locality}, {city}. Please arrange a callback for me."):"contactus"===a.type?(a.title="Want a call back?",a.query="I am interested in {locality}, {city}. Please arrange a callback for me."):"my-account"===a.type?(a.title="Interested in a property?",a.query="I am interested in buying a property in {city}. Please arrange a callback for me."):"promise-project"===a.type?(a.title="Let us help you",a.interested="Leave your contact details below and receive a call back at the earliest",a.query="I am interested in {locality}, {city}. Please arrange a callback for me."):"promise-listing"===a.type?(a.title="Let’s save some time",a.interested="Just tell us where to reach you and we shall take care of the rest",a.query="I am interested in {locality}, {city}. Please arrange a callback for me."):"promise-overview"===a.type&&(a.title="Let’s save some time",a.interested="Just tell us where to reach you and we shall take care of the rest",a.query="I am interested in {locality}, {city}. Please arrange a callback for me.")}else if(a.projectName){var h="";a.propertyDetail&&(h=a.propertyDetail.punitName?a.propertyDetail.punitName+", ":""),a.query="Please arrange callback for me about "+h+a.builderName+", "+a.projectName}else a.areaName&&(a.title="Interested in a property?",a.query="I am interested in "+a.areaName+". Please arrange a callback for me.");return a},f=function(a,b){var d=c.getCookie("enquiry_info");d&&d.length&&'"'==d[0]&&'"'==d[d.length-1]&&(d=JSON.parse(d)),d=JSON.parse(d);var f=["name","email","phone","country","budget","bhk"];return a&&d&&$.each(f,function(b,c){d[c]&&(a[c]=decodeURIComponent(d[c]))}),a=e(a,b)},g=function(a,b,c){var e="data/v1/entity/enquiry/"+a;c&&(e=e+"?otp="+c);var f={"Content-Type":"application/json"};return d({method:"PUT",url:e,data:b,headers:f})},h=function(a,b,c){},i=function(a,c,d){b.open({templateUrl:"views/modal/leadForm.html",controller:["$scope","$rootScope","$modalInstance",function(b,e,f){b.cityEnabled=c?!0:!1,b.localityEnabled=d?!0:!1,b.myData=a,b.isModal=!0,b.step={},b.step.stage="step1";var g=function(a){angular.element("div").hasClass("pt-advice")?a?(h("enquiry","clicked","step2-personlisation-close"),h("enquiry","viewed","step3-morelinks")):(h("enquiry","clicked","step3-personlisation-close"),h("enquiry","viewed","step4-morelinks")):(h("enquiry","clicked","step2-OTPVerfication-close"),h("enquiry","viewed","step3-morelinks"))},i=function(a,b){a&&b?h("enquiry","clicked","step2-morelinks-close"):h("enquiry","clicked","step3-morelinks-close")};b.$on("leadposted",function(a,c){b.cancel=function(){"step2"===b.step.stage?(g(c.isOtpVerified),b.step.stage="step5"):"step3"===b.step.stage||"step5"===b.step.stage?(i(c.isOtpVerified,c.isPersonalAdviceFormFill),"step3"===b.step.stage&&(b.step.stage="step5"),f.dismiss("cancel")):f.dismiss("cancel")}}),b.$on("leadpushed",function(a,b){a.stopPropagation()})}],backdrop:"static"}),j(a,"show","Opened")},j=function(b,c,d){var e=f(b),g={},h="";h=e.email?"yes":"no",g["Form Name"]=h+"-"+e.formlocationinfo,g["Page Name"]=a.CURRENT_ACTIVE_PAGE,g["Lead Type"]=e.leadType};return{updateLeadData:f,openLeadForm:i,enquiryTracking:j,updateLeadByPUT:g}}])}),define("validators/leadValidators",["app"],function(a){a.directive("ptMobilevalid",[function(){return{require:"ngModel",link:function(a,b,c,d){var e=function(a,b){var c=/^\+{0,1}[0-9- ]+$/;if(!c.test(a))return!1;var d=a[0];return a=a.match(/[0-9]+?/g).join(""),a=a.replace(/^[0]+/g,""),"india"===b.trim().toLowerCase()?"91"===a.substring(0,2)&&12===a.length?a.substring(2,12):10==a.length&&-1!==["7","8","9"].indexOf(d)?a:!1:(a.length<6||a.length>15)&&"+"==d?!1:a.length<6||a.length>12&&"+"!==d?!1:-1===_.indexOf(_.range(1,10),parseInt(d))?!1:a};d.$parsers.unshift(function(a){var b=e(a,c.country);return b?(d.$setValidity("mobile",!0),b&&b.trim()):(d.$setValidity("mobile",!1),a&&a.trim())})}}}]),a.directive("ptEmailvalid",["CommonValidators",function(a){return{require:"ngModel",link:function(b,c,d,e){e.$parsers.unshift(function(b){return a.isEmail(b)?(e.$setValidity("email",!0),b&&b.trim()):(e.$setValidity("email",!1),b&&b.trim())})}}}]),a.directive("ptNamevalid",["CommonValidators",function(a){return{require:"ngModel",link:function(b,c,d,e){e.$parsers.unshift(function(b){return a.isName(b)||0==b.length?(e.$setValidity("name",!0),b&&b.trim()):(e.$setValidity("name",!1),b&&b.trim())})}}}]),a.directive("ptIntegervalid",["CommonValidators",function(a){return{require:"ngModel",link:function(b,c,d,e){e.$parsers.unshift(function(b){return a.isInteger(b)||0==b.length?(e.$setValidity("integer",!0),parseInt(b)):(e.$setValidity("integer",!1),b)})}}}]),a.directive("ptRequired",["CommonValidators",function(a){return{require:"ngModel",link:function(a,b,c,d){a.$watch(c.ngModel,function(a){a&&"string"==typeof a&&a.trim()?d.$setValidity("required",!0):a&&"string"!=typeof a?d.$setValidity("required",!0):d.$setValidity("required",!1)})}}}]),a.directive("ptCountryvalid",["CommonValidators",function(a){return{require:"ngModel",link:function(b,c,d,e){e.$parsers.unshift(function(b){return b&&a.isCountry(b.name)?(e.$setValidity("country",!0),b):(e.$setValidity("country",!1),b)})}}}])}),define("directives/common/pt-lead",["app","text!views/directives/common/pt-lead.html","services/globalService","services/citiesService","services/localityService","services/userService","services/notificationService","services/leadService","services/projectService","validators/commonValidators","validators/leadValidators"],function(a,b){a.filter("getName",function(){return function(a){return a?a.name:""}}),a.directive("ptLead",["LocalityService","CityService","GlobalService","UserService","NotificationService","LeadService","CommonValidators","$http","$timeout","ProjectService",function(a,c,d,e,f,g,h,i,j,k){return{restrict:"A",template:b,scope:{initial:"=",cityEnabled:"=",localityEnabled:"=",redirectTo:"=",isModal:"="},controller:["$scope","$rootScope","$location","$cookies","dateFilter",function(a,b,e,f,i){a.placeholder={FULL_NAME:"Full Name",EMAIL:"Email Address",MOBILE:"Mobile No."},a.isSubmitted=!1,a.contactPage="/contactus"==e.path();var j,k,l=["name","email","phone","country","query","projectId","projectName","cityId","cityName","localityId","ui_flag","ui_page","ui_php","ui_source","budget_flag","city","homeloan_flag","buy_howlong","locality","multiplePid","extra_bedrooms","extra_propertyType","ui_typeid","formlocationinfo","buy_sell","suburbId","interested","leadType","budget","bhk","propertyDetail","type"],m=!1,n={};a.currentDate=i(new Date,"yyyy-MM-dd HH:mm:ss"),a.$watch(function(){return b.totalProjects},function(b){a.totalCount=b},!0),a.$watch("initial",function(f){if(f){f.title&&(a.formTitle=f.title),!f.type||"locality-city"!==f.type&&"home-page"!==f.type&&"promise"!==f.type.split("-")[0].toLowerCase()||(m=!0),_.map(l,function(b){n[b]=a.initial[b]||""}),b.urlData&&b.urlData.pageType&&!n.ui_page?-1!==e.path().search("maps")?n.ui_page="MAP-"+b.urlData.pageType.toUpperCase():n.ui_page=b.urlData.pageType:n.ui_page||(n.ui_page="MAP-SALE-LISTING-CITY"),a.contactPage&&(n.query=""),a.formData={name:n.name.replace(/\+/g," ")||"",email:n.email||"",country_id:n.country||"1",city:n.cityName||"",city_id:n.cityId||"",localityName:n.locality||"",locality_id:n.localityId||"",suburb_id:n.suburbId||"",mobile:n.phone||"",project_id:n.projectId||"",query:n.query||"",interested:n.interested||"",leadType:n.leadType||"",budget:n.budget||"",bhk:n.bhk||"",propertyId:n.propertyDetail.propertyId||"",listingId:n.propertyDetail.listingId||""},a.localityList=[],c.getCountry().then(function(b){var c;if(a.countryList=b,a.formData.country_id&&parseInt(a.formData.country_id,10)){var d;for(c in a.countryList)d=a.countryList[c],parseInt(d.id,10)===parseInt(a.formData.country_id,10)&&(a.formData.country=d)}}),a.updateCountryCode=function(b){a.formData.country.code=b.code},a.clickOnTnc=function(){},a.save=function(b){if(a.enqForm.$valid){if(k={},_.map(l,function(a){n[a]&&(k["lead_"+a]=n[a])}),k.lead_name=b.name,k.lead_email=b.email,k.lead_cityName=b.city,k.lead_cityId=b.city_id,k.lead_locality=b.localityName,k.lead_localityId=b.locality_id,k.lead_phone=b.mobile,k.lead_country=b.country.id,k.lead_query=b.query?b.query:n.query,k.formlocationinfo=n.formlocationinfo,n.propertyDetail.resaleURL&&"undefined"!=typeof n.propertyDetail.resaleURL?k.listingId=n.propertyDetail.id:n.propertyDetail.listingId?k.listingId=n.propertyDetail.listingId:k.propertyId=n.propertyDetail.propertyId,m){if(k.lead_query.indexOf("{locality}")>-1){var c=k.lead_locality||"";c?k.lead_query=k.lead_query.replace("{locality}",c):k.lead_query=k.lead_query.replace("{locality}, ",c)}k.lead_query.indexOf("{city}")>-1&&(k.lead_query=k.lead_query.replace("{city}",k.lead_cityName))}j=d.isLoggedIn(),a.isSaving=!0;var e={};e.name=k.lead_name,e.email=k.lead_email,e.cityName=k.lead_cityName,e.cityId=k.lead_cityId,e.localityName=k.lead_locality,e.localityId=k.lead_localityId,e.projectId=k.lead_projectId,e.phone=k.lead_phone,e.countryId=k.lead_country,e.query=k.lead_query,e.formName=k.formlocationinfo,e.pageName=k.lead_ui_page,e.pageUrl=k.lead_ui_php,e.sendOtp=!0,k.listingId&&"undefined"!=typeof k.listingId?e.listingId=k.listingId:e.propertyId=k.propertyId,"homeloan"===k.lead_type&&(e.salesType=k.lead_type);var f="data/v1/entity/enquiry?lastEnquiryRequired=true",h=JSON.stringify(e),i="application/json";d.makePostCall(f,h,i,!0,!0,!0).then(function(a){if(a!==!1){var b=a.data;o(b)}},function(){a.isSaving=!1})}else a.isSubmitted=!0,g.enquiryTracking(n,"submitErr","Errors")};var h=!1;a.enqformFill=function(){h!==!0&&(h=!0,g.enquiryTracking(n,"filled","Initiated"))}}}),a.$watch(function(){return b.userDetails},function(b,c){if(!_.isEmpty(b)){var e=d.getHomeCity(),f={name:b.USERNAME.replace(/\+/g," ")||"",email:b.EMAIL||"",country_id:b.COUNTRY_ID||"0",mobile:b.CONTACT||""};if(e&&e.id&&(f.city_id=e.id),$.extend(!0,a.formData,f),a.formData.country_id&&parseInt(a.formData.country_id,10)){var g;for(var h in a.countryList)g=a.countryList[h],parseInt(g.id,10)===parseInt(a.formData.country_id,10)&&(a.formData.country=g)}}});var o=function(c){if("success"===c.status||"2XX"===c.statusCode){var e=d.isLoggedIn()?b.userDetails.EMAIL:k.lead_email,f=d.isLoggedIn()?b.userDetails.id:"";if("undefined"!=typeof mixpanel){var i=mixpanel.get_distinct_id();h.isEmail(i)?mixpanel.identify(e):(mixpanel.alias(e),mixpanel.register({distinct_id:e})),mixpanel.people.set({"USER ID":f,Mobile:k.lead_phone,$name:k.lead_name,$email:e,$last_login:a.currentDate}),"undefined"!=typeof mixpanel&&mixpanel.people.increment("Enquiry Submitted")}g.enquiryTracking(n,"submit","Submitted"),c.data.tracking&&angular.element("#LeadConversionTracking").trigger("click"),"undefined"!=typeof _taq&&window._taq.events.push(["leadSubmitted"+b.CURRENT_ACTIVE_PAGE,{url:window.location.href}]);var j={name:k.lead_name,email:k.lead_email,phone:k.lead_phone,country:k.lead_country,budget:k.lead_budget,bhk:k.lead_bhk};a.isSaving=!1,a.formData.isModal=a.isModal,d.setCookie("enquiry_info",JSON.stringify(j));var l="undefined"!=typeof c.data.lastEnquiry&&c.data.lastEnquiry.enquiryAttributes.length>0?!0:!1,m={enquiryid:c.data.enquiryIds[0],isOtpVerified:c.data.isOtpVerified,ppc:c.data.ppc.toString().toUpperCase(),status:c.data.status,userId:c.data.userId,leadData:a.formData,isPersonalAdviceFormFill:l};a.$emit("leadposted",m)}else a.isSaving=!1,a.isSubmitted=!0,g.enquiryTracking(n,"submitErr","Errors")};a.$on("leadAfterCaptcha",function(a,b){o(b.data)})}]}}])}),define("text!views/directives/common/pt-leadVerification.html",[],function(){return'<div class="row-full">\n   <div class="formTopMessInfo success" ng-if="ShowThanksOnAdviceForm && display.message.success && !numberVerified">\n      <span><i class="pt pt-icon-thumbs-up"></i>{{display.message.success}}</span>\n   </div>\n   <div class="formTopVerInfo" ng-if="numberVerified && showAdviceFormFlag">\n      <div><i class="pt pt-icon-mobile"></i><i class="pt pt-icon-check-square-o"></i>\n         <span>{{mobile}} is verified with us</span>\n      </div>\n   </div>\n   <div class="formMobiNumInfo">\n      <div class="formMobiContInfo row-full" data-ng-show="showVerificationFormFlag">\n         <div class="formVeriHeadInfo">Verify Number</div>\n         <div class="formVeriSubHeadInfo paddingT10">To get callback on priority, verify {{mobile}} using OTP sent to you via SMS</div>\n         <div class="row enq-form-info formMobiFormInfo">\n            <div class="formMobiRow">\n               <div class="col-lg-5 col-md-5 col-sm-5 relativePostion" ng-form name=\'otpform\'>\n                  <div class="row-full" data-ng-class="{\'error\': !otpform.$valid || wrongOtp}" data-ng-click="stopPropagating($event);">\n                     <input type="text" name="otp" data-ng-model="otp" pt-integervalid data-ng-focus="otpSubmit=true" ng-maxlength="4" data-ng-disabled="numberVerified" placeholder="{{placeholder.OTP}}"/>\n                     <div class="optConFirmInfo" data-ng-if="otpSubmit">\n                        <div class="optConBoxInfo pull-left" data-ng-click="verifyOTP();" data-ng-class="{\'disabled\':form.$invalid && form.otp.length}"><i class="pt pt-icon-check"></i></div>\n                        <div class="optConBoxInfo pull-left" data-ng-click="cancelOTP();"><i class="pt pt-icon-times"></i></div>\n                     </div>\n                  </div>\n                  <div class="otpContInfo paddingT5" data-ng-if="!numberVerified">\n                     Did not get SMS? <a data-ng-click="sendOtp();">click here</a> to Resend\n                  </div>\n               </div>\n               <div class="col-lg-5 col-md-5 col-sm-5 col-lg-offset-2 col-md-offset-2 col-sm-offset-2" ng-form name="form">\n                  <div class="editNumBoxInfo" data-ng-class="{\'error\': !form.$valid && mobileEditable}" data-ng-click="stopPropagating($event);">\n                     <input name="mobile" type="text" data-ng-model="mobile" data-country="{{formData.countryName}}" pt-mobilevalid pt-required data-ng-disabled="!mobileEditable" />\n                     <span data-ng-show="form.mobile.$error.required" class="error-info"> Contact is required </span>\n                     <span data-ng-show="form.mobile.$error.mobile  && !form.mobile.$error.required && isSubmitted" class="error-info"> Contact is invalid </span>\n                     <div data-ng-click="enableEditing();" class="editBtnInfo"><i class="pt pt-icon-pencil"></i></div>\n                     <div class="optConFirmInfo" data-ng-if="mobileEditable">\n                        <div class="optConBoxInfo pull-left" data-ng-click="updateNumber();"><i class="pt pt-icon-check"></i></div>\n                        <div class="optConBoxInfo pull-left" data-ng-click="cancelNumber();">\n                           <i class="pt pt-icon-times"></i>\n                        </div>\n                     </div>\n                  </div>\n                  <div class="successInfo paddingT3" data-ng-show="numberVerified">Verified</div>\n                  <div class="notSuccessInfo paddingT3" data-ng-show="!numberVerified">Not Verified</div>\n                  <div class="otpSendMessInfo paddingT3" data-ng-show="otpSent">We have sent an OTP.</div>\n               </div>\n            </div>\n         </div>\n         <div class="text-right">\n             <a data-ng-click="skipMobileVerificationForm()">Skip &raquo;</a>\n         </div>\n      </div>\n      <!-- Number verified -->\n      <div class="formMobiReqContInfo row-full" data-ng-show=\'showAdviceFormFlag\'>\n         <div class="formVeriHeadInfo">Yes, Give Me Personalised Advice</div>\n         <div class="formVeriSubHeadInfo"></div>\n         <div class="row enq-form-info formMobiFormInfo" name=\'detailsform\' ng-form>\n            <div class="formMobiRow">\n               <div class="col-lg-6 col-md-6 col-sm-6">\n                  <div class="row-full" data-ng-class="{\'error\': detailsform.name.$invalid && formData.name.length}">\n                     <input type="text" name=\'name\' data-ng-model="formData.name" pt-namevalid  placeholder="{{placeholder.FULL_NAME}}" />\n                  </div>\n               </div>\n               <div class="col-lg-6 col-md-6 col-sm-6">\n                  <div class="formMobTwoColumn" data-ng-class="{\'error\': detailsform.budget.$invalid && formData.budget.length}">\n                     <input type="text" name="budget" pt-integervalid data-ng-model="formData.budget" placeholder="{{placeholder.BUDGET}}" />\n                  </div>\n                  <div class="formMobTwoColumn">\n                     <select data-ng-model="formData.unit" data-ng-options="unit for unit in display.units">\n                     </select>\n                  </div>\n               </div>\n            </div>\n            <div class="formMobiRow">\n               <div class="col-lg-6 col-md-6 col-sm-6">\n                  <label>BHK</label>\n                  <div class="btn-group filter-checkbox row-full marginB20">\n                     <button type="button" class="btn" data-ng-click="apartmentSize(key)" data-ng-class="{\'active\':display.sizes[key].active}" ng-repeat="(key,value) in display.sizes">\n                     {{key}}\n                     </button>\n                  </div>\n                  \n                  <label>PURPOSE</label>\n                <div class="btn-group filter-checkbox row-full">\n                   <button type="button" name=\'purpose\' class="btn handler0 pth" data-ng-click="purchaseFor(\'SELF_USE\', 0)">SELF USE</button>\n                   <button type="button" name=\'purpose\' class="btn handler1 pth" data-ng-click="purchaseFor(\'INVESTMENT\', 1)">INVESTMENT</button>  \n                </div>\n\n               </div>\n               <div class="col-lg-6 col-md-6 col-sm-6">\n                  <div tag-manager filterdata="localityList" locality="formData.locality" data-ng-if="formData.locality_id !==\'\'"></div>\n                  <label>&nbsp;</label>\n                  <select data-ng-model="formData.city" data-ng-disabled="(cityList && cityList.length === 0)" data-ng-options="c.label for c in cityList" data-ng-if="formData.locality_id===\'\'">\n                     <option value="">City</option>\n                  </select>\n               </div>\n            </div>\n            <div class="formMobiRow paddingT15">\n               <div class="col-lg-12 col-md-12 col-sm-12">\n                  <div class="instPropOpInfo pull-left">I am interested in similar properties ?</div>\n                  <div class="checkboxInfo pull-left paddingL20 paddingT3" data-ng-if="!formData.project_id">\n                     <span class="checkIconInfo">\n                     <input type="checkbox" data-ng-model="formData.needNew" data-ng-true-value="primary"/>\n                     </span>\n                     <label>From Builder</label>\n                  </div>\n                  <div class="checkboxInfo pull-left paddingL20 paddingT3" data-ng-if="!formData.project_id">\n                     <span class="checkIconInfo">\n                     <input type="checkbox" data-ng-model="formData.needResale" data-ng-true-value="resale"/>\n                     </span>\n                     <label>In Resale</label>\n                  </div>\n                  <div class="checkboxInfo pull-left paddingL20 paddingT3" data-ng-if="formData.project_id">\n                     <span class="checkIconInfo">\n                     <input type="checkbox" data-ng-model="formData.similarProject"/>\n                     </span>\n                  </div>\n               </div>\n            </div>\n            <div class="formMobiRow paddingT15">\n               <div class="col-lg-12 col-md-12 col-sm-12">\n                  <button class="btn-action" data-ng-click=\'saveData()\' ng-class="{\'disabled\': enableSubmit()}">\n                  <i class="pt pt-icon-phone"></i> Get ME MY NEW HOME\n                  </button>\n               </div>\n               <div class="col-lg-12 col-md-12 col-sm-12 text-right paddingT10">\n                  <a data-ng-click="skipPersonalAdviceForm()">Skip &raquo;</a>\n               </div>\n            </div>\n         </div>\n         <div class="pt-advice" data-ng-if="showAdviceFormFlag"></div>\n      </div>\n      <!-- End Number verified -->\n   </div>\n</div>';
}),define("text!views/directives/filters/tagmanager.html",[],function(){return'<div class="row-full">\n    <label>{{filter.label|uppercase}}</label>                               \n    <div class="autoCompleteSearch" tags-input data-ng-model="filter.selected" \n        placeholder="{{filter.placeholder}}"\n        temp-placeholder="{{filter.placeholder}}"\n        replace-spaces-with-dashes="false"                                   \n        add-from-autocomplete-only="true"\n        allowed-tags-pattern = "[a-zA-Z0-9\\.]*"                                \n        max-tags = "6"\n        min-length="2"\n        on-tag-added="update($tag.label)"\n        on-tag-removed="update($tag.label)"\n        >\n        <div auto-complete source="loadData($query)" min-length="2" debounce-delay="0" max-results-to-show="5"></div>\n    </div>\n    <div class="row-full requireText">\n        <strong>Note:</strong> You can add upto 6 {{filter.label}}\n    </div> \n </div>\n                  \n\n                  '}),define("directives/filters/tagmanager",["app","text!views/directives/filters/tagmanager.html"],function(a,b){a.directive("tagManager",["$rootScope","$location",function(a,c){return{restrict:"A",scope:{filterdata:"=",locality:"="},template:b,controller:["$scope",function(a){var b={},c={selected:[],hide:!1,key:"localityOrSuburbLabel",label:"locality",placeholder:"Add a Locality",type:"tag"};a.$watch("locality",function(c){c.label&&(a.filter.selected.push({label:c.label,id:c.id}),b.selectedIds=c.id,a.$emit("tagsUpdationTriggered",b.selectedIds))}),a.filter=c,a.update=function(){c.selected.length?(b.localityOrSuburbLabel=_.pluck(c.selected,"label").join(),b.selectedIds=_.pluck(c.selected,"id").join()):(delete b.localityOrSuburbLabel,delete b.selectedIds),a.getlocalities=b,a.$emit("tagsUpdationTriggered",b.selectedIds)},a.loadData=function(){return a.filterdata}}]}}])}),define("directives/common/pt-leadVerification",["app","text!views/directives/common/pt-leadVerification.html","services/globalService","services/citiesService","services/localityService","services/leadService","services/filterService","validators/commonValidators","validators/leadValidators","directives/filters/tagmanager"],function(a,b){a.directive("ptLeadverification",["LocalityService","CityService","GlobalService","LeadService",function(){return{restrict:"A",template:b,scope:{lead:"="},controller:["$scope","$rootScope","CityService","LocalityService","$q","$timeout","LeadService","GlobalService","FilterService",function(a,b,c,d,e,f,g,h,i){a.formData={},a.display={},a.selectedLocalities={},a.$on("tagsUpdationTriggered",function(b,c){c&&(a.selectedLocalities=c.split(","))}),a.placeholder={FULL_NAME:"Full Name",BUDGET:"Budget",OTP:"OTP [ One Time Password ]"};var j={};_.forEach(i.filters.bed.options,function(a,b){j[a.key]=a.values?a.values:a.key});var k=function(){var b={};return _.forEach(j,function(c,d){if(b[d]={},$.isArray(c)){var e=0;_.forEach(c,function(f,g){-1!==$.inArray(f,m)&&e++,e==c.length?(b[d].active=!0,a.mark=!0):b[d].active=!1})}else b[d].active=-1!==$.inArray(c,m)?!0:!1,a.mark=a.mark?!0:b[d].active;b[d].value=c}),b},l=function(b){if(b){var c=1e5,d=1e7,e=parseInt(1*b/d);return e>0?(a.formData.unit="Crore",e):(a.formData.unit="Lacs",parseInt(1*b/c))}return""};_.extend(a.lead,a.lead),a.formData.mobile=a.lead.mobile,a.formData.locality_id=a.lead.locality_id?a.lead.locality_id:"",a.formData.locality={},a.formData.email=a.lead.email,a.formData.city_id=a.lead.city_id?a.lead.city_id:"",a.formData.city=a.lead.city?a.lead.city.label:"",a.formData.name=a.lead.name?a.lead.name:"",a.formData.budget=l(a.lead.budget),a.formData.project_id=a.lead.project_id?a.lead.project_id:"",a.formData.userEnquiryId=a.lead.enquiryid,a.formData.country=a.lead.country?a.lead.country.id:a.lead.country_id,a.formData.countryName=a.lead.country.name,a.formData.needNew="primary",a.formData.needResale="resale",a.formData.unit=a.formData.unit?a.formData.unit:"Lacs",a.formData.requiredSize=[],a.formData.similarProject=!0,a.userId=a.lead.userId,a.mobileEditable=!1,a.otpSubmit=!1,a.wrongOtp=!1,a.otpSent=!1,a.numberVerified=a.lead.isOtpVerified,a.mobile=a.formData.mobile;var m=a.lead.bhk?a.lead.bhk.split(","):[];a.display.sizes=k(),a.purposeObj=["SELF USE","INVESTMENT"],a.personalAdviceAccepted=a.lead.isPersonalAdviceFormFill;var n=function(a,b,c){};if(a.showVerificationFormFlag=!1,a.showAdviceFormFlag=!1,a.numberVerified&&a.personalAdviceAccepted?a.$emit("leadVerified"):!a.numberVerified&&a.personalAdviceAccepted?(a.showVerificationFormFlag=!0,n("enquiry","viewed","step2-OTPVerfication")):a.numberVerified&&!a.personalAdviceAccepted?(a.showAdviceFormFlag=!0,n("enquiry","viewed","step2-personalisation")):a.numberVerified||a.personalAdviceAccepted?n("enquiry","viewed","step3-personalisation"):(a.showVerificationFormFlag=!0,n("enquiry","viewed","step2-OTPVerfication")),a.purchaseFor=function(b,c){angular.element(".handler"+c).toggleClass("active");var d=[];angular.element(".pth").each(function(){angular.element(this).hasClass("active")&&d.push(angular.element(this).text())}),a.LeadFormPurpose=d},a.ShowThanksOnAdviceForm=!0,a.skipMobileVerificationForm=function(){n("enquiry","clicked","step2-OTPVerfication-skip"),a.showAdviceFormFlag=!1,a.showVerificationFormFlag=!1,a.ShowThanksOnAdviceForm=!1,a.personalAdviceAccepted?(n("enquiry","viewed","step3-morelinks"),a.$emit("leadVerified")):(n("enquiry","viewed","step3-personalisation"),a.showAdviceFormFlag=!0)},a.skipPersonalAdviceForm=function(){a.numberVerified?a.gaFlagOtpVerification?(n("enquiry","clicked","step3-personlisation-skip"),n("enquiry","viewed","step4-morelinks")):(n("enquiry","clicked","step2-personlisation-skip"),n("enquiry","viewed","step3-morelinks")):(n("enquiry","clicked","step3-personlisation-skip"),n("enquiry","viewed","step4-morelinks")),a.$emit("leadVerified")},a.display.units=["Lacs","Crore"],a.display.message={success:"Congrats! You’re one step closer to your dream home.",successOtp:"OTP Sent.",verificationFailed:"OTP Verification Failed"},a.isSubmitted=!1,a.apartmentSize=function(b){a.display.sizes[b].active=!a.display.sizes[b].active,a.detailsform.$setDirty()},""===a.formData.locality_id)c.getMainCities().then(function(b){if(a.cityList=b.data,a.formData.city_id){var c;angular.forEach(a.cityList,function(b){parseInt(b.id,10)==parseInt(a.formData.city_id,10)&&(c=b)}),c&&(a.formData.city=c)}});else{var o,p;d.getLeadFormList(a.formData.city_id).then(function(b){if(a.localityList=b,a.formData.locality_id)for(o in a.localityList)p=a.localityList[o],"object"==typeof p&&p.id.toString()===a.formData.locality_id.toString()&&(a.formData.locality=p)})}var q=function(){a.formData.requiredSize=[],_.each(a.display.sizes,function(b,c){b.active&&($.isArray(b.value)?_.forEach(b.value,function(b,c){a.formData.requiredSize.push(1*b)}):a.formData.requiredSize.push(1*b.value))})},r=function(){return"Lacs"===a.formData.unit?1e5*a.formData.budget:"Crore"===a.formData.unit?1e7*a.formData.budget:void 0},s=function(){var b={name:a.formData.name,email:a.formData.email,phone:a.formData.mobile,country:a.formData.country,budget:r(),bhk:a.formData.requiredSize.length>0?a.formData.requiredSize.join(","):a.bhk};h.setCookie("enquiry_info",JSON.stringify(b))};a.saveData=function(){if(!a.enableSubmit()){var b={};q(),b.name=a.formData.name,b.id=a.formData.userEnquiryId,a.formData.locality_id&&a.formData.locality&&parseInt(a.formData.locality.id)?a.selectedLocalities.length>0?b.localityIds=a.selectedLocalities:b.localityIds=parseInt(a.formData.locality.id):a.formData.locality_id||(b.cityName=a.formData.city.label),parseInt(a.formData.budget)&&(b.leadBudget=r()),b.bhk=a.formData.requiredSize.length?a.formData.requiredSize:[],b.salesTypes=[],a.formData.project_id?b.isInterestedInSimilarProperties=a.formData.similarProject:(a.formData.needResale?b.salesTypes.push(a.formData.needResale):!1,a.formData.needNew?b.salesTypes.push(a.formData.needNew):!1,b.isInterestedInSimilarProperties=!0),"undefined"!=typeof a.LeadFormPurpose&&(b.purpose=a.LeadFormPurpose);var c=[];_.each(b,function(a,b){$.isArray(a)&&a.length>0&&a&&"isInterestedInSimilarProperties"!==b&&"id"!==b?c.push(b):!$.isArray(a)&&a&&"isInterestedInSimilarProperties"!==b&&"id"!==b&&c.push(b)});var d=c.join(", ");b=JSON.stringify(b),a.numberVerified&&!a.personalAdviceAccepted?a.gaFlagOtpVerification?(n("enquiry","clicked","step3-personalisation-getme-"+d),n("enquiry","viewed","step4-morelinks")):(n("enquiry","clicked","step2-personalisation-getme-"+d),n("enquiry","viewed","step3-morelinks")):a.numberVerified||a.personalAdviceAccepted||(n("enquiry","clicked","step3-personalisation-getme-"+d),n("enquiry","viewed","step4-morelinks")),g.updateLeadByPUT(a.formData.userEnquiryId,b).then(function(b){a.$emit("leadVerified",b),s();var c=a.numberVerified?"OTPVerified":"OTPNotVerified";c=a.lead.isOtpVerified?"OTPAlreadyVerified":c},function(){})}},a.sendOtp=function(){n("enquiry","clicked","step2-OTPVerfication-resend");var b={};b.phoneToVerify=a.formData.mobile,b.userId=a.userId,g.updateLeadByPUT(a.formData.userEnquiryId,b).then(function(b){f(function(){a.otpSent=!1},2e3),b.data.data.isOtpVerified?(a.numberVerified=!0,a.personalAdviceAccepted?a.$emit("leadVerified"):a.showAdviceFormFlag=!0,a.showVerificationFormFlag=!1):(a.numberVerified=!1,a.otpSent=!0)},function(){})},a.enableEditing=function(){a.mobileEditable=!0},a.updateNumber=function(){a.isSubmitted=!0,a.form.$valid&&(a.mobileEditable=!1,a.formData.mobile=a.mobile,a.sendOtp(),s())},a.cancelNumber=function(){a.mobileEditable=!1,a.mobile=a.formData.mobile,a.isSubmitted=!1},a.gaFlagOtpVerification=!1,a.verifyOTP=function(){if(a.otpform.$valid){a.otpSubmit=!1;var b={};b.phone=a.formData.mobile,b.userId=a.userId,g.updateLeadByPUT(a.formData.userEnquiryId,b,a.otp).then(function(b){b.data.data.isOtpVerified?(a.numberVerified=!0,a.wrongOtp=!1,a.gaFlagOtpVerification=!0,n("enquiry","clicked","step2-OTPVerfication-OTPVerified"),a.personalAdviceAccepted?(n("enquiry","viewed","step3-morelinks"),a.$emit("leadVerified")):(n("enquiry","viewed","step3-personalisation"),a.showAdviceFormFlag=!0),a.showVerificationFormFlag=!1):a.wrongOtp=!0,a.otp=""},function(){})}},a.cancelOTP=function(){a.otpSubmit=!1,a.otp=""},angular.element(".modal-dialog").on("click",function(){a.cancelOTP(),a.cancelNumber()}),a.stopPropagating=function(a){a.stopPropagation()},a.enableSubmit=function(){return _.forEach(a.display.sizes,function(b,c){b.active&&(a.checkMark=!0)}),a.mark=a.checkMark?!0:!1,a.checkMark=!1,a.detailsform.$valid?a.detailsform.name.$viewValue.length>0||a.detailsform.budget.$viewValue.length>0||a.formData.locality_id&&void 0!==a.formData.locality&&null!==a.formData.locality||!a.formData.locality_id&&void 0!==a.formData.city&&null!==a.formData.city||a.mark?!1:a.detailsform.$pristine?!0:!0:!0}}],link:function(){}}}])}),define("text!views/directives/common/pt-leadforwardflow.html",[],function(){return'<div>\n<div class="formTopLinkVerInfo" ng-if="displaythanks">\n     <div><i class="pt pt-icon-check-circle"></i><span>Thank you. Your requirements are saved with us!</span></div>\n </div>\n<div class="row-full marginT20">\n      <div class="morePropHeadInfo">DON\'T MISS ON THESE</div>\n      <div class="morePropContInfo">\n         <ul class="moreListDescInfo">\n            <li ng-repeat="value in subPageUpperContent">\n               <div class="listContInfo" data-ng-click="GAeventOnMore(displayDataArr[value].name)">\n                   <a data-ng-href= "{{displayDataArr[value].url}}"  target="{{displayDataArr[value].target ? displayDataArr[value].target : \'\'}}">\n                        <img alt="{{displayDataArr[value].name}}" data-ng-src="/styles/images/{{displayDataArr[value].image}}.jpg">\n                        <div class="listProjContInfo">\n                           <span class="listprojdesc">{{displayDataArr[value].text}}</span>\n                        </div>\n                   </a>\n               </div>\n            </li>\n          </ul>\n      </div>\n   </div>\n   <div class="row-full marginT20 slickSlider hide" ng-if="displayProjects">\n      <div class="morePropHeadInfo">Properties You May Also Like</div>\n      <div class="likePropContInfo">\n         <div class="row-full" id="outerCarouselLead">\n            <div class="likePropProjInfo" data-ng-repeat="project in displayProjects">\n               <div class="listContInfo" data-ng-click="GAeventOnMore(\'similarproperties\')">\n                   <a data-ng-href= "{{project.landingUrl}}">\n                        <img alt="{{project.projectName}}" data-ng-src="{{project.imageUrl}}">\n                        <div class="likeProjHeadInfo">{{project.projectName}}</div>\n                        <div class="likelistProjContInfo">\n                           <span class="listprojdesc" ng-if="project.locality">{{project.locality}}</span>\n                           <span class="listprojdesc" ng-if="project.possession">Possession : {{project.possession}}</span>\n                        </div>\n                   </a>\n               </div>\n            </div>\n         </div>\n      </div>\n   </div>\n</div>\n\n'}),define("directives/common/pt-leadforwardflow",["app","text!views/directives/common/pt-leadforwardflow.html","services/citiesService","services/localityService","services/projectService","parsers/projectParser","formatters/common"],function(a,b){a.directive("ptLeadforwardflow",["LocalityService","CityService","ProjectService",function(){return{restrict:"A",template:b,scope:{lead:"=",displaythanks:"="},controller:["$scope","$rootScope","CityService","ProjectService","ProjectParser","Formatter","$timeout",function(a,b,c,d,e,f,g){var h=function(a,b,c){};a.lead.isOtpVerified&&a.lead.isPersonalAdviceFormFill&&h("enquiry","viewed","step2-morelinks"),a.GAeventOnMore=function(b){a.lead.isOtpVerified&&a.lead.isPersonalAdviceFormFill?h("enquiry","clicked","step2-morelinks-"+b):a.lead.isOtpVerified||a.lead.isPersonalAdviceFormFill?a.lead.isOtpVerified&&!a.lead.isPersonalAdviceFormFill?h("enquiry","clicked","step3-morelinks-"+b):!a.lead.isOtpVerified&&a.lead.isPersonalAdviceFormFill&&h("enquiry","clicked","step3-morelinks-"+b):h("enquiry","clicked","step4-morelinks-"+b)},c.getMainCities().then(function(c){var h=_.reject(c.data,function(a){return 1!==a.displayPriority}),i=[];_.each(h,function(a){i.push(a.label)});var j=i.indexOf(f.ucword(b.cityToShow))>-1?b.cityToShow:"bangalore";if("All Cities"===b.cityToShow&&a.lead.project_id)var j=i.indexOf(f.ucword(a.lead.city.toLowerCase()))>-1?a.lead.city.toLowerCase():"bangalore";var k=_.where(h,{label:f.ucword(j)}),l="undefined"!=typeof k?k[0].id:2,m=9,n={projectId:a.lead.project_id?a.lead.project_id:b.urlData.project_id,localityId:a.lead.locality_id?a.lead.locality_id:b.urlData.localityId,cityId:l,cityName:j.toLowerCase(),count:m};a.displayDataArr=[{name:"AppPromotion",image:"lead-app-promo",text:"Mobile APP: Search Properties On The Go",url:"/mobile-apps"},{name:"propGuide",image:"lead-propguide",text:"Propguide: Real Estate Simplified",url:"/guide/",target:"_self"},{name:"HomeLoanGuide",image:"lead-homeloan",text:"Home Loan Info: All About Home Loan",url:"/homeloan"},{name:"LocalityOverview",image:"lead-locality-overview",text:"Locality Info: Know More About Locality",url:"/"+n.cityName+"/all-localities",target:"_self"},{name:"CityOverview",image:"lead-city-overview",text:"City Info: Know More About City",url:"/"+n.cityName+"-real-estate"},{name:"Portfolio",image:"lead-portfolio",text:"Portfolio: Track Property Prices",url:"/property-portfolio-tracker"}];var o=function(){var a=[];return a="undefined"!=typeof b.CURRENT_ACTIVE_PAGE&&(b.CURRENT_ACTIVE_PAGE.indexOf("-listing-")>-1||"map-projectdetail"===b.CURRENT_ACTIVE_PAGE||b.CURRENT_ACTIVE_PAGE.indexOf("-OVERVIEW")>-1)?[0,1,2,3]:_.contains(["projectdetail","property"],b.CURRENT_ACTIVE_PAGE)&&"undefined"!=typeof b.CURRENT_ACTIVE_PAGE?[0,3,2,5]:[0,2,1,4]},p=function(a){g(function(){require(["slickjs"],function(){$("#outerCarouselLead").slick({slidesToShow:3,slidesToScroll:2,lazyLoad:"ondemand",arrows:!0,variableWidth:!0}),angular.element(".slickSlider").removeClass("hide").addClass("show")})});var b=[];return _.each(a,function(a){var c=e.parseProject(a,!0),d={projectName:c.builder.name+" "+c.name,locality:c.locality.label,possession:c.possessionDate,imageUrl:c.imageURL+"?width=360&height=270",landingUrl:c.URL};b.push(d)}),b};if(n.projectId&&"undefined"!=typeof n.projectId)d.getSimilarProjects(n.projectId,!1,4).then(function(b){var c=p(b);a.displayProjects=c});else{if(n.localityId&&"undefined"!=typeof n.localityId&&i.indexOf(f.ucword(b.cityToShow))>-1)var q={filters:{and:[{equal:{localityId:n.localityId}}]},paging:{start:0,rows:m}};else if("undefined"!=typeof n.cityId)var q={filters:{and:[{equal:{cityId:n.cityId}}]},paging:{start:0,rows:m}};d.getProjectList(JSON.stringify(q),void 0,function(b){var c=p(b.data.items);a.displayProjects=c},!1,!1,!0)}a.subPageUpperContent=o()})}]}}])}),define("directives/common/pt-enquireForm",["app","text!views/directives/common/pt-enquireForm.html","services/signupService","directives/common/pt-lead","directives/common/pt-leadVerification","directives/common/pt-leadforwardflow"],function(a,b){a.directive("ptEnquireform",["$timeout","$modal",function(a,c){return{restrict:"A",template:b,scope:{initial:"=",localityEnabled:"=",cityEnabled:"=",redirectTo:"=",isModal:"=",showform:"=",stage:"=?"},link:function(a,b,c){a.$on("$destroy",function(){b.remove()})},controller:["$rootScope","$scope","$http","$document","$window","$compile","GlobalService","LeadService","SignupService",function(b,d,e,f,g,h,i,j,k){d.loggedIn=i.isLoggedIn(),d.leadData={},"step2"===d.stage&&(d.leadData=d.initial),d.closeform=function(){b.$broadcast("closeCarouselLead")},d.localityEnabled=!1;var l=function(a){var b=i.getAPIURL("data/v1/entity/user/enquired?projectId="+a.toString());return e({method:"GET",url:b}).then(function(a){return"2XX"===a.data.statusCode?a.data.data.hasValidEnquiry:!1})},m=function(){d.stage=d.stage?d.stage:"step1"},n=function(a,b,c){};d.$on("leadposted",function(a,b){b&&(b.leadData.isModal?(d.stage="step2",d.leadData=b.leadData,d.leadData.enquiryid=b.enquiryid,d.leadData.isOtpVerified=b.isOtpVerified,d.leadData.isPersonalAdviceFormFill=b.isPersonalAdviceFormFill,d.leadData.status=b.status,d.leadData.userId=b.userId,angular.element(".modal").addClass("formSecViewInfo")):(c.open({templateUrl:"views/modal/leadVerification.html",controller:["$scope","$modalInstance",function(a,c){a.stage="step2",a.leadData=b.leadData,a.leadData.enquiryid=b.enquiryid,a.leadData.status=b.status,a.leadData.isOtpVerified=b.isOtpVerified,a.leadData.isPersonalAdviceFormFill=b.isPersonalAdviceFormFill,a.leadData.userId=b.userId,a.isModal=!1;var d=function(a){angular.element("div").hasClass("pt-advice")?a?(n("enquiry","clicked","step2-personlisation-close"),n("enquiry","viewed","step3-morelinks")):(n("enquiry","clicked","step3-personlisation-close"),n("enquiry","viewed","step4-morelinks")):(n("enquiry","clicked","step2-OTPVerfication-close"),n("enquiry","viewed","step3-morelinks"))},e=function(a,b){a&&b?n("enquiry","clicked","step2-morelinks-close"):n("enquiry","clicked","step3-morelinks-close")};a.cancel=function(){"step2"===a.stage?(d(b.isOtpVerified),a.stage="step5"):"step3"===a.stage||"step5"===a.stage?(e(b.isOtpVerified,b.isPersonalAdviceFormFill),"step3"===a.stage&&(a.stage="step5"),c.dismiss("cancel")):(a.stage="step5",c.dismiss("cancel"))},a.$on("leadpushed",function(a,b){a.stopPropagation()})}],windowClass:"formSecViewInfo",backdrop:"static"}),d.stage="step3"),d.leadData.isOtpVerified&&d.leadData.isPersonalAdviceFormFill&&(d.displaythanks=!0))}),d.$on("leadVerified",function(b,c){d.stage="step5","undefined"!=typeof c&&(d.displaythanks=!0),a(function(){d.$emit("leadpushed",c)},1e4)}),d.showLeadForm=m,d.$watch("initial",function(b){b?(d.initial=j.updateLeadData(b,d.isModal),b.projectId&&i.isLoggedIn()?l(b.projectId).then(function(b){b?(d.stage="step4",a(function(){d.$emit("leadpushed",b)},4e3)):m()}):m()):void 0!==b&&m()}),d.openSignIn=function(){k.openSignUp("/portfolio/index")}}]}}])}),define("text!views/directives/common/pt-property-config-overlay.html",[],function(){return'<div class="panorDetailViewInfo">\n    <ul class="ulTableView">\n        <li class="ulTopHeader">\n            <div class="ulTableColView">TYPE/SIZE</div>\n            <div class="ulTableColView proj3DPlan">3D PLAN</div>\n            <div class="ulTableColView">360 PANORAMA</div>\n        </li>\n        <li class="{{selectedRow[$index]}}" data-ng-repeat="conf in overlayConfig" data-ng-click="SetImage(conf.slideidx, null, null, null, true)">\n            <div class="checkIconInfo" data-ng-click="SetImage(conf.slideidx)">\n                <i class="pt pt-icon-check checkIcon"></i>\n            </div>\n            <div class="ulTableColView projTextAlign" data-ng-click="setImageFloorType(\'2D\', null, true)">\n                <span>{{conf.unitName}}</span>\n                <span class="ulTableSubText" data-ng-if="conf.size">({{conf.size}} {{conf.measure}})</span>\n                <span class="ulTableSubText" data-ng-if="!conf.size && conf.carpetArea">{{conf.carpetArea}} {{conf.measure}} (Carpet Area)</span>\n            </div>\n            <div class="ulTableColView icon3DLink {{iconClassIndex[$index]}}" data-ng-click="setImageFloorType(\'3D\', $index, true)" data-ng-class="{\'disableIcon\' : !conf.floor3dImage }">\n                <i class="pt pt-icon-cube"></i>\n            </div>\n            <div class="ulTableColView iconPanorLink" data-ng-class="{\'disableIcon\' : !conf.panoramaViewPath }" data-ng-click="expandTour(leadData.projectId, conf.panoramaUnit, conf.panoramaViewPath, null, \'name\')">\n                <div class="gallPanorView">\n                    <i class="pt pt-icon-panorama panorIconView"></i>\n                    <span class="panorSubText">360&deg;</span>\n                </div>\n            </div>\n        </li>\n    </ul>\n</div>'}),define("directives/common/pt-property-config-overlay",["app","text!views/directives/common/pt-property-config-overlay.html"],function(a,b){a.directive("ptPropertyConfigOverlay",function(){return{restrict:"A",template:b,controller:[function(){}]}})}),!window.YT)var YT={loading:0,loaded:0};if(!window.YTConfig)var YTConfig={host:"https://www.youtube.com"};YT.loading||(YT.loading=1,function(){var a=[];YT.ready=function(b){YT.loaded?b():a.push(b)},window.onYTReady=function(){YT.loaded=1;for(var b=0;b<a.length;b++)try{a[b]()}catch(c){}},YT.setConfig=function(a){for(var b in a)a.hasOwnProperty(b)&&(YTConfig[b]=a[b])};var b=document.createElement("script");b.id="www-widgetapi-script",b.src="https://s.ytimg.com/yts/jsbin/www-widgetapi-vflkfgkJ8.js",b.async=!0;var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}()),define("youtube",function(a){return function(){var b;return b||a.YT}}(this)),define("directives/common/pt-youtube",["app","youtube"],function(a,b){a.directive("ptYoutube",["$rootScope",function(a){return{restrict:"A",scope:{slideData:"=",autoplay:"=",playerId:"="},template:'<div id="player_{{playerId}}"></div>',link:function(c,d,e){c.start=!1,c.load_player={attr_id:void 0,attr:!1,yt_load:!1},c.$watch(function(){return e.id},function(a,b){a&&(c.load_player.attr_id=a,c.load_player.attr=!0)}),c.$watch(function(){return b.Player},function(a,b){a&&(c.load_player.yt_load=!0)}),c.$watch("load_player",function(a,b){a&&a.attr&&a.yt_load&&(c.player=c.createPlayer(e))},!0),c.createPlayer=function(a){c.player&&c.player.destroy();var d=c.autoplay?1:0;return new b.Player("player_"+c.playerId,{height:a.height,width:a.width,videoId:a.id,playerVars:{autoplay:d,controls:1,frameborder:0,allowfullscreen:1},events:{onReady:c.onPlayerReady,onStateChange:c.onPlayerStateChange,onError:c.onError}})},c.$on("pause_player",function(a,b){c.player&&"portfolio_home_video"==e.$$element.parent()[0].getAttribute("id")&&c.player.pauseVideo()}),c.onPlayerReady=function(a){f("viewed","Video Viewed"),c.start=!0},c.onPlayerStateChange=function(a){if(a.data!=b.PlayerState.PLAYING||c.start||f("play","Video Play"),(c.start||a.data==b.PlayerState.UNSTARTED)&&(f("start","Video Start"),c.start=!1),a.data==b.PlayerState.PAUSED)if("portfolio_home_video"==a.target.a.parentElement.parentElement.getAttribute("id")){var d=(c.player.k.currentTime/c.player.k.duration*100).toFixed();f("pause","Video Paused",d)}else f("pause","Video Paused");a.data==b.PlayerState.ENDED&&(f("end","Video End"),f("played","Video Played",100))},c.onError=function(a){window.console.log("Encountered and ERROR")};var f=function(b,d,e){var g,h={},i="",j="";c.slideData&&c.slideData.objectId&&(i=c.slideData.objectId),c.slideData&&c.slideData.text&&(j=c.slideData.text),"portfolio_home_video"==c.player.a.parentElement.parentElement.getAttribute("id")&&(j="portfolio"),h["Project ID"]=i,h["Video Type"]=j,h["Page Name"]=a.CURRENT_ACTIVE_PAGE,e?(h["Video Played"]=e,g=e+"-"+j+"-"+a.CURRENT_ACTIVE_PAGE):g=j+"-"+a.CURRENT_ACTIVE_PAGE,a.$on("youtubeCollapse",function(){var b=(c.player.k.currentTime/c.player.k.duration*100).toFixed();f("played","Video Played",b),a.$$listeners.youtubeCollapse=[]})}}}}])}),define("text!views/directives/common/pt-playerjw.html",[],function(){return"<div id='playerGVtPteKoWxwx'>Loading</div>"});for(var jwBase64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decode:function(a){if("function"==typeof window.atob)return atob(a);var b,c,d,e,f,g,h,i="",j=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");j<a.length;)e=jwBase64._keyStr.indexOf(a.charAt(j++)),f=jwBase64._keyStr.indexOf(a.charAt(j++)),g=jwBase64._keyStr.indexOf(a.charAt(j++)),h=jwBase64._keyStr.indexOf(a.charAt(j++)),b=e<<2|f>>4,c=(15&f)<<4|g>>2,d=(3&g)<<6|h,i+=String.fromCharCode(b),64!=g&&(i+=String.fromCharCode(c)),64!=h&&(i+=String.fromCharCode(d));return i=jwBase64._utf8_decode(i)},_utf8_decode:function(a){for(var b="",c=0,d=c1=c2=0;c<a.length;)d=a.charCodeAt(c),128>d?(b+=String.fromCharCode(d),c++):d>191&&224>d?(c2=a.charCodeAt(c+1),b+=String.fromCharCode((31&d)<<6|63&c2),c+=2):(c2=a.charCodeAt(c+1),c3=a.charCodeAt(c+2),b+=String.fromCharCode((15&d)<<12|(63&c2)<<6|63&c3),c+=3);return b}},bd=[],i=0;i<bd.length;i++){var bdn=jwBase64.decode(bd[i]);if(""!==bdn&&window.location.hostname.match(RegExp(bdn+"$"))){error_message="Error loading player: Unauthorized Domain",function(){var a="";jwplayer=function(c){return a=c,b};var b={setup:function(){var c="There was an error retrieving your embed.:Please double check your hosted URL in your <a href='http://account.jwplayer.com'>JW Dashboard</a>.";"undefined"!=typeof error_message&&(c=error_message);var d=document.getElementById(a),e=d.style;e.backgroundColor="#000",e.color="#FFF",e.width="480px",e.height="270px",e.display="table",e.opacity=1;var f=document.createElement("p"),g=f.style;return g.verticalAlign="middle",g.textAlign="center",g.display="table-cell",g.font="15px/20px Arial, Helvetica, sans-serif",f.innerHTML=c.replace(":",":<br>"),d.innerHTML="",d.appendChild(f),b},getRenderingMode:function(){return b},onReady:function(a){return b},getPlaylist:function(){return b},getPlaylistItem:function(a){return b},load:function(a){return b},playlistItem:function(a){return b},onPlaylist:function(a){return b},onPlaylistItem:function(a){return b},onComplete:function(a){return b},onPlaylistComplete:function(a){return b},getBuffer:function(){return b},onBufferChange:function(a){return b},getState:function(){return b},play:function(a){return b},pause:function(a){return b},stop:function(){return b},onBeforePlay:function(a){return b},onPlay:function(a){return b},onPause:function(a){return b},onBuffer:function(a){return b},onIdle:function(a){return b},getPosition:function(){return b},getDuration:function(){return b},seek:function(a){return b},onSeek:function(a){return b},onTime:function(a){return b},getMute:function(){return b},getVolume:function(){return b},setMute:function(a){return b},setVolume:function(a){return b},onMute:function(a){return b},onVolume:function(a){return b},getFullscreen:function(){return b},getHeight:function(){return b},getWidth:function(){return b},resize:function(a,c){return b},onFullscreen:function(a){return b},getQualityLevels:function(){return b},getCurrentQuality:function(){return b},setCurrentQuality:function(a){return b},onQualityLevels:function(a){return b},onQualityChange:function(a){return b},addButton:function(a,c,d,e){return b},removeButton:function(a){return b},getControls:function(){return b},getSafeRegion:function(){return b},setControls:function(a){return b},onControls:function(a){return b},onDisplayClick:function(a){return b},onError:function(a){return b},onMeta:function(a){return b}}}(),jwplayer.blacklisted=1;break}}"undefined"==typeof jwplayer&&(jwplayer=function(){return jwplayer.api?jwplayer.api.selectPlayer.apply(this,arguments):void 0},jwplayer.version="6.12.4956",jwplayer.vid=document.createElement("video"),jwplayer.audio=document.createElement("audio"),jwplayer.source=document.createElement("source"),function(){var a={},b=Array.prototype,c=Object.prototype,d=b.slice,e=b.concat,f=c.toString,g=c.hasOwnProperty,h=b.map,i=b.forEach,j=b.filter,k=b.every,l=b.some,m=b.indexOf,c=Array.isArray,n=Object.keys,o=function(a){return a instanceof o?a:this instanceof o?void 0:new o(a)},p=o.each=o.forEach=function(b,c,d){if(null==b)return b;if(i&&b.forEach===i)b.forEach(c,d);else if(b.length===+b.length){for(var e=0,f=b.length;f>e;e++)if(c.call(d,b[e],e,b)===a)return}else for(var g=o.keys(b),e=0,f=g.length;f>e;e++)if(c.call(d,b[g[e]],g[e],b)===a)return;return b};o.map=o.collect=function(a,b,c){var d=[];return null==a?d:h&&a.map===h?a.map(b,c):(p(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)},o.find=o.detect=function(a,b,c){var d;return q(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},o.filter=o.select=function(a,b,c){var d=[];return null==a?d:j&&a.filter===j?a.filter(b,c):(p(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)},o.every=o.all=function(b,c,d){c||(c=o.identity);var e=!0;return null==b?e:k&&b.every===k?b.every(c,d):(p(b,function(b,f,g){return(e=e&&c.call(d,b,f,g))?void 0:a}),!!e)};var q=o.some=o.any=function(b,c,d){c||(c=o.identity);var e=!1;return null==b?e:l&&b.some===l?b.some(c,d):(p(b,function(b,f,g){return e||(e=c.call(d,b,f,g))?a:void 0}),!!e)};o.size=function(a){return null==a?0:a.length===+a.length?a.length:o.keys(a).length},o.after=function(a,b){return function(){return 1>--a?b.apply(this,arguments):void 0}},o.sortedIndex=function(a,b,c,d){c=null==c?o.identity:o.isFunction(c)?c:o.property(c),b=c.call(d,b);for(var e=0,f=a.length;f>e;){var g=e+f>>>1;c.call(d,a[g])<b?e=g+1:f=g}return e},o.find=o.detect=function(a,b,c){var d;return q(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},q=o.some=o.any=function(b,c,d){c||(c=o.identity);var e=!1;return null==b?e:l&&b.some===l?b.some(c,d):(p(b,function(b,f,g){return e||(e=c.call(d,b,f,g))?a:void 0}),!!e)},o.contains=o.include=function(a,b){return null==a?!1:(a.length!==+a.length&&(a=o.values(a)),0<=o.indexOf(a,b))},o.where=function(a,b){return o.filter(a,o.matches(b))},o.difference=function(a){var c=e.apply(b,d.call(arguments,1));return o.filter(a,function(a){return!o.contains(c,a)})},o.without=function(a){return o.difference(a,d.call(arguments,1))},o.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=o.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(m&&a.indexOf===m)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},o.partial=function(a){var b=d.call(arguments,1);return function(){for(var c=0,d=b.slice(),e=0,f=d.length;f>e;e++)d[e]===o&&(d[e]=arguments[c++]);for(;c<arguments.length;)d.push(arguments[c++]);return a.apply(this,d)}},o.memoize=function(a,b){var c={};return b||(b=o.identity),function(){var d=b.apply(this,arguments);return o.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},o.delay=function(a,b){var c=d.call(arguments,2);
return setTimeout(function(){return a.apply(null,c)},b)},o.defer=function(a){return o.delay.apply(o,[a,1].concat(d.call(arguments,1)))},o.keys=function(a){if(!o.isObject(a))return[];if(n)return n(a);var b,c=[];for(b in a)o.has(a,b)&&c.push(b);return c},o.pick=function(a){var c={},f=e.apply(b,d.call(arguments,1));return p(f,function(b){b in a&&(c[b]=a[b])}),c},o.isArray=c||function(a){return"[object Array]"==f.call(a)},o.isObject=function(a){return a===Object(a)},p("Arguments Function String Number Date RegExp".split(" "),function(a){o["is"+a]=function(b){return f.call(b)=="[object "+a+"]"}}),o.isArguments(arguments)||(o.isArguments=function(a){return!(!a||!o.has(a,"callee"))}),"function"!=typeof/./&&(o.isFunction=function(a){return"function"==typeof a}),o.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},o.isNaN=function(a){return o.isNumber(a)&&a!=+a},o.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==f.call(a)},o.isNull=function(a){return null===a},o.isUndefined=function(a){return void 0===a},o.has=function(a,b){return g.call(a,b)},o.identity=function(a){return a},o.constant=function(a){return function(){return a}},o.property=function(a){return function(b){return b[a]}},o.matches=function(a){return function(b){if(b===a)return!0;for(var c in a)if(a[c]!==b[c])return!1;return!0}},o.result=function(a,b){if(null!=a){var c=a[b];return o.isFunction(c)?c.call(a):c}},this._=o}.call(jwplayer),function(a){function b(a){return function(){return g(a)}}function c(a,b,c,e,f){return function(){var g,h;if(f)c(a);else{try{if((g=a.responseXML)&&(h=g.firstChild,g.lastChild&&"parsererror"===g.lastChild.nodeName))return void(e&&e("Invalid XML",b,a))}catch(i){}if(g&&h)return c(a);(g=d.parseXML(a.responseText))&&g.firstChild?(a=d.extend({},a,{responseXML:g}),c(a)):e&&e(a.responseText?"Invalid XML":b,b,a)}}}var d=a.utils={},e=a._;d.exists=function(a){switch(typeof a){case"string":return 0<a.length;case"object":return null!==a;case"undefined":return!1}return!0},d.styleDimension=function(a){return a+(0<a.toString().indexOf("%")?"":"px")},d.getAbsolutePath=function(a,b){if(d.exists(b)||(b=document.location.href),d.exists(a)){var c;if(d.exists(a)){c=a.indexOf("://");var e=a.indexOf("?");c=c>0&&(0>e||e>c)}else c=void 0;if(c)return a;c=b.substring(0,b.indexOf("://")+3);var f,e=b.substring(c.length,b.indexOf("/",c.length+1));0===a.indexOf("/")?f=a.split("/"):(f=b.split("?")[0],f=f.substring(c.length+e.length+1,f.lastIndexOf("/")),f=f.split("/").concat(a.split("/")));for(var g=[],h=0;h<f.length;h++)f[h]&&d.exists(f[h])&&"."!==f[h]&&(".."===f[h]?g.pop():g.push(f[h]));return c+e+"/"+g.join("/")}},d.extend=function(){var a=Array.prototype.slice.call(arguments,0);if(1<a.length){for(var b=a[0],c=function(a,c){void 0!==c&&null!==c&&(b[a]=c)},e=1;e<a.length;e++)d.foreach(a[e],c);return b}return null};var f=window.console=window.console||{log:function(){}};d.log=function(){var a=Array.prototype.slice.call(arguments,0);"object"==typeof f.log?f.log(a):f.log.apply(f,a)};var g=e.memoize(function(a){return null!==navigator.userAgent.toLowerCase().match(a)});d.isFF=b(/firefox/i),d.isChrome=b(/chrome/i),d.isIPod=b(/iP(hone|od)/i),d.isIPad=b(/iPad/i),d.isSafari602=b(/Macintosh.*Mac OS X 10_8.*6\.0\.\d* Safari/i),d.isIETrident=function(a){return a?(a=parseFloat(a).toFixed(1),g(RegExp("trident/.+rv:\\s*"+a,"i"))):g(/trident/i)},d.isMSIE=function(a){return a?(a=parseFloat(a).toFixed(1),g(RegExp("msie\\s*"+a,"i"))):g(/msie/i)},d.isIE=function(a){return a?(a=parseFloat(a).toFixed(1),a>=11?d.isIETrident(a):d.isMSIE(a)):d.isMSIE()||d.isIETrident()},d.isSafari=function(){return g(/safari/i)&&!g(/chrome/i)&&!g(/chromium/i)&&!g(/android/i)},d.isIOS=function(a){return g(a?RegExp("iP(hone|ad|od).+\\sOS\\s"+a,"i"):/iP(hone|ad|od)/i)},d.isAndroidNative=function(a){return d.isAndroid(a,!0)},d.isAndroid=function(a,b){return b&&g(/chrome\/[123456789]/i)&&!g(/chrome\/18/)?!1:a?(d.isInt(a)&&!/\./.test(a)&&(a=""+a+"."),g(RegExp("Android\\s*"+a,"i"))):g(/Android/i)},d.isMobile=function(){return d.isIOS()||d.isAndroid()},d.isIframe=function(){return window.frameElement&&"IFRAME"===window.frameElement.nodeName},d.saveCookie=function(a,b){document.cookie="jwplayer."+a+"="+b+"; path=/"},d.getCookies=function(){for(var a={},b=document.cookie.split("; "),c=0;c<b.length;c++){var d=b[c].split("=");0===d[0].indexOf("jwplayer.")&&(a[d[0].substring(9,d[0].length)]=d[1])}return a},d.isInt=function(a){return 0===parseFloat(a)%1},d.typeOf=function(a){if(null===a)return"null";var b=typeof a;return"object"===b&&e.isArray(a)?"array":b},d.translateEventResponse=function(b,c){var e=d.extend({},c);if(b!==a.events.JWPLAYER_FULLSCREEN||e.fullscreen)if("object"==typeof e.data){var f=e.data;delete e.data,e=d.extend(e,f)}else"object"==typeof e.metadata&&d.deepReplaceKeyName(e.metadata,["__dot__","__spc__","__dsh__","__default__"],["."," ","-","default"]);else e.fullscreen="true"===e.message,delete e.message;return d.foreach(["position","duration","offset"],function(a,b){e[b]&&(e[b]=Math.round(1e3*e[b])/1e3)}),e},d.flashVersion=function(){if(d.isAndroid())return 0;var a,b=navigator.plugins;try{if("undefined"!==b&&(a=b["Shockwave Flash"]))return parseInt(a.description.replace(/\D+(\d+)\..*/,"$1"),10)}catch(c){}if("undefined"!=typeof window.ActiveXObject)try{if(a=new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash"))return parseInt(a.GetVariable("$version").split(" ")[1].split(",")[0],10)}catch(e){}return 0},d.getScriptPath=function(a){for(var b=document.getElementsByTagName("script"),c=0;c<b.length;c++){var d=b[c].src;if(d&&0<=d.indexOf(a))return d.substr(0,d.indexOf(a))}return""},d.deepReplaceKeyName=function(b,c,e){switch(a.utils.typeOf(b)){case"array":for(var f=0;f<b.length;f++)b[f]=a.utils.deepReplaceKeyName(b[f],c,e);break;case"object":d.foreach(b,function(d,f){var g;if(c instanceof Array&&e instanceof Array){if(c.length!==e.length)return;g=c}else g=[c];for(var h=d,i=0;i<g.length;i++)h=h.replace(RegExp(c[i],"g"),e[i]);b[h]=a.utils.deepReplaceKeyName(f,c,e),d!==h&&delete b[d]})}return b};var h=d.pluginPathType={ABSOLUTE:0,RELATIVE:1,CDN:2};d.getPluginPathType=function(a){if("string"==typeof a){a=a.split("?")[0];var b=a.indexOf("://");if(b>0)return h.ABSOLUTE;var c=a.indexOf("/");return a=d.extension(a),!(0>b&&0>c)||a&&isNaN(a)?h.RELATIVE:h.CDN}},d.getPluginName=function(a){return a.replace(/^(.*\/)?([^-]*)-?.*\.(swf|js)$/,"$2")},d.getPluginVersion=function(a){return a.replace(/[^-]*-?([^\.]*).*$/,"$1")},d.isYouTube=function(a,b){return"youtube"===b||/^(http|\/\/).*(youtube\.com|youtu\.be)\/.+/.test(a)},d.youTubeID=function(a){try{return/v[=\/]([^?&]*)|youtu\.be\/([^?]*)|^([\w-]*)$/i.exec(a).slice(1).join("").replace("?","")}catch(b){return""}},d.isRtmp=function(a,b){return 0===a.indexOf("rtmp")||"rtmp"===b},d.foreach=function(a,b){var c,e;for(c in a)"function"===d.typeOf(a.hasOwnProperty)?a.hasOwnProperty(c)&&(e=a[c],b(c,e)):(e=a[c],b(c,e))},d.isHTTPS=function(){return 0===window.location.href.indexOf("https")},d.repo=function(){var b="http://p.jwpcdn.com/"+a.version.split(/\W/).splice(0,2).join("/")+"/";try{d.isHTTPS()&&(b=b.replace("http://","https://ssl."))}catch(c){}return b},d.versionCheck=function(b){b=("0"+b).split(/\W/);var c=a.version.split(/\W/),d=parseFloat(b[0]),e=parseFloat(c[0]);return d>e||d===e&&parseFloat("0"+b[1])>parseFloat(c[1])?!1:!0},d.ajax=function(a,b,e,f){var g,h=!1;if(0<a.indexOf("#")&&(a=a.replace(/#.*$/,"")),a&&0<=a.indexOf("://")&&a.split("/")[2]!==window.location.href.split("/")[2]&&d.exists(window.XDomainRequest))g=new window.XDomainRequest,g.onload=c(g,a,b,e,f),g.ontimeout=g.onprogress=function(){},g.timeout=5e3;else{if(!d.exists(window.XMLHttpRequest))return e&&e("",a,g),g;var i=g=new window.XMLHttpRequest,j=a;g.onreadystatechange=function(){if(4===i.readyState)switch(i.status){case 200:c(i,j,b,e,f)();break;case 404:e("File not found",j,i)}}}g.overrideMimeType&&g.overrideMimeType("text/xml");var k=a,l=g;g.onerror=function(){e("Error loading file",k,l)};try{g.open("GET",a,!0)}catch(m){h=!0}return setTimeout(function(){if(h)e&&e(a,a,g);else try{g.send()}catch(b){e&&e(a,a,g)}},0),g},d.parseXML=function(a){var b;try{if(window.DOMParser){if(b=(new window.DOMParser).parseFromString(a,"text/xml"),b.childNodes&&b.childNodes.length&&"parsererror"===b.childNodes[0].firstChild.nodeName)return}else b=new window.ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)}catch(c){return}return b},d.between=function(a,b,c){return Math.max(Math.min(a,c),b)},d.seconds=function(a){if(e.isNumber(a))return a;a=a.replace(",",".");var b=a.split(":"),c=0;return"s"===a.slice(-1)?c=parseFloat(a):"m"===a.slice(-1)?c=60*parseFloat(a):"h"===a.slice(-1)?c=3600*parseFloat(a):1<b.length?(c=parseFloat(b[b.length-1]),c+=60*parseFloat(b[b.length-2]),3===b.length&&(c+=3600*parseFloat(b[b.length-3]))):c=parseFloat(a),c},d.serialize=function(a){return null===a?null:"true"===a.toString().toLowerCase()?!0:"false"===a.toString().toLowerCase()?!1:isNaN(Number(a))||5<a.length||0===a.length?a:Number(a)},d.addClass=function(a,b){var c=e.isString(a.className)?a.className.split(" "):[],f=e.isArray(b)?b:b.split(" ");e.each(f,function(a){e.contains(c,a)||c.push(a)}),a.className=d.trim(c.join(" "))},d.removeClass=function(a,b){var c=e.isString(a.className)?a.className.split(" "):[],f=e.isArray(b)?b:b.split(" ");a.className=d.trim(e.difference(c,f).join(" "))},d.emptyElement=function(a){for(;a.firstChild;)a.removeChild(a.firstChild)},d.indexOf=e.indexOf,d.noop=function(){},d.canCast=function(){var b=a.cast;return!(!b||!e.isFunction(b.available)||!b.available())}}(jwplayer),function(a){function b(a){var b=document.createElement("style");return a&&b.appendChild(document.createTextNode(a)),b.type="text/css",document.getElementsByTagName("head")[0].appendChild(b),b}function c(a,b,c){return g.exists(b)?(c=c?" !important":"","string"==typeof b&&isNaN(b)?/png|gif|jpe?g/i.test(b)&&0>b.indexOf("url")?"url("+b+")":b+c:0===b||"z-index"===a||"opacity"===a?""+b+c:/color/i.test(a)?"#"+g.pad(b.toString(16).replace(/^0x/i,""),6)+c:Math.ceil(b)+"px"+c):""}function d(a,b){for(var c=0;c<a.length;c++){var d,e,f=a[c];if(void 0!==f&&null!==f)for(d in b){e=d,e=e.split("-");for(var g=1;g<e.length;g++)e[g]=e[g].charAt(0).toUpperCase()+e[g].slice(1);e=e.join(""),f.style[e]!==b[d]&&(f.style[e]=b[d])}}}function e(a){var b,c,d,e=h[a].sheet;if(e){b=e.cssRules,c=k[a],d=a;var f=i[d];d+=" { ";for(var g in f)d+=g+": "+f[g]+"; ";if(d+="}",void 0!==c&&c<b.length&&b[c].selectorText===a){if(d===b[c].cssText)return;e.deleteRule(c)}else c=b.length,k[a]=c;try{e.insertRule(d,c)}catch(j){}}}var f,g=a.utils,h={},i={},j=null,k={};g.cssKeyframes=function(a,c){var d=h.keyframes;d||(d=b(),h.keyframes=d);var d=d.sheet,e="@keyframes "+a+" { "+c+" }";try{d.insertRule(e,d.cssRules.length)}catch(f){}e=e.replace(/(keyframes|transform)/g,"-webkit-$1");try{d.insertRule(e,d.cssRules.length)}catch(g){}};var l=g.css=function(a,d,g){i[a]||(i[a]={});var k=i[a];g=g||!1;var l,m,n=!1;for(l in d)m=c(l,d[l],g),""!==m?m!==k[l]&&(k[l]=m,n=!0):void 0!==k[l]&&(delete k[l],n=!0);n&&(h[a]||(d=f&&f.sheet&&f.sheet.cssRules&&f.sheet.cssRules.length||0,(!f||d>5e4)&&(f=b()),h[a]=f),null!==j?j.styleSheets[a]=i[a]:e(a))};l.style=function(b,e,f){if(void 0!==b&&null!==b){void 0===b.length&&(b=[b]);var g,h={};for(g in e)h[g]=c(g,e[g]);if(null===j||f)d(b,h);else{e=(e=b.__cssRules)||{};for(var i in h)e[i]=h[i];b.__cssRules=e,0>a._.indexOf(j.elements,b)&&j.elements.push(b)}}},l.block=function(a){null===j&&(j={id:a,styleSheets:{},elements:[]})},l.unblock=function(a){if(j&&(!a||j.id===a)){for(var b in j.styleSheets)e(b);for(a=0;a<j.elements.length;a++)b=j.elements[a],d(b,b.__cssRules);j=null}},g.clearCss=function(a){for(var b in i)0<=b.indexOf(a)&&delete i[b];for(var c in h)0<=c.indexOf(a)&&e(c)},g.transform=function(a,b){var c={};b=b||"",c.transform=b,c["-webkit-transform"]=b,c["-ms-transform"]=b,c["-moz-transform"]=b,c["-o-transform"]=b,"string"==typeof a?l(a,c):l.style(a,c)},g.dragStyle=function(a,b){l(a,{"-webkit-user-select":b,"-moz-user-select":b,"-ms-user-select":b,"-webkit-user-drag":b,"user-select":b,"user-drag":b})},g.transitionStyle=function(a,b){navigator.userAgent.match(/5\.\d(\.\d)? safari/i)||l(a,{"-webkit-transition":b,"-moz-transition":b,"-o-transition":b,transition:b})},g.rotate=function(a,b){g.transform(a,"rotate("+b+"deg)")},g.rgbHex=function(a){return a=String(a).replace("#",""),3===a.length&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),"#"+a.substr(-6)},g.hexToRgba=function(a,b){var c="rgb",d=[parseInt(a.substr(1,2),16),parseInt(a.substr(3,2),16),parseInt(a.substr(5,2),16)];return void 0!==b&&100!==b&&(c+="a",d.push(b/100)),c+"("+d.join(",")+")"}}(jwplayer),function(a){var b=jwplayer._,c=a.foreach,d={mp4:"video/mp4",ogg:"video/ogg",oga:"audio/ogg",vorbis:"audio/ogg",webm:"video/webm",aac:"audio/mp4",mp3:"audio/mpeg",hls:"application/vnd.apple.mpegurl"},e={mp4:d.mp4,f4v:d.mp4,m4v:d.mp4,mov:d.mp4,m4a:d.aac,f4a:d.aac,aac:d.aac,mp3:d.mp3,ogv:d.ogg,ogg:d.ogg,oga:d.vorbis,vorbis:d.vorbis,webm:d.webm,m3u8:d.hls,m3u:d.hls,hls:d.hls},f=a.extensionmap={};c(e,function(a,b){f[a]={html5:b}}),c({flv:"video",f4v:"video",mov:"video",m4a:"video",m4v:"video",mp4:"video",aac:"video",f4a:"video",mp3:"sound",smil:"rtmp",m3u8:"hls",hls:"hls"},function(a,b){f[a]||(f[a]={}),f[a].flash=b}),f.types=d,f.mimeType=function(a){var c;return b.find(d,function(b,d){return b===a?(c=d,!0):void 0}),c},f.extType=function(a){return f.mimeType(e[a])}}(jwplayer.utils),function(a){var b=a.loaderstatus={NEW:0,LOADING:1,ERROR:2,COMPLETE:3};a.scriptloader=function(c){function d(a){h=b.ERROR,g.sendEvent(f.ERROR,a)}function e(a){h=b.COMPLETE,g.sendEvent(f.COMPLETE,a)}var f=jwplayer.events,g=a.extend(this,new f.eventdispatcher),h=b.NEW;this.load=function(){if(h===b.NEW){var g=a.scriptloader.loaders[c];if(g&&(h=g.getStatus(),2>h))return g.addEventListener(f.ERROR,d),void g.addEventListener(f.COMPLETE,e);var i=document.getElementsByTagName("head")[0]||document.documentElement,j=document.createElement("script"),k=!1;j.onload=j.onreadystatechange=function(a){k||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(k=!0,e(a),j.onload=j.onreadystatechange=null,i&&j.parentNode&&i.removeChild(j))},j.onerror=d,j.src=c,i.insertBefore(j,i.firstChild),h=b.LOADING,a.scriptloader.loaders[c]=this}},this.getStatus=function(){return h}},a.scriptloader.loaders={}}(jwplayer.utils),function(a){a.trim=function(a){return a.replace(/^\s+|\s+$/g,"")},a.pad=function(a,b,c){for(c||(c="0");a.length<b;)a=c+a;return a},a.xmlAttribute=function(a,b){for(var c=0;c<a.attributes.length;c++)if(a.attributes[c].name&&a.attributes[c].name.toLowerCase()===b.toLowerCase())return a.attributes[c].value.toString();return""},a.extension=function(a){if(!a||"rtmp"===a.substr(0,4))return"";var b;return(b=-1<a.indexOf("(format=m3u8-")?"m3u8":!1)?b:(a=a.substring(a.lastIndexOf("/")+1,a.length).split("?")[0].split("#")[0],-1<a.lastIndexOf(".")?a.substr(a.lastIndexOf(".")+1,a.length).toLowerCase():void 0)},a.stringToColor=function(a){return a=a.replace(/(#|0x)?([0-9A-F]{3,6})$/gi,"$2"),3===a.length&&(a=a.charAt(0)+a.charAt(0)+a.charAt(1)+a.charAt(1)+a.charAt(2)+a.charAt(2)),parseInt(a,16)}}(jwplayer.utils),function(a){var b="touchmove",c="touchstart";a.touch=function(d){function e(a){a.type===c?(i=!0,k=g(m.DRAG_START,a)):a.type===b?i&&(l||(f(m.DRAG_START,a,k),l=!0),f(m.DRAG,a)):(i&&(l?f(m.DRAG_END,a):(a.cancelBubble=!0,f(m.TAP,a))),i=l=!1,k=null)}function f(a,b,c){j[a]&&(b.preventManipulation&&b.preventManipulation(),b.preventDefault&&b.preventDefault(),b=c?c:g(a,b))&&j[a](b)}function g(a,b){var c=null;if(b.touches&&b.touches.length?c=b.touches[0]:b.changedTouches&&b.changedTouches.length&&(c=b.changedTouches[0]),!c)return null;var d=h.getBoundingClientRect(),c={type:a,target:h,x:c.pageX-window.pageXOffset-d.left,y:c.pageY,deltaX:0,deltaY:0};return a!==m.TAP&&k&&(c.deltaX=c.x-k.x,c.deltaY=c.y-k.y),c}var h=d,i=!1,j={},k=null,l=!1,m=a.touchEvents;return document.addEventListener(b,e),document.addEventListener("touchend",function(a){i&&l&&f(m.DRAG_END,a),i=l=!1,k=null}),document.addEventListener("touchcancel",e),d.addEventListener(c,e),d.addEventListener("touchend",e),this.addEventListener=function(a,b){j[a]=b},this.removeEventListener=function(a){delete j[a]},this}}(jwplayer.utils),function(a){a.touchEvents={DRAG:"jwplayerDrag",DRAG_START:"jwplayerDragStart",DRAG_END:"jwplayerDragEnd",TAP:"jwplayerTap"}}(jwplayer.utils),function(a){a.key=function(b){var c,d,e;this.edition=function(){return e&&e.getTime()<(new Date).getTime()?"invalid":c},this.token=function(){return d},a.exists(b)||(b="");try{b=a.tea.decrypt(b,"36QXq4W@GSBV^teR");var f=b.split("/");(c=f[0])?/^(free|pro|premium|enterprise|ads)$/i.test(c)?(d=f[1],f[2]&&0<parseInt(f[2])&&(e=new Date,e.setTime(String(f[2])))):c="invalid":c="free"}catch(g){c="invalid"}}}(jwplayer.utils),function(a){var b=a.tea={};b.encrypt=function(a,e){if(0==a.length)return"";var f=b.strToLongs(d.encode(a));1>=f.length&&(f[1]=0);for(var g,h=b.strToLongs(d.encode(e).slice(0,16)),i=f.length,j=f[i-1],k=f[0],l=Math.floor(6+52/i),m=0;0<l--;){m+=2654435769,g=m>>>2&3;for(var n=0;i>n;n++)k=f[(n+1)%i],j=(j>>>5^k<<2)+(k>>>3^j<<4)^(m^k)+(h[3&n^g]^j),j=f[n]+=j}return f=b.longsToStr(f),c.encode(f)},b.decrypt=function(a,e){if(0==a.length)return"";for(var f,g=b.strToLongs(c.decode(a)),h=b.strToLongs(d.encode(e).slice(0,16)),i=g.length,j=g[i-1],k=g[0],l=2654435769*Math.floor(6+52/i);0!=l;){f=l>>>2&3;for(var m=i-1;m>=0;m--)j=g[m>0?m-1:i-1],j=(j>>>5^k<<2)+(k>>>3^j<<4)^(l^k)+(h[3&m^f]^j),k=g[m]-=j;l-=2654435769}return g=b.longsToStr(g),g=g.replace(/\0+$/,""),d.decode(g)},b.strToLongs=function(a){for(var b=Array(Math.ceil(a.length/4)),c=0;c<b.length;c++)b[c]=a.charCodeAt(4*c)+(a.charCodeAt(4*c+1)<<8)+(a.charCodeAt(4*c+2)<<16)+(a.charCodeAt(4*c+3)<<24);return b},b.longsToStr=function(a){for(var b=Array(a.length),c=0;c<a.length;c++)b[c]=String.fromCharCode(255&a[c],a[c]>>>8&255,a[c]>>>16&255,a[c]>>>24&255);return b.join("")};var c={code:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a,b){var e,f,g,h,i,j,k=[],l="",m=c.code;if(j=("undefined"==typeof b?0:b)?d.encode(a):a,i=j.length%3,i>0)for(;3>i++;)l+="=",j+="\x00";for(i=0;i<j.length;i+=3)e=j.charCodeAt(i),f=j.charCodeAt(i+1),g=j.charCodeAt(i+2),h=e<<16|f<<8|g,e=h>>18&63,f=h>>12&63,g=h>>6&63,h&=63,k[i/3]=m.charAt(e)+m.charAt(f)+m.charAt(g)+m.charAt(h);return k=k.join(""),k=k.slice(0,k.length-l.length)+l},decode:function(a,b){b="undefined"==typeof b?!1:b;var e,f,g,h,i,j,k=[],l=c.code;j=b?d.decode(a):a;for(var m=0;m<j.length;m+=4)e=l.indexOf(j.charAt(m)),f=l.indexOf(j.charAt(m+1)),h=l.indexOf(j.charAt(m+2)),i=l.indexOf(j.charAt(m+3)),g=e<<18|f<<12|h<<6|i,e=g>>>16&255,f=g>>>8&255,g&=255,k[m/4]=String.fromCharCode(e,f,g),64==i&&(k[m/4]=String.fromCharCode(e,f)),64==h&&(k[m/4]=String.fromCharCode(e));return h=k.join(""),b?d.decode(h):h}},d={encode:function(a){return a=a.replace(/[\u0080-\u07ff]/g,function(a){return a=a.charCodeAt(0),String.fromCharCode(192|a>>6,128|63&a)}),a=a.replace(/[\u0800-\uffff]/g,function(a){return a=a.charCodeAt(0),String.fromCharCode(224|a>>12,128|a>>6&63,128|63&a)})},decode:function(a){return a=a.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(a){return a=(15&a.charCodeAt(0))<<12|(63&a.charCodeAt(1))<<6|63&a.charCodeAt(2),String.fromCharCode(a)}),a=a.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(a){return a=(31&a.charCodeAt(0))<<6|63&a.charCodeAt(1),String.fromCharCode(a)})}}}(jwplayer.utils),function(a){a.events={COMPLETE:"COMPLETE",ERROR:"ERROR",API_READY:"jwplayerAPIReady",JWPLAYER_READY:"jwplayerReady",JWPLAYER_FULLSCREEN:"jwplayerFullscreen",JWPLAYER_RESIZE:"jwplayerResize",JWPLAYER_ERROR:"jwplayerError",JWPLAYER_SETUP_ERROR:"jwplayerSetupError",JWPLAYER_MEDIA_BEFOREPLAY:"jwplayerMediaBeforePlay",JWPLAYER_MEDIA_BEFORECOMPLETE:"jwplayerMediaBeforeComplete",JWPLAYER_MEDIA_BUFFER:"jwplayerMediaBuffer",JWPLAYER_MEDIA_BUFFER_FULL:"jwplayerMediaBufferFull",JWPLAYER_MEDIA_ERROR:"jwplayerMediaError",JWPLAYER_MEDIA_LOADED:"jwplayerMediaLoaded",JWPLAYER_MEDIA_COMPLETE:"jwplayerMediaComplete",JWPLAYER_MEDIA_SEEK:"jwplayerMediaSeek",JWPLAYER_MEDIA_TIME:"jwplayerMediaTime",JWPLAYER_MEDIA_VOLUME:"jwplayerMediaVolume",JWPLAYER_MEDIA_META:"jwplayerMediaMeta",JWPLAYER_MEDIA_MUTE:"jwplayerMediaMute",JWPLAYER_AUDIO_TRACKS:"jwplayerAudioTracks",JWPLAYER_AUDIO_TRACK_CHANGED:"jwplayerAudioTrackChanged",JWPLAYER_MEDIA_LEVELS:"jwplayerMediaLevels",JWPLAYER_MEDIA_LEVEL_CHANGED:"jwplayerMediaLevelChanged",JWPLAYER_CAPTIONS_CHANGED:"jwplayerCaptionsChanged",JWPLAYER_CAPTIONS_LIST:"jwplayerCaptionsList",JWPLAYER_CAPTIONS_LOADED:"jwplayerCaptionsLoaded",JWPLAYER_PLAYER_STATE:"jwplayerPlayerState",state:{BUFFERING:"BUFFERING",IDLE:"IDLE",PAUSED:"PAUSED",PLAYING:"PLAYING"},JWPLAYER_PLAYLIST_LOADED:"jwplayerPlaylistLoaded",JWPLAYER_PLAYLIST_ITEM:"jwplayerPlaylistItem",JWPLAYER_PLAYLIST_COMPLETE:"jwplayerPlaylistComplete",JWPLAYER_DISPLAY_CLICK:"jwplayerViewClick",JWPLAYER_PROVIDER_CLICK:"jwplayerProviderClick",JWPLAYER_VIEW_TAB_FOCUS:"jwplayerViewTabFocus",JWPLAYER_CONTROLS:"jwplayerViewControls",JWPLAYER_USER_ACTION:"jwplayerUserAction",JWPLAYER_INSTREAM_CLICK:"jwplayerInstreamClicked",JWPLAYER_INSTREAM_DESTROYED:"jwplayerInstreamDestroyed",JWPLAYER_AD_TIME:"jwplayerAdTime",JWPLAYER_AD_ERROR:"jwplayerAdError",JWPLAYER_AD_CLICK:"jwplayerAdClicked",JWPLAYER_AD_COMPLETE:"jwplayerAdComplete",JWPLAYER_AD_IMPRESSION:"jwplayerAdImpression",JWPLAYER_AD_COMPANIONS:"jwplayerAdCompanions",JWPLAYER_AD_SKIPPED:"jwplayerAdSkipped",JWPLAYER_AD_PLAY:"jwplayerAdPlay",JWPLAYER_AD_PAUSE:"jwplayerAdPause",JWPLAYER_AD_META:"jwplayerAdMeta",JWPLAYER_CAST_AVAILABLE:"jwplayerCastAvailable",JWPLAYER_CAST_SESSION:"jwplayerCastSession",JWPLAYER_CAST_AD_CHANGED:"jwplayerCastAdChanged"}}(jwplayer),function(a){var b=a.utils;a.events.eventdispatcher=function(c,d){function e(a,c,d){if(a)for(var e=0;e<a.length;e++){var f=a[e];if(f){null!==f.count&&0===--f.count&&delete a[e];try{f.listener(c)}catch(g){b.log('Error handling "'+d+'" event listener ['+e+"]: "+g.toString(),f.listener,c)}}}}var f,g;this.resetEventListeners=function(){f={},g=[]},this.resetEventListeners(),this.addEventListener=function(a,c,d){try{b.exists(f[a])||(f[a]=[]),"string"===b.typeOf(c)&&(c=new Function("return "+c)()),f[a].push({listener:c,count:d||null})}catch(e){b.log("error",e)}return!1},this.removeEventListener=function(a,c){var d;if(f[a]){try{if(void 0===c)return void(f[a]=[]);for(d=0;d<f[a].length;d++)if(f[a][d].listener.toString()===c.toString()){f[a].splice(d,1);break}}catch(e){b.log("error",e)}return!1}},this.addGlobalListener=function(a,c){try{"string"===b.typeOf(a)&&(a=new Function("return "+a)()),g.push({listener:a,count:c||null})}catch(d){b.log("error",d)}return!1},this.removeGlobalListener=function(a){if(a){try{for(var c=g.length;c--;)g[c].listener.toString()===a.toString()&&g.splice(c,1)}catch(d){b.log("error",d)}return!1}},this.sendEvent=function(h,i){b.exists(i)||(i={}),b.extend(i,{id:c,version:a.version,type:h}),d&&b.log(h,i),e(f[h],i,h),e(g,i,h)}}}(window.jwplayer),function(a){var b={},c={};a.plugins=function(){},a.plugins.loadPlugins=function(d,e){return c[d]=new a.plugins.pluginloader(new a.plugins.model(b),e),c[d]},a.plugins.registerPlugin=function(c,d,e,f){var g=a.utils.getPluginName(c);b[g]||(b[g]=new a.plugins.plugin(c)),b[g].registerPlugin(c,d,e,f)}}(jwplayer),function(a){a.plugins.model=function(b){this.addPlugin=function(c){var d=a.utils.getPluginName(c);return b[d]||(b[d]=new a.plugins.plugin(c)),b[d]},this.getPlugins=function(){return b}}}(jwplayer),function(a){var b=jwplayer.utils,c=jwplayer.events;a.pluginmodes={FLASH:0,JAVASCRIPT:1,HYBRID:2},a.plugin=function(d){function e(){switch(b.getPluginPathType(d)){case b.pluginPathType.ABSOLUTE:return d;case b.pluginPathType.RELATIVE:return b.getAbsolutePath(d,window.location.href)}}function f(){k=setTimeout(function(){l=b.loaderstatus.COMPLETE,m.sendEvent(c.COMPLETE)},1e3)}function g(){l=b.loaderstatus.ERROR,m.sendEvent(c.ERROR,{url:d})}var h,i,j,k,l=b.loaderstatus.NEW,m=new c.eventdispatcher;b.extend(this,m),this.load=function(){if(l===b.loaderstatus.NEW)if(0<d.lastIndexOf(".swf"))h=d,l=b.loaderstatus.COMPLETE,m.sendEvent(c.COMPLETE);else if(b.getPluginPathType(d)===b.pluginPathType.CDN)l=b.loaderstatus.COMPLETE,m.sendEvent(c.COMPLETE);else{l=b.loaderstatus.LOADING;var a=new b.scriptloader(e());a.addEventListener(c.COMPLETE,f),a.addEventListener(c.ERROR,g),a.load()}},this.registerPlugin=function(a,d,e,f){k&&(clearTimeout(k),k=void 0),j=d,e&&f?(h=f,i=e):"string"==typeof e?h=e:"function"==typeof e?i=e:!e&&!f&&(h=a),l=b.loaderstatus.COMPLETE,m.sendEvent(c.COMPLETE)},this.getStatus=function(){return l},this.getPluginName=function(){return b.getPluginName(d)},this.getFlashPath=function(){if(h)switch(b.getPluginPathType(h)){case b.pluginPathType.ABSOLUTE:return h;case b.pluginPathType.RELATIVE:return 0<d.lastIndexOf(".swf")?b.getAbsolutePath(h,window.location.href):b.getAbsolutePath(h,e())}return null},this.getJS=function(){return i},this.getTarget=function(){return j},this.getPluginmode=function(){return"undefined"!=typeof h&&"undefined"!=typeof i?a.pluginmodes.HYBRID:"undefined"!=typeof h?a.pluginmodes.FLASH:"undefined"!=typeof i?a.pluginmodes.JAVASCRIPT:void 0},this.getNewInstance=function(a,b,c){return new i(a,b,c)},this.getURL=function(){return d}}}(jwplayer.plugins),function(a){var b=a.utils,c=a.events,d=a._,e=b.foreach;a.plugins.pluginloader=function(a,f){function g(){l||(l=!0,k=b.loaderstatus.COMPLETE,p.sendEvent(c.COMPLETE))}function h(){if(!o&&((!m||0===d.keys(m).length)&&g(),!l)){var e=a.getPlugins();j=d.after(n,g),b.foreach(m,function(a){a=b.getPluginName(a);var d=e[a];a=d.getJS();var f=d.getTarget(),d=d.getStatus();d===b.loaderstatus.LOADING||d===b.loaderstatus.NEW||(a&&!b.versionCheck(f)&&p.sendEvent(c.ERROR,{message:"Incompatible player version"}),j())})}}function i(a){o||(p.sendEvent(c.ERROR,{message:"File not found"}),a.url&&b.log("File not found",a.url),h())}var j,k=b.loaderstatus.NEW,l=!1,m=f,n=d.size(m),o=!1,p=new c.eventdispatcher;b.extend(this,p),this.setupPlugins=function(c,d,f){var g={length:0,plugins:{}},h=0,i={},j=a.getPlugins();return e(d.plugins,function(a,e){var k=b.getPluginName(a),l=j[k],m=l.getFlashPath(),n=l.getJS(),o=l.getURL();m&&(g.plugins[m]=b.extend({},e),g.plugins[m].pluginmode=l.getPluginmode(),g.length++);try{if(n&&d.plugins&&d.plugins[o]){var p=document.createElement("div");p.id=c.id+"_"+k,p.style.position="absolute",p.style.top=0,p.style.zIndex=h+10,i[k]=l.getNewInstance(c,b.extend({},d.plugins[o]),p),h++,c.onReady(f(i[k],p,!0)),c.onResize(f(i[k],p))}}catch(q){b.log("ERROR: Failed to load "+k+".")}}),c.plugins=i,g},this.load=function(){if(!b.exists(f)||"object"===b.typeOf(f)){k=b.loaderstatus.LOADING,e(f,function(d){b.exists(d)&&(d=a.addPlugin(d),d.addEventListener(c.COMPLETE,h),d.addEventListener(c.ERROR,i))});var d=a.getPlugins();e(d,function(a,b){b.load()})}h()},this.destroy=function(){o=!0,p&&(p.resetEventListeners(),p=null)},this.pluginFailed=i,this.getStatus=function(){return k}}}(jwplayer),function(a){a.parsers={localName:function(a){return a?a.localName?a.localName:a.baseName?a.baseName:"":""},textContent:function(b){return b?b.textContent?a.utils.trim(b.textContent):b.text?a.utils.trim(b.text):"":""},getChildNode:function(a,b){return a.childNodes[b]},numChildren:function(a){return a.childNodes?a.childNodes.length:0}}}(jwplayer),function(a){var b=a.parsers;(b.jwparser=function(){}).parseEntry=function(c,d){for(var e=[],f=[],g=a.utils.xmlAttribute,h=0;h<c.childNodes.length;h++){var i=c.childNodes[h];if("jwplayer"===i.prefix){var j=b.localName(i);"source"===j?(delete d.sources,e.push({file:g(i,"file"),"default":g(i,"default"),label:g(i,"label"),type:g(i,"type")})):"track"===j?(delete d.tracks,f.push({file:g(i,"file"),"default":g(i,"default"),kind:g(i,"kind"),label:g(i,"label")})):(d[j]=a.utils.serialize(b.textContent(i)),"file"===j&&d.sources&&delete d.sources)}d.file||(d.file=d.link)}if(e.length)for(d.sources=[],h=0;h<e.length;h++)0<e[h].file.length&&(e[h]["default"]="true"===e[h]["default"]?!0:!1,e[h].label.length||delete e[h].label,d.sources.push(e[h]));if(f.length)for(d.tracks=[],h=0;h<f.length;h++)0<f[h].file.length&&(f[h]["default"]="true"===f[h]["default"]?!0:!1,f[h].kind=f[h].kind.length?f[h].kind:"captions",f[h].label.length||delete f[h].label,d.tracks.push(f[h]));return d}}(jwplayer),function(a){var b=jwplayer.utils,c=b.xmlAttribute,d=a.localName,e=a.textContent,f=a.numChildren,g=a.mediaparser=function(){};g.parseGroup=function(a,h){var i,j,k=[];for(j=0;j<f(a);j++)if(i=a.childNodes[j],"media"===i.prefix&&d(i))switch(d(i).toLowerCase()){case"content":c(i,"duration")&&(h.duration=b.seconds(c(i,"duration"))),0<f(i)&&(h=g.parseGroup(i,h)),c(i,"url")&&(h.sources||(h.sources=[]),h.sources.push({file:c(i,"url"),type:c(i,"type"),width:c(i,"width"),label:c(i,"label")}));break;case"title":h.title=e(i);break;case"description":h.description=e(i);break;case"guid":h.mediaid=e(i);break;case"thumbnail":h.image||(h.image=c(i,"url"));break;case"group":g.parseGroup(i,h);break;case"subtitle":var l={};if(l.file=c(i,"url"),l.kind="captions",0<c(i,"lang").length){var m=l;i=c(i,"lang");var n={zh:"Chinese",nl:"Dutch",en:"English",fr:"French",de:"German",it:"Italian",ja:"Japanese",pt:"Portuguese",ru:"Russian",es:"Spanish"};i=n[i]?n[i]:i,m.label=i}k.push(l)}for(h.hasOwnProperty("tracks")||(h.tracks=[]),j=0;j<k.length;j++)h.tracks.push(k[j]);return h}}(jwplayer.parsers),function(a){function b(b){for(var e={},f=0;f<b.childNodes.length;f++){var h=b.childNodes[f],i=g(h);if(i)switch(i.toLowerCase()){case"enclosure":e.file=c.xmlAttribute(h,"url");break;case"title":e.title=d(h);break;case"guid":e.mediaid=d(h);break;case"pubdate":e.date=d(h);break;case"description":e.description=d(h);break;case"link":e.link=d(h);break;case"category":e.tags=e.tags?e.tags+d(h):d(h)}}return e=a.mediaparser.parseGroup(b,e),e=a.jwparser.parseEntry(b,e),new jwplayer.playlist.item(e)}var c=jwplayer.utils,d=a.textContent,e=a.getChildNode,f=a.numChildren,g=a.localName;a.rssparser={},a.rssparser.parse=function(a){for(var c=[],d=0;d<f(a);d++){var h=e(a,d);if("channel"===g(h).toLowerCase())for(var i=0;i<f(h);i++){var j=e(h,i);"item"===g(j).toLowerCase()&&c.push(b(j))}}return c}}(jwplayer.parsers),function(a){var b=a.utils,c=a._;a.playlist=function(b){var d=[];return b=c.isArray(b)?b:[b],c.each(b,function(b){d.push(new a.playlist.item(b))}),d},a.playlist.filterPlaylist=function(a,e){var f=[];return c.each(a,function(a){if(a=b.extend({},a),a.sources=d(a.sources,!1,e),a.sources.length){for(var c=0;c<a.sources.length;c++)a.sources[c].label=a.sources[c].label||c.toString();f.push(a)}}),f};var d=a.playlist.filterSources=function(d,e,f){var g,h=[],i=e?a.embed.flashCanPlay:a.embed.html5CanPlay;return d?(c.each(d,function(a){if(a&&a.file){var c=b.trim(""+a.file),d=a.type;d||(d=b.extension(c),d=b.extensionmap.extType(d)),a=b.extend({},a,{file:c,type:d})}else a=void 0;a&&i(a.file,a.type,f)&&(g=g||a.type,a.type===g&&h.push(a))}),h):void 0}}(jwplayer),function(a){var b=a.item=function(c){var d,e,f=jwplayer.utils,g=f.extend({},b.defaults,c);for(g.tracks=c&&f.exists(c.tracks)?c.tracks:[],0===g.sources.length&&(g.sources=[new a.source(g)]),d=0;d<g.sources.length;d++)e=g.sources[d]["default"],g.sources[d]["default"]=e?"true"===e.toString():!1,g.sources[d]=new a.source(g.sources[d]);if(g.captions&&!f.exists(c.tracks)){for(c=0;c<g.captions.length;c++)g.tracks.push(g.captions[c]);delete g.captions}for(d=0;d<g.tracks.length;d++)g.tracks[d]=new a.track(g.tracks[d]);return g};b.defaults={description:void 0,image:void 0,mediaid:void 0,title:void 0,sources:[],tracks:[]}}(jwplayer.playlist),function(a){var b=a.utils,c=a.events,d=a.parsers;a.playlist.loader=function(){function e(b){try{var e=b.responseXML.childNodes;b="";for(var f=0;f<e.length&&(b=e[f],!(8!==b.nodeType));f++);if("xml"===d.localName(b)&&(b=b.nextSibling),"rss"!==d.localName(b))g("Not a valid RSS feed");else{var i=new a.playlist(d.rssparser.parse(b));
h.sendEvent(c.JWPLAYER_PLAYLIST_LOADED,{playlist:i})}}catch(j){g()}}function f(a){g(a.match(/invalid/i)?"Not a valid RSS feed":"")}function g(a){h.sendEvent(c.JWPLAYER_ERROR,{message:a?a:"Error loading file"})}var h=new c.eventdispatcher;b.extend(this,h),this.load=function(a){b.ajax(a,e,f)}}}(jwplayer),function(a){var b=jwplayer.utils,c={file:void 0,label:void 0,type:void 0,"default":void 0};a.source=function(a){var d=b.extend({},c);return b.foreach(c,function(c){b.exists(a[c])&&(d[c]=a[c],delete a[c])}),d.type&&0<d.type.indexOf("/")&&(d.type=b.extensionmap.mimeType(d.type)),"m3u8"===d.type&&(d.type="hls"),"smil"===d.type&&(d.type="rtmp"),d}}(jwplayer.playlist),function(a){var b=jwplayer.utils,c={file:void 0,label:void 0,kind:"captions","default":!1};a.track=function(a){var d=b.extend({},c);return a||(a={}),b.foreach(c,function(c){b.exists(a[c])&&(d[c]=a[c],delete a[c])}),d}}(jwplayer.playlist),function(a){function b(a,b,d){var e=a.style;e.backgroundColor="#000",e.color="#FFF",e.width=c.styleDimension(d.width),e.height=c.styleDimension(d.height),e.display="table",e.opacity=1,d=document.createElement("p"),e=d.style,e.verticalAlign="middle",e.textAlign="center",e.display="table-cell",e.font="15px/20px Arial, Helvetica, sans-serif",d.innerHTML=b.replace(":",":<br>"),a.innerHTML="",a.appendChild(d)}var c=a.utils,d=a.events,e=a._,f=a.embed=function(g){function h(){if(!v){var b=o.playlist;if(e.isArray(b)){if(0===b.length)return void k();if(!(1!==b.length||b[0].sources&&0!==b[0].sources.length&&b[0].sources[0].file))return void k()}if(!u)if(e.isString(b))n=new a.playlist.loader,n.addEventListener(d.JWPLAYER_PLAYLIST_LOADED,function(a){o.playlist=a.playlist,u=!1,h()}),n.addEventListener(d.JWPLAYER_ERROR,function(a){u=!1,k(a)}),u=!0,n.load(o.playlist);else if(t.getStatus()===c.loaderstatus.COMPLETE){for(b=0;b<o.modes.length;b++){var j=o.modes[b],m=j.type;if(m&&f[m]){var p=c.extend({},o);if(w=new f[m](z,j,p,t,g),w.supportsConfig())return w.addEventListener(d.ERROR,i),w.embed(),c.css("object.jwswf, .jwplayer:focus",{outline:"none"}),c.css(".jw-tab-focus:focus",{outline:"solid 2px #0B7EF4"}),g}}o.fallback?(b="No suitable players found and fallback enabled",l(b,!0),c.log(b),new f.download(z,o,k)):(b="No suitable players found and fallback disabled",l(b,!1),c.log(b))}}}function i(a){m(r+a.message)}function j(a){g.dispatchEvent(d.JWPLAYER_ERROR,{message:"Could not load plugin: "+a.message})}function k(a){m(a&&a.message?"Error loading playlist: "+a.message:r+"No playable sources found")}function l(a,b){clearTimeout(x),x=setTimeout(function(){g.dispatchEvent(d.JWPLAYER_SETUP_ERROR,{message:a,fallback:b})},0)}function m(a){v||(s.parentNode.replaceChild(z,s),o.fallback?(v=!0,b(z,a,o),l(a,!0)):l(a,!1))}var n,o=new f.config(g.config),p=o.width,q=o.height,r="Error loading player: ",s=document.getElementById(g.id),t=a.plugins.loadPlugins(g.id,o.plugins),u=!1,v=!1,w=null,x=-1;o.id=g.id,o.aspectratio?g.config.aspectratio=o.aspectratio:delete g.config.aspectratio;var y=g;c.foreach(o.events,function(a,b){var c=y[a];"function"==typeof c&&c.call(y,b)});var z=document.createElement("div");return z.id=s.id,z.style.width=0<p.toString().indexOf("%")?p:p+"px",z.style.height=0<q.toString().indexOf("%")?q:q+"px",this.embed=function(){v||(t.addEventListener(d.COMPLETE,h),t.addEventListener(d.ERROR,j),t.load())},this.destroy=function(){w&&(w.destroy(),w=null),t&&(t.destroy(),t=null),n&&(n.resetEventListeners(),n=null)},this.errorScreen=m,this};a.embed.errorScreen=b}(jwplayer),function(a){function b(a){if(a.playlist)for(var b=0;b<a.playlist.length;b++)a.playlist[b]=new e(a.playlist[b]);else{var f={};d.foreach(e.defaults,function(b){c(a,f,b)}),f.sources||(a.levels?(f.sources=a.levels,delete a.levels):(b={},c(a,b,"file"),c(a,b,"type"),f.sources=b.file?[b]:[])),a.playlist=[new e(f)]}}function c(a,b,c){d.exists(a[c])&&(b[c]=a[c],delete a[c])}var d=a.utils,e=a.playlist.item;(a.embed.config=function(c){var e={fallback:!0,height:270,primary:"html5",width:480,base:c.base?c.base:d.getScriptPath("jwplayer.js"),aspectratio:""};c=d.extend({},e,a.defaults,c);var e={type:"html5",src:c.base+"jwplayer.html5.js"},f={type:"flash",src:c.base+"jwplayer.flash.swf"};if(c.modes="flash"===c.primary?[f,e]:[e,f],c.listbar&&(c.playlistsize=c.listbar.size,c.playlistposition=c.listbar.position,c.playlistlayout=c.listbar.layout),c.flashplayer&&(f.src=c.flashplayer),c.html5player&&(e.src=c.html5player),b(c),f=c.aspectratio,"string"==typeof f&&d.exists(f)){var g=f.indexOf(":");-1===g?e=0:(e=parseFloat(f.substr(0,g)),f=parseFloat(f.substr(g+1)),e=0>=e||0>=f?0:100*(f/e)+"%")}else e=0;return-1===c.width.toString().indexOf("%")?delete c.aspectratio:e?c.aspectratio=e:delete c.aspectratio,c}).addConfig=function(a,c){return b(c),d.extend(a,c)}}(jwplayer),function(a){function b(a,b){function d(a,b){e[f].style[a]=b}for(var e=document.querySelectorAll(a),f=0;f<e.length;f++)c.foreach(b,d)}var c=a.utils;a.embed.download=function(a,d,e){function f(a,b,c){return a=document.createElement(a),b&&(a.className="jwdownload"+b),c&&c.appendChild(a),a}var g,h,i=c.extend({},d),j=i.width?i.width:480,k=i.height?i.height:320;d=d.logo?d.logo:{prefix:c.repo(),file:"logo.png",margin:10};var l,m,n,o,p,q;if(m=i.playlist,i=["mp4","aac","mp3"],m&&m.length){for(n=m[0],o=n.sources,m=0;m<o.length;m++)p=o[m],p.file&&(q=p.type||c.extensionmap.extType(c.extension(p.file)),0<=c.indexOf(i,q)?(g=p.file,h=n.image):c.isYouTube(p.file,q)&&(l=p.file));g?(e=g,a&&(g=f("a","display",a),f("div","icon",g),f("div","logo",g),e&&g.setAttribute("href",c.getAbsolutePath(e))),e="#"+a.id+" .jwdownload",a.style.width="",a.style.height="",b(e+"display",{width:c.styleDimension(Math.max(320,j)),height:c.styleDimension(Math.max(180,k)),background:"black center no-repeat "+(h?"url("+h+")":""),backgroundSize:"contain",position:"relative",border:"none",display:"block"}),b(e+"display div",{position:"absolute",width:"100%",height:"100%"}),b(e+"logo",{top:d.margin+"px",right:d.margin+"px",background:"top right no-repeat url("+d.prefix+d.file+")"}),b(e+"icon",{background:"center no-repeat url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAgNJREFUeNrs28lqwkAYB/CZqNVDDj2r6FN41QeIy8Fe+gj6BL275Q08u9FbT8ZdwVfotSBYEPUkxFOoks4EKiJdaDuTjMn3wWBO0V/+sySR8SNSqVRKIR8qaXHkzlqS9jCfzzWcTCYp9hF5o+59sVjsiRzcegSckFzcjT+ruN80TeSlAjCAAXzdJSGPFXRpAAMYwACGZQkSdhG4WCzehMNhqV6vG6vVSrirKVEw66YoSqDb7cqlUilE8JjHd/y1MQefVzqdDmiaJpfLZWHgXMHn8F6vJ1cqlVAkEsGuAn83J4gAd2RZymQygX6/L1erVQt+9ZPWb+CDwcCC2zXGJaewl/DhcHhK3DVj+KfKZrMWvFarcYNLomAv4aPRSFZVlTlcSPA5fDweW/BoNIqFnKV53JvncjkLns/n/cLdS+92O7RYLLgsKfv9/t8XlDn4eDyiw+HA9Jyz2eyt0+kY2+3WFC5hluej0Ha7zQQq9PPwdDq1Et1sNsx/nFBgCqWJ8oAK1aUptNVqcYWewE4nahfU0YQnk4ntUEfGMIU2m01HoLaCKbTRaDgKtaVLk9tBYaBcE/6Artdr4RZ5TB6/dC+9iIe/WgAMYADDpAUJAxjAAAYwgGFZgoS/AtNNTF7Z2bL0BYPBV3Jw5xFwwWcYxgtBP5OkE8i9G7aWGOOCruvauwADALMLMEbKf4SdAAAAAElFTkSuQmCC)"})):l?(d=l,a=f("iframe","",a),a.src="http://www.youtube.com/embed/"+c.youTubeID(d),a.width=j,a.height=k,a.style.border="none"):e()}}}(jwplayer),function(a){var b=a.utils,c=a.events,d={};(a.embed.flash=function(f,g,h,i,j){function k(a,b,c){var d=document.createElement("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)}function l(a,b,c){return function(){try{c&&document.getElementById(j.id+"_wrapper").appendChild(b);var d=document.getElementById(j.id).getPluginConfig("display");"function"==typeof a.resize&&a.resize(d.width,d.height),b.style.left=d.x,b.style.top=d.h}catch(e){}}}function m(a){if(!a)return{};var c={},d=[];return b.foreach(a,function(a,e){var f=b.getPluginName(a);d.push(a),b.foreach(e,function(a,b){c[f+"."+a]=b})}),c.plugins=d.join(","),c}var n=new a.events.eventdispatcher,o=b.flashVersion();b.extend(this,n),this.embed=function(){if(h.id=j.id,10>o)return n.sendEvent(c.ERROR,{message:"Flash version must be 10.0 or greater"}),!1;var a,e,p=f.id,q=j.config.listbar,r=b.extend({},h);if(a=document.getElementById(j.id),a.parentNode.replaceChild(f,a),p+"_wrapper"===f.parentNode.id)a=document.getElementById(p+"_wrapper");else{if(a=document.createElement("div"),e=document.createElement("div"),e.style.display="none",e.id=p+"_aspect",a.id=p+"_wrapper",a.style.position="relative",a.style.display="block",a.style.width=b.styleDimension(r.width),a.style.height=b.styleDimension(r.height),j.config.aspectratio){var s=parseFloat(j.config.aspectratio);e.style.display="block",e.style.marginTop=j.config.aspectratio,a.style.height="auto",a.style.display="inline-block",q&&("bottom"===q.position?e.style.paddingBottom=q.size+"px":"right"===q.position&&(e.style.marginBottom=-1*q.size*(s/100)+"px"))}f.parentNode.replaceChild(a,f),a.appendChild(f),a.appendChild(e)}for(q=i.setupPlugins(j,r,l),0<q.length?b.extend(r,m(q.plugins)):delete r.plugins,"undefined"!=typeof r["dock.position"]&&"false"===r["dock.position"].toString().toLowerCase()&&(r.dock=r["dock.position"],delete r["dock.position"]),q=r.wmode||(r.height&&40>=r.height?"transparent":"opaque"),e="height width modes events primary base fallback volume".split(" "),s=0;s<e.length;s++)delete r[e[s]];e=b.getCookies(),b.foreach(e,function(a,b){"undefined"==typeof r[a]&&(r[a]=b)}),e=window.location.href.split("/"),e.splice(e.length-1,1),e=e.join("/"),r.base=e+"/",d[p]=r,b.isMSIE()?(f.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%" id="'+p+'" name="'+p+'" tabindex="0"><param name="movie" value="'+g.src+'"><param name="allowfullscreen" value="true"><param name="allowscriptaccess" value="always"><param name="seamlesstabbing" value="true"><param name="wmode" value="'+q+'"><param name="bgcolor" value="#000000"></object>',a=a.getElementsByTagName("object")[0],a.style.outline="none"):(a=document.createElement("object"),a.setAttribute("type","application/x-shockwave-flash"),a.setAttribute("data",g.src),a.setAttribute("width","100%"),a.setAttribute("height","100%"),a.setAttribute("bgcolor","#000000"),a.setAttribute("id",p),a.setAttribute("name",p),a.className="jwswf",k(a,"allowfullscreen","true"),k(a,"allowscriptaccess","always"),k(a,"seamlesstabbing","true"),k(a,"wmode",q),f.parentNode.replaceChild(a,f)),j.config.aspectratio&&(a.style.position="absolute",a.style.left="0"),j.container=a,j.setPlayer(a,"flash")},this.supportsConfig=function(){if(o){if(!h)return!0;if("string"===b.typeOf(h.playlist))return!0;try{var a=h.playlist[0].sources;if("undefined"==typeof a)return!0;for(var c=0;c<a.length;c++)if(a[c].file&&e(a[c].file,a[c].type))return!0}catch(d){}}return!1},this.destroy=function(){}}).getVars=function(a){return d[a]};var e=a.embed.flashCanPlay=function(a,c){if(b.isYouTube(a,c)||b.isRtmp(a,c)||"hls"===c)return!0;var d=b.extensionmap[c?c:b.extension(a)];return d?!!d.flash:!1}}(jwplayer),function(a){var b,c=a.utils,d=c.extensionmap,e=a.events;a.embed.html5=function(d,f,g,h,i){function j(a,b,c){return function(){try{var e=document.querySelector("#"+d.id+" .jwmain");c&&e.appendChild(b),"function"==typeof a.resize&&(a.resize(e.clientWidth,e.clientHeight),setTimeout(function(){a.resize(e.clientWidth,e.clientHeight)},400)),b.left=e.style.left,b.top=e.style.top}catch(f){}}}var k=new e.eventdispatcher;c.extend(this,k),this.embed=function(){if(a.html5){h.setupPlugins(i,g,j),c.emptyElement(d);var b=a.utils.extend({},g);delete b.volume,b=new a.html5.player(b),i.setPlayer(b,"html5")}else this.loadEmbedder()},this.loadEmbedder=function(){b=b||new c.scriptloader(f.src),b.addEventListener(e.ERROR,this.loadError),b.addEventListener(e.COMPLETE,this.embed),b.load()},this.loadError=function(a){this.sendEvent(a.type,{message:"HTML5 player not found"})},this.supportsConfig=function(){if(a.vid.canPlayType)try{if("string"===c.typeOf(g.playlist))return!0;for(var b=g.playlist[0].sources,d=0;d<b.length;d++)if(a.embed.html5CanPlay(b[d].file,b[d].type,g.androidhls))return!0}catch(e){}return!1},this.destroy=function(){b&&(b.resetEventListeners(),b=null)}},a.embed.html5CanPlay=function(b,e,f){if(null!==navigator.userAgent.match(/BlackBerry/i)||c.isIE(9))return!1;if(c.isYouTube(b,e))return!0;var g=c.extension(b);if(e=e||d.extType(g),"hls"===e)if(f){if(f=c.isAndroidNative,f(2)||f(3)||f("4.0"))return!1;if(c.isAndroid())return!0}else if(c.isAndroid())return!1;if(c.isRtmp(b,e))return!1;if(b=d[e]||d[g],!b||b.flash&&!b.html5)return!1;var h;a:if(b=b.html5){try{h=!!a.vid.canPlayType(b);break a}catch(i){}h=!1}else h=!0;return h}}(jwplayer),function(a){var b=a.embed,c=a.embed.html5CanPlay,d=a.utils,e=a._,f=/\.(js|swf)$/;a.cast=a.cast||{},a.embed=d.extend(function(c){function e(){g="Adobe SiteCatalyst Error: Could not find Media Module"}var g,h=d.repo(),i=d.extend({},a.defaults),j=d.extend({},i,c.config),k=c.config,l=j.plugins,m=j.analytics,n=h+"jwpsrv.js",o=h+"sharing.js",p=h+"related.js",q=h+"gapro.js",i=a.key?a.key:i.key,r=new a.utils.key(i).edition(),l=l?l:{};switch("ads"==r&&j.advertising&&(f.test(j.advertising.client)?l[j.advertising.client]=j.advertising:l[h+j.advertising.client+".js"]=j.advertising),delete k.advertising,k.key=i,j.analytics&&f.test(j.analytics.client)&&(n=j.analytics.client),delete k.analytics,m&&!("ads"===r||"enterprise"===r)&&delete m.enabled,"free"!=r&&m&&!1===m.enabled||(l[n]=m?m:{}),delete l.sharing,delete l.related,r){case"ads":case"enterprise":if(k.sitecatalyst)try{window.s&&window.s.hasOwnProperty("Media")?new a.embed.sitecatalyst(c):e()}catch(s){e()}case"premium":j.related&&(f.test(j.related.client)&&(p=j.related.client),l[p]=j.related),j.ga&&(f.test(j.ga.client)&&(q=j.ga.client),l[q]=j.ga);case"pro":j.sharing&&(f.test(j.sharing.client)&&(o=j.sharing.client),l[o]=j.sharing),j.skin&&(k.skin=j.skin.replace(/^(beelden|bekle|five|glow|modieus|roundster|stormtrooper|vapor)$/i,d.repo()+"skins/$1.xml"))}return k.plugins=l,c.config=k,c=new b(c),g&&c.errorScreen(g),c},a.embed),a.embed.html5CanPlay=function(b,d){var f,g={file:b,type:d};return f=a.html5&&a.html5.chooseProvider?a.html5.chooseProvider(g)!==a.html5.VideoProvider:e.any(a.unregisteredProviders,function(a){return a.supports(g)}),f?!0:c.apply(this,arguments)}}(jwplayer),function(a){var b=jwplayer.utils;a.sitecatalyst=function(a){function c(a){l.debug&&b.log(a)}function d(a){return a=a.split("/"),a=a[a.length-1],a=a.split("?"),a[0]}function e(){if(!n){n=!0;var a=k.getPosition();c("stop: "+g+" : "+a),s.Media.stop(g,a)}}function f(){o||(e(),o=!0,c("close: "+g),s.Media.close(g),j=!0,i=0)}var g,h,i,j,k=a,l=b.extend({},k.config.sitecatalyst),m={onPlay:function(){if(!j){var a=k.getPosition();n=!1,c("play: "+g+" : "+a),s.Media.play(g,a)}},onPause:e,onBuffer:e,onIdle:f,onPlaylistItem:function(a){try{j=!0,f(),i=0;var c;if(l.mediaName)c=l.mediaName;else{var e=k.getPlaylistItem(a.index);c=e.title?e.title:e.file?d(e.file):e.sources&&e.sources.length?d(e.sources[0].file):""}g=c,h=l.playerName?l.playerName:k.id}catch(m){b.log(m)}},onTime:function(){if(j){var a=k.getDuration();if(-1==a)return;o=n=j=!1,c("open: "+g+" : "+a+" : "+h),s.Media.open(g,a,h),c("play: "+g+" : 0"),s.Media.play(g,0)}if(a=k.getPosition(),3<=Math.abs(a-i)){var b=i;c("seek: "+b+" to "+a),c("stop: "+g+" : "+b),s.Media.stop(g,b),c("play: "+g+" : "+a),s.Media.play(g,a)}i=a},onComplete:f},n=!0,o=!0;b.foreach(m,function(a){k[a](m[a])})}}(jwplayer.embed),function(a){function b(a,b){a[b]&&(a[b]=c.getAbsolutePath(a[b]))}var c=a.utils,d=a._,e=window.location.href;a.cast.setupCastConfig=function(d,f){var g=c.extend({},d.config);g.cast=c.extend({pageUrl:e},f);for(var h="base autostart controls fallback fullscreen width height mobilecontrols modes playlistlayout playlistposition playlistsize primary stretching sharing related ga skin logo listbar events".split(" "),i=h.length;i--;)delete g[h[i]];h=g.plugins,delete g.plugins;for(var j in h)if(h.hasOwnProperty(j)){var k=h[j];if(k.client&&(/[\.\/]/.test(k.client)&&b(k,"client"),-1<k.client.indexOf("vast"))){if(i=g,k=c.extend({},k),k.client="vast",delete k.companiondiv,k.schedule){var l=void 0;for(l in k.schedule)k.schedule.hasOwnProperty(l)&&b(k.schedule[l].ad||k.schedule[l],"tag")}b(k,"tag"),i.advertising=k}}return d.position&&(g.position=d.position),0<d.item&&(g.item=d.item),g.captionLabel=c.getCookies().captionLabel,g.playerVersion=a.version,g},a.cast.setupFlashCastConfig=function(b){var e=b.config;e.playlist=b.getPlaylist();var f;return(f=d.find(e.plugins,function(a,b){return 0<b.indexOf("vast.js")}))?(f.client="vast",f={advertising:f}):f={},e=d.pick(e,"id captionLabel cast key playlist repeat".split(" ")),e.cast.pageUrl=window.location.href,c.extend(e,{playerVersion:a.version,captionLabel:c.getCookies().captionLabel,volume:b.getVolume(),mute:b.getMute(),id:b.id,position:b.getPosition(),item:b.getPlaylistIndex()},f),e}}(window.jwplayer),function(a,b){function c(a,b){a[b]&&(a[b]=e.getAbsolutePath(a[b]))}var d=b.cast,e=b.utils,f=b.events,g=f.state,h={};d.NS="urn:x-cast:com.longtailvideo.jwplayer",d.debug=!1,d.availability=null,d.available=function(b){b=b||d.availability;var c=a.chrome,e="available";return c.cast&&c.cast.ReceiverAvailability&&(e=c.cast.ReceiverAvailability.AVAILABLE),b===e},d.controller=function(i,j){function k(a,b){d.log("send command",a,b);var c={command:a};void 0!==b&&(c.args=b),I.sendMessage(d.NS,c,E,function(a){d.log("error message",a),"Invalid namespace"===a.description&&s()})}function l(a){a=!!d.available(a.availability),J.available!==a&&(J.available=a,p(f.JWPLAYER_CAST_AVAILABLE))}function m(a){d.log("existing session",a),!I&&!P&&(P=a.session,P.addMessageListener(d.NS,n))}function n(a,c){var e=JSON.parse(c);if(!e)throw"Message not proper JSON";if(e.reconcile){P.removeMessageListener(d.NS,n);var g=e.diff,h=P;g.id&&e.appid&&e.pageUrl||(g.id=b().id,e.appid=H.appid,e.pageUrl=L,P=I=null),g.id===i.id&&e.appid===H.appid&&e.pageUrl===L&&(I||(i.jwInstreamState()&&i.jwInstreamDestroy(!0),u(h),j.sendEvent(f.JWPLAYER_PLAYER_STATE,{oldstate:g.oldstate,newstate:g.newstate})),z(e)),P=null}}function o(a){J.active=!!a,a=J;var b;b=I&&I.receiver?I.receiver.friendlyName:"",a.deviceName=b,p(f.JWPLAYER_CAST_SESSION,{})}function p(a){var b=e.extend({},J);j.sendEvent(a,b)}function q(b){var c=a.chrome;b.code!==c.cast.ErrorCode.CANCEL&&(d.log("Cast Session Error:",b,I),b.code===c.cast.ErrorCode.SESSION_ERROR&&s())}function r(b){var c=a.chrome;b.code!==c.cast.ErrorCode.CANCEL&&(d.log("Cast Session Error:",b,I),b.code===c.cast.ErrorCode.SESSION_ERROR&&s())}function s(){I?(x(),I.stop(w,t),A({item:0}),z({type:"state",diff:{buffer:0,position:0,duration:0}})):w()}function t(a){d.error("Cast Session Stop error:",a,I),w()}function u(c){if(d.log("Session started:",c),I)s(),Q=c;else{I=c,I.addMessageListener(d.NS,y),I.addUpdateListener(v),i.jwPause(!0),i.jwSetFullscreen(!1),O=j.getVideo(),F=j.volume,G=j.mute,M=new d.provider(k),M.init(),j.setVideoProvider(M),i.jwPlay=function(a){!1===a?M.pause():M.play()},i.jwPause=function(a){i.jwPlay(!!a)},i.jwLoad=function(a){"number"===e.typeOf(a)&&j.setItem(a),M.load(a)},i.jwPlaylistItem=function(a){"number"===e.typeOf(a)&&j.setItem(a),M.playlistItem(a)},i.jwPlaylistNext=function(){i.jwPlaylistItem(j.item+1)},i.jwPlaylistPrev=function(){i.jwPlaylistItem(j.item-1)},i.jwSetVolume=function(a){e.exists(a)&&(a=0|Math.min(Math.max(0,a),100),C(a)&&(a=Math.max(0,Math.min(a/100,1)),I.setReceiverVolumeLevel(a,B,function(a){d.error("set volume error",a),B()})))},i.jwSetMute=function(a){e.exists(a)||(a=!K.mute),D(a)&&I.setReceiverMuted(!!a,B,function(a){d.error("set muted error",a),B()})},i.jwGetVolume=function(){return 0|K.volume},i.jwGetMute=function(){return!!K.mute},i.jwIsBeforePlay=function(){return!1};var h=i.jwSetCurrentCaptions;i.jwSetCurrentCaptions=function(a){h(a),M.sendCommand("caption",a)},i.jwSkipAd=function(a){N&&(N.skipAd(a),a=N.getAdModel(),a.complete=!0,j.sendEvent(f.JWPLAYER_CAST_AD_CHANGED,a))},i.jwClickAd=function(c){if(N&&300<N.timeSinceClick()&&(N.clickAd(c),j.state!==g.PAUSED)){var d={tag:c.tag};c.sequence&&(d.sequence=c.sequence),c.podcount&&(d.podcount=c.podcount),b(i.id).dispatchEvent(f.JWPLAYER_AD_CLICK,d),a.open(c.clickthrough)}},i.jwPlayAd=i.jwPauseAd=i.jwSetControls=i.jwForceState=i.jwReleaseState=i.jwSetFullscreen=i.jwDetachMedia=i.jwAttachMedia=E;var l=b(i.id).plugins;l.vast&&l.vast.jwPauseAd!==E&&(R={jwPlayAd:l.vast.jwPlayAd,jwPauseAd:l.vast.jwPauseAd},l.vast.jwPlayAd=l.vast.jwPauseAd=E),B(),o(!0),c!==P&&(M.setup(b.cast.setupCastConfig(j,H),j),b.cast.loader.sendDummyMedia(c))}}function v(a){d.log("Cast Session status",a),a?B():(M.sendEvent(f.JWPLAYER_PLAYER_STATE,{oldstate:j.state,newstate:g.BUFFERING}),w())}function w(){if(d.log("_sessionStopped"),I&&(x(),I=null),O){delete i.jwSkipAd,delete i.jwClickAd,i.initializeAPI();var a=b(i.id).plugins;a.vast&&e.extend(a.vast,R),j.volume=F,j.mute=G,j.setVideoProvider(O),j.duration=0,M&&(M.destroy(),M=null),N&&(N.destroy(),N=null),j.state!==g.IDLE?e.isIPad()||e.isIPod()?(i.jwStop(!0),O.sendEvent(f.JWPLAYER_PLAYER_STATE,{oldstate:g.BUFFERING,newstate:g.IDLE})):(j.state=g.IDLE,i.jwPlay(!0),i.jwSeek(j.position)):O.sendEvent(f.JWPLAYER_PLAYER_STATE,{oldstate:g.BUFFERING,newstate:g.IDLE}),O=null}o(!1),null!==Q&&(u(Q),Q=null)}function x(){I.removeUpdateListener(v),I.removeMessageListener(d.NS,y)}function y(a,b){var c=JSON.parse(b);if(!c)throw"Message not proper JSON";z(c)}function z(a){if("state"===a.type)N&&(a.diff.newstate||a.diff.position)&&(N.destroy(),N=null,j.setVideoProvider(M),j.sendEvent(f.JWPLAYER_CAST_AD_CHANGED,{done:!0})),M.updateModel(a.diff,a.type),A(a.diff);else if("ad"===a.type){null===N&&(N=new d.adprovider(d.NS,I),N.init(),j.setVideoProvider(N)),N.updateModel(a.diff,a.type);var b=N.getAdModel();a.diff.clickthrough&&(b.onClick=i.jwClickAd),a.diff.skipoffset&&(b.onSkipAd=i.jwSkipAd),j.sendEvent(f.JWPLAYER_CAST_AD_CHANGED,b),a.diff.complete&&N.resetAdModel()}else"connection"===a.type?!0===a.closed&&s():d.error("received unhandled message",a.type,a)}function A(a){void 0!==a.item&&j.item!==a.item&&(j.item=a.item,j.sendEvent(f.JWPLAYER_PLAYLIST_ITEM,{index:j.item}))}function B(){if(I&&I.receiver){var a=I.receiver.volume;if(a){var b=100*a.level|0;D(!!a.muted),C(b)}}}function C(a){var b=K.volume!==a;return b&&(K.volume=a,M.sendEvent(f.JWPLAYER_MEDIA_VOLUME,{volume:a})),b}function D(a){var b=K.mute!==a;return b&&(K.mute=a,M.sendEvent(f.JWPLAYER_MEDIA_MUTE,{mute:a})),b}function E(){}var F,G,H,I=null,J={available:!1,active:!1,deviceName:""},K={volume:null,mute:null},L=e.getAbsolutePath(a.location.href),M=null,N=null,O=null;F=j.volume,G=j.mute;var P=null,Q=null,R=null;H=e.extend({},h,j.cast),c(H,"loadscreen"),c(H,"endscreen"),c(H,"logo"),!H.appid||a.cast&&a.cast.receiver||(d.loader.addEventListener("availability",l),d.loader.addEventListener("session",m),d.loader.initialize(H.appid)),this.startCasting=function(){I||i.jwInstreamState()||a.chrome.cast.requestSession(u,q)},this.stopCasting=s,this.openExtension=function(){i.jwInstreamState()||a.chrome.cast.requestSession(u,r)}},d.log=function(){if(d.debug){var a=Array.prototype.slice.call(arguments,0);console.log.apply(console,a)}},d.error=function(){var a=Array.prototype.slice.call(arguments,0);console.error.apply(console,a)}}(window,jwplayer),function(a){function b(a){r.log("existing session",a),!q&&!o&&(o=a.session,o.addMessageListener(r.NS,c))}function c(b,d){var e=JSON.parse(d),f=o;if(!e)throw"Message not proper JSON";e.reconcile&&(o.removeMessageListener(r.NS,c),e.receiverFriendlyName=o.receiver.friendlyName,e.pageUrl&&e.diff.id&&e.appid||(e.pageUrl=x,e.diff.id=a().id,e.appid=n,o=q=null),v[e.diff.id]&&n===e.appid&&e.pageUrl===x&&(m=e.diff.id,n=e.appid,k(m,"jwInstreamDestroy"),g(f),k(m,w.message,e),o=null))}function d(){q&&(q.removeUpdateListener(j),q.removeMessageListener(r.NS,h),q.stop(e.bind(this),i.bind(this)),q=null),k(m,w.cleanup)}function e(){"undefined"!=typeof p&&null!==p&&(g(p),p=null)}function f(a,b){q.sendMessage(r.NS,{command:a,args:b},s.noop,function(a){r.error("message send error",a)})}function g(b){var c=a(m);q?(d(),p=b):(q=b,q.addMessageListener(r.NS,h),q.addUpdateListener(j),c=a.cast.setupFlashCastConfig(c),o!==q&&(f("setup",c),a.cast.loader.sendDummyMedia(q)),k(m,w.connected,{receiverFriendlyName:b.receiver.friendlyName}))}function h(a,b){if(b){var c=JSON.parse(b);if(!c)throw"Message not proper JSON";k(m,w.message,c)}}function i(a){k(m,w.error,a||{})}function j(a){a?l():d()}function k(b,c,d){d?a(b).callInternal(c,d):a(b).callInternal(c)}function l(){if(q&&q.receiver){var b=q.receiver.volume;if(b){var c=100*b.level|0,b=!!b.muted;a(m).setVolume(c).setMute(b)}}}var m,n,o,p,q,r=a.cast,s=a.utils,t=a._,u=window.chrome||{},v={},w={},x=s.getAbsolutePath(window.location.href);r.NS="urn:x-cast:com.longtailvideo.jwplayer",r.flash={checkAvailability:function(a,c,d){w=d,n=c,v[a]=!0,r.loader.addEventListener("availability",function(b){"available"===b.availability&&k(a,w.available,b)}),r.loader.addEventListener("session",b),r.loader.initialize(c)},startCasting:function(a){m=a,u.cast.requestSession(g.bind(this),i.bind(this))},stopCasting:d,openExtension:function(a){m=a,u.cast.requestSession(g.bind(this),i.bind(this))},mute:function(a){q.setReceiverMuted(a,l,function(a){r.error("set muted error",a)})},volume:function(a){a=Math.max(0,Math.min(a/100,1)),q.setReceiverVolumeLevel(a,l,function(a){r.error("set volume error",a)})},messageReceiver:f,canCastItem:function(b){return t.any(b.levels,function(b){return a.embed.html5CanPlay(b.file,b.type)||"hls"===b.type})}}}(window.jwplayer),function(a,b){function c(a){var c=new b.cast.media.MediaInfo("");c.contentType="video/mp4",c=new b.cast.media.LoadRequest(c),c.autoplay=!1,a.loadMedia(c)}function d(){b&&b.cast&&b.cast.isAvailable&&!k.apiConfig?(k.apiConfig=new b.cast.ApiConfig(new b.cast.SessionRequest(o),h,i,b.cast.AutoJoinPolicy.ORIGIN_SCOPED),b.cast.initialize(k.apiConfig,g,f)):15>n++&&setTimeout(d,1e3)}function e(){j&&(j.resetEventListeners(),j=null)}function f(){k.apiConfig=null}function g(){}function h(a){p.sendEvent("session",{session:a}),a.sendMessage(k.NS,{whoami:1}),0===a.media.length&&c(a)}function i(a){k.availability=a,p.sendEvent("availability",{availability:a})}window.chrome=b;var j,k=a.cast,l=a.utils,m=a.events,n=0,o=null,p=l.extend({initialize:function(a){o=a,null!==k.availability?p.sendEvent("availability",{availability:k.availability}):b&&b.cast?d():j||(j=new l.scriptloader("https://www.gstatic.com/cv/js/sender/v1/cast_sender.js"),j.addEventListener(m.ERROR,e),j.addEventListener(m.COMPLETE,d),j.load())}},new m.eventdispatcher("cast.loader"));a.cast.loader=p,a.cast.loader.sendDummyMedia=c}(window.jwplayer,window.chrome||{}),function(a,b){var c=[],d=a.utils,e=a.events,f=a._,g=0,h=e.state,i="getBuffer getCaptionsList getControls getCurrentCaptions getCurrentQuality getCurrentAudioTrack getDuration getFullscreen getHeight getLockState getMute getPlaylistIndex getSafeRegion getPosition getQualityLevels getState getVolume getWidth isBeforeComplete isBeforePlay releaseState".split(" "),j="playlistNext stop forceState playlistPrev seek setCurrentCaptions setControls setCurrentQuality setVolume setCurrentAudioTrack".split(" "),k={onBufferChange:e.JWPLAYER_MEDIA_BUFFER,onBufferFull:e.JWPLAYER_MEDIA_BUFFER_FULL,onError:e.JWPLAYER_ERROR,onSetupError:e.JWPLAYER_SETUP_ERROR,onFullscreen:e.JWPLAYER_FULLSCREEN,onMeta:e.JWPLAYER_MEDIA_META,onMute:e.JWPLAYER_MEDIA_MUTE,onPlaylist:e.JWPLAYER_PLAYLIST_LOADED,onPlaylistItem:e.JWPLAYER_PLAYLIST_ITEM,onPlaylistComplete:e.JWPLAYER_PLAYLIST_COMPLETE,onReady:e.API_READY,onResize:e.JWPLAYER_RESIZE,onComplete:e.JWPLAYER_MEDIA_COMPLETE,onSeek:e.JWPLAYER_MEDIA_SEEK,onTime:e.JWPLAYER_MEDIA_TIME,onVolume:e.JWPLAYER_MEDIA_VOLUME,onBeforePlay:e.JWPLAYER_MEDIA_BEFOREPLAY,onBeforeComplete:e.JWPLAYER_MEDIA_BEFORECOMPLETE,onDisplayClick:e.JWPLAYER_DISPLAY_CLICK,onControls:e.JWPLAYER_CONTROLS,onQualityLevels:e.JWPLAYER_MEDIA_LEVELS,onQualityChange:e.JWPLAYER_MEDIA_LEVEL_CHANGED,onCaptionsList:e.JWPLAYER_CAPTIONS_LIST,onCaptionsChange:e.JWPLAYER_CAPTIONS_CHANGED,onAdError:e.JWPLAYER_AD_ERROR,onAdClick:e.JWPLAYER_AD_CLICK,onAdImpression:e.JWPLAYER_AD_IMPRESSION,onAdTime:e.JWPLAYER_AD_TIME,onAdComplete:e.JWPLAYER_AD_COMPLETE,onAdCompanions:e.JWPLAYER_AD_COMPANIONS,onAdSkipped:e.JWPLAYER_AD_SKIPPED,onAdPlay:e.JWPLAYER_AD_PLAY,onAdPause:e.JWPLAYER_AD_PAUSE,onAdMeta:e.JWPLAYER_AD_META,onCast:e.JWPLAYER_CAST_SESSION,onAudioTrackChange:e.JWPLAYER_AUDIO_TRACK_CHANGED,onAudioTracks:e.JWPLAYER_AUDIO_TRACKS},l={onBuffer:h.BUFFERING,onPause:h.PAUSED,onPlay:h.PLAYING,onIdle:h.IDLE};a.api=function(g){function m(a,b){d.foreach(a,function(a,c){t[a]=function(a){return b(c,a)}})}function n(a,b){var c="jw"+b.charAt(0).toUpperCase()+b.slice(1);t[b]=function(){var b=q.apply(this,[c].concat(Array.prototype.slice.call(arguments,0)));return a?t:b}}function o(a,b){try{a.jwAddEventListener(b,'function(dat) { jwplayer("'+t.id+'").dispatchEvent("'+b+'", dat); }')}catch(c){if("flash"===t.renderingMode){var e=document.createElement("a");e.href=r.data,e.protocol!==location.protocol&&d.log("Warning: Your site ["+location.protocol+"] and JWPlayer ["+e.protocol+"] are hosted using different protocols")}d.log("Could not add internal listener")}}function p(a,b){return u[a]||(u[a]=[],r&&w&&o(r,a)),u[a].push(b),t}function q(){if(w){if(r){var a=Array.prototype.slice.call(arguments,0),b=a.shift();if("function"==typeof r[b]){switch(a.length){case 6:return r[b](a[0],a[1],a[2],a[3],a[4],a[5]);case 5:return r[b](a[0],a[1],a[2],a[3],a[4]);case 4:return r[b](a[0],a[1],a[2],a[3]);case 3:return r[b](a[0],a[1],a[2]);case 2:return r[b](a[0],a[1]);case 1:return r[b](a[0])}return r[b]()}}return null}x.push(arguments)}var r,s,t=this,u={},v={},w=!1,x=[],y={},z={};return t.container=g,t.id=g.id,t.setup=function(b){if(a.embed){a.api.destroyPlayer(t.id);var c=new a.api(t.container);return a.api.addPlayer(c),c.config=b,c._embedder=new a.embed(c),c._embedder.embed(),c}return t},t.getContainer=function(){return t.container},t.addButton=function(a,b,c,e){try{z[e]=c,q("jwDockAddButton",a,b,'jwplayer("'+t.id+'").callback("'+e+'")',e)}catch(f){d.log("Could not add dock button"+f.message)}},t.removeButton=function(a){q("jwDockRemoveButton",a)},t.callback=function(a){z[a]&&z[a]()},t.getMeta=function(){return t.getItemMeta()},t.getPlaylist=function(){var a=q("jwGetPlaylist");return"flash"===t.renderingMode&&d.deepReplaceKeyName(a,["__dot__","__spc__","__dsh__","__default__"],["."," ","-","default"]),a},t.getPlaylistItem=function(a){return d.exists(a)||(a=t.getPlaylistIndex()),t.getPlaylist()[a]},t.getRenderingMode=function(){return t.renderingMode},t.setFullscreen=function(a){return d.exists(a)?q("jwSetFullscreen",a):q("jwSetFullscreen",!q("jwGetFullscreen")),t},t.setMute=function(a){return d.exists(a)?q("jwSetMute",a):q("jwSetMute",!q("jwGetMute")),t},t.lock=function(){return t},t.unlock=function(){return t},t.load=function(b){return q("jwInstreamDestroy"),a(t.id).plugins.googima&&q("jwDestroyGoogima"),q("jwLoad",b),t},t.playlistItem=function(a){return q("jwPlaylistItem",parseInt(a,10)),t},t.resize=function(a,b){if("flash"!==t.renderingMode)q("jwResize",a,b);else{var c=document.getElementById(t.id+"_wrapper"),e=document.getElementById(t.id+"_aspect");e&&(e.style.display="none"),c&&(c.style.display="block",c.style.width=d.styleDimension(a),c.style.height=d.styleDimension(b))}return t},t.play=function(a){if(a!==b)return q("jwPlay",a),t;a=t.getState();var c=s&&s.getState();return c&&q(c===h.IDLE||c===h.PLAYING||c===h.BUFFERING?"jwInstreamPause":"jwInstreamPlay"),q(a===h.PLAYING||a===h.BUFFERING?"jwPause":"jwPlay"),t},t.pause=function(a){return a===b?(a=t.getState(),q(a===h.PLAYING||a===h.BUFFERING?"jwPause":"jwPlay")):q("jwPause",a),t},t.createInstream=function(){return new a.api.instream(this,r)},t.setInstream=function(a){return s=a},t.loadInstream=function(a,b){return s=t.setInstream(t.createInstream()).init(b),s.loadItem(a),s},t.destroyPlayer=function(){w=!0,q("jwPlayerDestroy")},t.playAd=function(b){var c=a(t.id).plugins;c.vast?c.vast.jwPlayAd(b):q("jwPlayAd",b)},t.pauseAd=function(){var b=a(t.id).plugins;b.vast?b.vast.jwPauseAd():q("jwPauseAd")},m(l,function(a,b){return v[a]||(v[a]=[],p(e.JWPLAYER_PLAYER_STATE,function(b){var c=b.newstate;
if(b=b.oldstate,c===a){var d=v[c];if(d)for(var e=0;e<d.length;e++){var f=d[e];"function"==typeof f&&f.call(this,{oldstate:b,newstate:c})}}})),v[a].push(b),t}),m(k,p),d.foreach(i,function(a,b){n(!1,b)}),d.foreach(j,function(a,b){n(!0,b)}),t.remove=function(){this._embedder&&this._embedder.destroy&&this._embedder.destroy(),x=[];var a=1<f.size(f.where(c,{id:t.id}));a||d.clearCss("#"+t.id);var b=document.getElementById(t.id+("flash"===t.renderingMode?"_wrapper":""));if(b){if("html5"===t.renderingMode)t.destroyPlayer();else if(d.isMSIE(8)){var e=document.getElementById(t.id);if(e&&e.parentNode){e.style.display="none";for(var g in e)"function"==typeof e[g]&&(e[g]=null);e.parentNode.removeChild(e)}}a||(a=document.createElement("div"),a.id=t.id,b.parentNode.replaceChild(a,b))}c=f.filter(c,function(a){return a.uniqueId!==t.uniqueId})},t.registerPlugin=function(b,c,d,e){a.plugins.registerPlugin(b,c,d,e)},t.setPlayer=function(a,b){r=a,t.renderingMode=b},t.detachMedia=function(){return"html5"===t.renderingMode?q("jwDetachMedia"):void 0},t.attachMedia=function(a){return"html5"===t.renderingMode?q("jwAttachMedia",a):void 0},t.getAudioTracks=function(){return q("jwGetAudioTracks")},t.removeEventListener=function(a,b){var c=u[a];if(c)for(var d=c.length;d--;)c[d]===b&&c.splice(d,1)},t.dispatchEvent=function(a,b){var c=u[a];if(c)for(var c=c.slice(0),f=d.translateEventResponse(a,b),g=0;g<c.length;g++){var h=c[g];if("function"==typeof h)try{a===e.JWPLAYER_PLAYLIST_LOADED&&d.deepReplaceKeyName(f.playlist,["__dot__","__spc__","__dsh__","__default__"],["."," ","-","default"]),h.call(this,f)}catch(i){d.log("There was an error calling back an event handler",i)}}},t.dispatchInstreamEvent=function(a){s&&s.dispatchEvent(a,arguments)},t.callInternal=q,t.playerReady=function(a){for(w=!0,r||t.setPlayer(document.getElementById(a.id)),t.container=document.getElementById(t.id),d.foreach(u,function(a){o(r,a)}),p(e.JWPLAYER_PLAYLIST_ITEM,function(){y={}}),p(e.JWPLAYER_MEDIA_META,function(a){d.extend(y,a.metadata)}),p(e.JWPLAYER_VIEW_TAB_FOCUS,function(a){var b=t.getContainer();!0===a.hasFocus?d.addClass(b,"jw-tab-focus"):d.removeClass(b,"jw-tab-focus")}),t.dispatchEvent(e.API_READY);0<x.length;)q.apply(t,x.shift())},t.getItemMeta=function(){return y},t},a.playerReady=function(b){var c=a.api.playerById(b.id);c||(c=a.api.selectPlayer(b.id)),c.playerReady(b)},a.api.selectPlayer=function(b){var e;return d.exists(b)||(b=0),b.nodeType?e=b:"string"==typeof b&&(e=document.getElementById(b)),e?(b=a.api.playerById(e.id))?b:new a.api(e):"number"==typeof b?c[b]:null},a.api.playerById=function(a){for(var b=0;b<c.length;b++)if(c[b].id===a)return c[b];return null},a.api.addPlayer=function(a){for(var b=0;b<c.length;b++)if(c[b]===a)return a;return g++,a.uniqueId=g,c.push(a),a},a.api.destroyPlayer=function(a){a=f.where(c,{id:a}),f.each(a,f.partial(f.result,f,"remove"))}}(window.jwplayer),function(a){var b=a.events,c=a.utils,d=b.state;a.api.instream=function(a,e){function f(b,c){return j[b]||(j[b]=[],e.jwInstreamAddEventListener(b,'function(dat) { jwplayer("'+a.id+'").dispatchInstreamEvent("'+b+'", dat); }')),j[b].push(c),this}function g(a,c){return k[a]||(k[a]=[],f(b.JWPLAYER_PLAYER_STATE,function(b){var c=b.newstate,d=b.oldstate;if(c===a){var e=k[c];if(e)for(var f=0;f<e.length;f++){var g=e[f];"function"==typeof g&&g.call(this,{oldstate:d,newstate:c,type:b.type})}}})),k[a].push(c),this}var h,i,j={},k={},l=this;l.type="instream",l.init=function(){return a.callInternal("jwInitInstream"),l},l.loadItem=function(b,d){h=b,i=d||{},"array"===c.typeOf(b)?a.callInternal("jwLoadArrayInstream",h,i):a.callInternal("jwLoadItemInstream",h,i)},l.removeEvents=function(){j=k={}},l.removeEventListener=function(a,b){var c=j[a];if(c)for(var d=c.length;d--;)c[d]===b&&c.splice(d,1)},l.dispatchEvent=function(a,b){var d=j[a];if(d)for(var d=d.slice(0),e=c.translateEventResponse(a,b[1]),f=0;f<d.length;f++){var g=d[f];"function"==typeof g&&g.call(this,e)}},l.onError=function(a){return f(b.JWPLAYER_ERROR,a)},l.onMediaError=function(a){return f(b.JWPLAYER_MEDIA_ERROR,a)},l.onFullscreen=function(a){return f(b.JWPLAYER_FULLSCREEN,a)},l.onMeta=function(a){return f(b.JWPLAYER_MEDIA_META,a)},l.onMute=function(a){return f(b.JWPLAYER_MEDIA_MUTE,a)},l.onComplete=function(a){return f(b.JWPLAYER_MEDIA_COMPLETE,a)},l.onPlaylistComplete=function(a){return f(b.JWPLAYER_PLAYLIST_COMPLETE,a)},l.onPlaylistItem=function(a){return f(b.JWPLAYER_PLAYLIST_ITEM,a)},l.onTime=function(a){return f(b.JWPLAYER_MEDIA_TIME,a)},l.onBuffer=function(a){return g(d.BUFFERING,a)},l.onPause=function(a){return g(d.PAUSED,a)},l.onPlay=function(a){return g(d.PLAYING,a)},l.onIdle=function(a){return g(d.IDLE,a)},l.onClick=function(a){return f(b.JWPLAYER_INSTREAM_CLICK,a)},l.onInstreamDestroyed=function(a){return f(b.JWPLAYER_INSTREAM_DESTROYED,a)},l.onAdSkipped=function(a){return f(b.JWPLAYER_AD_SKIPPED,a)},l.play=function(a){e.jwInstreamPlay(a)},l.pause=function(a){e.jwInstreamPause(a)},l.hide=function(){a.callInternal("jwInstreamHide")},l.destroy=function(){l.removeEvents(),a.callInternal("jwInstreamDestroy")},l.setText=function(a){e.jwInstreamSetText(a?a:"")},l.getState=function(){return e.jwInstreamState()},l.setClick=function(a){e.jwInstreamClick&&e.jwInstreamClick(a)}}}(jwplayer),function(a){var b=a.api,c=b.selectPlayer,d=a._;b.selectPlayer=function(b){var d=c.apply(this,arguments);return d?d:{registerPlugin:function(b,c,d){"jwpsrv"!==b&&a.plugins.registerPlugin(b,c,d)}}},a.unregisteredProviders=[],b.registerProvider=function(b){a&&a.html5&&d.isFunction(a.html5.registerProvider)?a.html5.registerProvider(b):a.unregisteredProviders.push(b)}}(jwplayer)),jwplayer.key="8ZEJ4ezwrpWZovJqzfloVK7xgaAb+jJwnYS9YQ==","https:"===location.protocol?jwplayer.defaults={flashplayer:"https://ssl.p.jwpcdn.com/6/12/jwplayer.flash.swf",html5player:"https://ssl.p.jwpcdn.com/6/12/jwplayer.html5.js",ph:1}:jwplayer.defaults={flashplayer:"http://p.jwpcdn.com/6/12/jwplayer.flash.swf",html5player:"http://p.jwpcdn.com/6/12/jwplayer.html5.js",ph:1},define("jwPlayer",["angular"],function(){}),define("directives/common/pt-playerjw",["app","text!views/directives/common/pt-playerjw.html"],function(a,b){a.directive("ptPlayerjw",[function(){return{restrict:"A",template:b,scope:{params:"=",isopen:"="},controller:["$scope",function(a){require(["jwPlayer"],function(){jwplayer.key="cAr98kB89aA0ZhpVmJqMLQGxXGRUXKjW3Z9DlufTILI=",a.isopen&&(a.mode="list",jwplayer("playerGVtPteKoWxwx").setup(a.params))})}]}}])}),define("directives/common/pt-carousel",["app","text!views/directives/common/pt-carousel.html","directives/common/pt-enquireForm","directives/common/pt-property-config-overlay","services/fullScreenService","formatters/common","services/constants","directives/common/pt-loading-block","directives/common/pt-youtube","parsers/imageParser","directives/common/pt-playerjw"],function(a,b){a.directive("ptImagecarousel",["$location",function(a){return{restrict:"A",scope:{images:"=",settings:"=",imagesfullview:"=",index:"=",focus:"@",unique:"=",leadData:"=",has3dimages:"=",floorplanlisting:"=",landmarkcount:"=",ispropertypage:"="},template:b,link:function(b,c){var d=!0;b.focus&&(d=b.focus),d===!0&&""===a.hash()&&window.setTimeout(function(){$(c[0].children[0]).focus()},1e3)},controller:["$scope","$rootScope","$element","$attrs","$timeout","FullScreenService","Formatter","Constants","$modal","ImageParser",function(a,b,c,d,e,f,g,h,i,j){var k,l,m,n,o,p,q=null,r=!1,s=function(){a.totalImages=0,a.carouselSteps=0,l=0,m=0,a.carouselWidth=0,a.carouselWidth=0};a.leadConfig={isModal:!1,cEnabled:!1,lEnabled:!1,showForm:!1},a.leadConfig.showform=!1,a.options={skin:"",width:1150,height:300,imageWidth:320,imageHeight:240,width100Proc:!1,height100Proc:!1,fadeSlides:!0,responsive:!0,responsiveRelativeToBrowser:!0,numberOfThumbsPerScreen:0,showBottomNav:!0,ptzoomControlVisible:!1,thumbnailWidth:60,thumbnailHeight:40,thumbnailMargin:5,showLabel:!0},a.$on("$destroy",function(){$(window).unbind("resize")}),a.$on("closeCarouselLead",function(){a.leadConfig.showform=!1}),a.openform=function(){a.leadConfig.showform=!0},a.closeform=function(){a.leadConfig.showform=!1},a.$on("leadpushed",function(){a.closeform()});var t=function(){var c=v();if(q)if(b.floorImageType3dImg===!0&&q.floor3dImage||b.floorImageTypeWT===!0&&q.walkThrough){var d=w();p=d.floorwidth,o=d.floorheight,a.calWidth=d.floorwidth,a.calHeight=d.floorheight}else p=c.width,o=c.height,a.calWidth=c.width,a.calHeight=c.height},u=function(){t(),a.zoomLevel=1,a.calLeft="inherit",a.calTop="inherit",c.find(".image-info").css("top","inherit"),c.find(".image-info").css("left","inherit"),a.isZoomIn="",a.isZoomOut="disabled",a.isZoomReset="disabled"},v=function(){var b,c,d,e,f,g,i;q&&(b=parseInt(h.IMAGES.LARGE.width)/parseInt(q.width),c=parseInt(h.IMAGES.LARGE.height)/parseInt(q.height),d=c>b?b:c,e=q.height*d,f=q.width*d,b=parseInt(a.options.height)/parseInt(e),c=parseInt(a.options.width)/parseInt(f),d=c>b?b:c,g=e*d,i=f*d);var j={};return q&&(g>e||q.height<g)?e>q.height?j.height=parseInt(q.height):j.height=parseInt(e):j.height=parseInt(g),q&&(i>f||q.width<i)?f>q.width?j.width=parseInt(q.width):j.width=parseInt(f):j.width=parseInt(i),j},w=function(){q.floor3DImageWidth=q.floor3DImageWidth?q.floor3DImageWidth:q.walkThroughWidth,q.floor3DImageHeight=q.floor3DImageHeight?q.floor3DImageHeight:q.walkThroughHeight;var b,c,d,e,f,g,i;q&&(b=parseInt(h.IMAGES.LARGE.width)/parseInt(q.floor3DImageWidth),c=parseInt(h.IMAGES.LARGE.height)/parseInt(q.floor3DImageHeight),d=c>b?b:c,e=q.floor3DImageHeight*d,f=q.floor3DImageWidth*d,b=parseInt(a.options.height)/parseInt(e),c=parseInt(a.options.width)/parseInt(f),d=c>b?b:c,g=e*d,i=f*d);var j={};return g>e||q.floor3DImageHeight<g?e>q.floor3DImageHeight?j.floorheight=parseInt(q.floor3DImageHeight):j.floorheight=parseInt(e):j.floorheight=parseInt(g),i>f||q.floor3DImageWidth<i?f>q.floor3DImageWidth?j.floorwidth=parseInt(q.floor3DImageWidth):j.floorwidth=parseInt(f):j.floorwidth=parseInt(i),j};a.ZoomIn=function(){a.zoomLevel<4&&(a.zoomLevel++,x())},a.ZoomOut=function(){a.zoomLevel>2?(a.zoomLevel--,x()):u()};var x=function(){var b,c,d,e;if(t(),b=Math.round(p*a.zoomLevel*.55),c=Math.round(o*a.zoomLevel*.55),"inherit"==a.calLeft)d=a.calWidth-b/2,e=a.calHeight-c/2;else{var f=b/a.calWidth,g=a.calWidth/2,h=a.calHeight/2;d=g-g*f,e=h-h*f}a.calWidth=b,a.calHeight=c,a.calLeft=d+"px",a.calTop=e+"px",a.zoomLevel>0&&(a.isZoomIn="",a.isZoomOut="",a.isZoomReset=""),a.zoomLevel>3?(a.isZoomIn="disabled",a.isZoomOut=""):a.zoomLevel<=0&&(a.isZoomIn="",a.isZoomOut="disabled",a.isZoomReset="disabled")};a.ZoomReset=function(){u()};var y=[["floorImageTypeWT","walkThrough"],["floorImageType3dImg","floor3dImage"],["floorImageTypeImg","largeImage"]],z=function(){for(var c=0;3>c;c++)if(a.ptslides[a.currentIndex][y[c][1]]){b[y[c%3][0]]=!0,b[y[(c+1)%3][0]]=!1,b[y[(c+2)%3][0]]=!1;break}},A=function(){if(b.userChoice&&a.ptslides[a.currentIndex][b.userChoice]){for(var c=0;3>c;c++)if(b.userChoice===y[c][1]){b[y[c%3][0]]=!0,b[y[(c+1)%3][0]]=!1,b[y[(c+2)%3][0]]=!1;break}}else z()};a.$on("galaryclose",function(){a.options.height100Proc=!1,b.userChoice=null,z()}),a.Next=function(){k=a.currentIndex,a.currentIndex<a.totalImages-1?a.currentIndex++:a.currentIndex=0,F(),a.ptslides[a.currentIndex]&&D(a.ptslides[a.currentIndex],1),a.ptslides[k]&&E(a.ptslides[k]),B(),a.ptslides[a.currentIndex]&&(A(k),a.svg_details=g.isSvgDetail(a.ptslides[a.currentIndex].svg_details))},a.Previous=function(){k=a.currentIndex,a.currentIndex>0?a.currentIndex--:a.currentIndex=a.totalImages-1,F(),a.ptslides[a.currentIndex]&&D(a.ptslides[a.currentIndex],-1),a.ptslides[k]&&E(a.ptslides[k]),B(),a.ptslides[a.currentIndex]&&(A(k),a.svg_details=g.isSvgDetail(a.ptslides[a.currentIndex].svg_details))};var B=function(){a.options.height100Proc&&b.$broadcast("imageChange",{id:a.unique,index:a.currentIndex}),q.video?a.isloadervisible=!1:a.isloadervisible=!0,a.set3DimageFloorSize(q)};a.$on("imageChange",function(b,c){r=!0,c.id==a.unique&&a.SetImage(c.index)}),a.openConfigOverlay=function(){a.configOverlay=!0},a.closeConfigOverlay=function(){a.configOverlay=!1},a.currentIconIndex=null,a.currentRowIndex=0;var C=function(a,b){var c,d=-1;return angular.forEach(b,function(b,e){a>=b.startindex&&d<b.startindex&&(c=e,d=b.startindex)}),c};"undefined"==typeof b.floorImageType3dImg&&(b.floorImageType3dImg=!0),a.SetImage=function(b,c,d,e,f){var h;a.floorPlanStartingIndex>=0&&(a.selectedProperty=a.overlayConfig[b-a.floorPlanStartingIndex],h=b-a.floorPlanStartingIndex),a.selectedconstructionImage=a.constructionDetail.config[C(b,a.constructionDetail.config)],a.selectedneighborImage=a.neighbourDetail.config[C(b,a.neighbourDetail.config)],a.selectedRow[0]=0===a.currentRowIndex?"selectedRow":"";var i=0;if("undefined"!=typeof h&&a.currentRowIndex!==h){for(a.currentRowIndex=h,i=0;i<a.selectedRow.length;i++)a.selectedRow[i]="";a.selectedRow[a.currentRowIndex]="selectedRow"}if(d&&d.preventDefault(),e)for(i=0;i<a.iconClassIndex.length;i++)a.iconClassIndex[i]="";if(a.currentIndex!=b){var j;j=b>a.currentIndex?1:-1,k=a.currentIndex,b>=0&&b<a.totalImages&&(a.currentIndex=b,F(c)),a.ptslides[a.currentIndex]&&D(a.ptslides[a.currentIndex],j),a.ptslides[k]&&E(a.ptslides[k]),B(),a.ptslides[a.currentIndex]&&(A(k),a.svg_details=g.isSvgDetail(a.ptslides[a.currentIndex].svg_details))}},a.keypress=function(b){37===b.which&&(a.Previous(),b.preventDefault()),39===b.which&&(a.Next(),b.preventDefault())};var D=function(b,c){b&&(q=b,b.visible=!0,b.thumbClass="thumbsHolder_ThumbOFF thumbsHolder_ThumbON",b.imageClass="currentImage",-1==c?q.slideClass="carouselSlideInLeft":q.slideClass="carouselSlideInRight"),$.each(a.buckets,function(b,c){a.currentIndex>=c.minRange&&a.currentIndex<=c.maxRange?(c["class"]="selected",a.type=c.name,a.hideswitch="Floor Plans"===a.type?!0:!1):c["class"]=""}),u(),q&&q.walkThrough&&(a.params={sources:q.walkThrough,image:q.walkThroughThumb,height:"100%",width:"100%",autostart:"false",ga:{}}),a.ptslides[a.currentIndex]&&A(),a.ptslides[a.currentIndex]&&(a.svg_details=g.isSvgDetail(a.ptslides[a.currentIndex].svg_details))},E=function(b){for(var c=0;c<a.ptslides.length;c++)c!=a.currentIndex&&(a.ptslides[c].visible=!1,a.ptslides[c].thumbClass="thumbsHolder_ThumbOFF",a.ptslides[c].imageClass="")},F=function(b){a.currentIndex>=l*m?(l+=1,F(),b?e(function(){G()},1500):G()):a.currentIndex<l*m-m&&(l-=1,F(),b?e(function(){G()},1500):G())};a.scrollThumbnailsLeft=function(){l>=a.carouselSteps||(l+=1,G())},a.scrollThumbnailsRight=function(){1>=l||(l-=1,G())};var G=function(){var b=-1*(a.carouselVisibleWidth*(l-1)),d="px",e=b+d;$(c).find(".carouselIndicators").animate({left:e},800),a.rightScrollClass="",a.leftScrollClass="",1>=l?a.leftScrollClass="carouselLeftNavDisabled":l>=a.carouselSteps&&(a.rightScrollClass="carouselRightNavDisabled")},H=null;a.toggelThumbviewer=function(){var b=($($(".imagerContainer")[$(".imagerContainer").length-1]),$($(".pt-carousel-collection")[$(".pt-carousel-collection").length-1])),c=$($(".pt-thums-img-gallery")[$(".pt-thums-img-gallery").length-1]),d=$($(".image-info")[$(".image-info").length-1]);a.hidethumbs?(c.animate({height:H},1e3),b.animate({height:b.height()-H},1e3),d.animate({top:0},1e3),a.hidethumbs=!1):(H=c.height(),b.animate({height:b.height()+H-1},1e3),c.animate({height:1},1e3),1===a.zoomLevel&&d.animate({top:H/2},1e3),a.hidethumbs=!0)},a.toggleform=function(){var b=$($(".pt-carousel-right-panel")[$(".pt-carousel-right-panel").length-1]);a.collapseleadform?(b.animate({right:0},1e3),a.collapseleadform=!1):(b.animate({right:-b.width()},1e3),a.collapseleadform=!0)};var I=function(){var b,c;m=parseInt(a.options.width/(a.options.thumbnailWidth+a.options.thumbnailMargin)),a.carouselSteps=a.totalImages/m,c=a.totalImages/m,b=parseInt(c),c>b&&(b+=1),a.carouselSteps=b,a.carouselWidth=a.totalImages*(a.options.thumbnailWidth+2*a.options.thumbnailMargin),a.carouselVisibleWidth=m*(a.options.thumbnailWidth+a.options.thumbnailMargin)+a.options.thumbnailMargin},J=function(){a.buckets=[];var b,c=0;for(b=0;a.currentImageObject&&b<a.currentImageObject.length;b++)a.buckets[b]={},a.buckets[b].name=a.currentImageObject[b].index+" ("+a.currentImageObject[b].data.length+")",a.buckets[b].minRange=c,a.buckets[b]["class"]="",c+=a.currentImageObject[b].data.length,a.buckets[b].maxRange=c-1};a.expand=function(){var b=f.openGallery(a.images,a.currentIndex,a.unique,a.leadData,a.has3dimages,a.floorplanlisting,a.landmarkcount);b.result.then(function(a){$(c[0].children[0]).focus()},function(){$(c[0].children[0]).focus()})};var K=function(){var a=new Date,b=a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear()+" "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds();return b},L=function(a,b){a=new Date(a),b=new Date(b);var c=b.getTime()-a.getTime(),d={};return d.seconds=Math.floor(c/1e3),d},M=function(a){return a=a.toLowerCase(),a.replace(/(?:^|\s)\w/g,function(a){return a.toUpperCase()})};a.svg_mouseenter=function(b,c,d,e,f,g,h,i){$("."+b).css("opacity",.3),a.set_toolip(c,d,e,f,g,h,i)},a.svg_mouseout=function(a){$("."+a).css("opacity",.01),$(".floor_detail_tooltip").hide(1),$(".tooltip_arrow").css("visibility","hidden")};var N=function(a){return 2===a.length?Math.round(.12*a)+"''":1===a.length?Math.round(1.2*a)+"''":""};a.set_toolip=function(a,b,c,d,e,f,g){if($(".floor_tooltip .header").html(a),e){var h=e.split(".");h[0]&&(e=h[0]+"'"),h[1]&&(e+=N(h[1]))}else e="";if(f){var i=f.split(".");i[0]&&(f=i[0]+"'"),i[1]&&(f+=N(i[1]))}else f="";"Balcony"===a&&f?$(".floor_tooltip .content .details").html("Size : "+f+" ft wide"):f&&e&&"Balcony"!=a?$(".floor_tooltip .content .details").html("Size : "+e+"x"+f+" ft"):$(".floor_tooltip .content .details").html("Size : "),g?"Balcony"===a?$(".floor_tooltip .content .tip").text(""):$(".floor_tooltip .content .tip").text("Click for 360' Vtour"):$(".floor_tooltip .content .tip").text(""),"Top"===b?$(".floor_detail_tooltip").css({left:d-5+"%",top:"initial",bottom:81-c+"%",right:"initial"}):"Left"===b?$(".floor_detail_tooltip").css({left:"initial",top:c+"%",bottom:"initial",right:80-d+"%"}):"Bottom"===b?$(".floor_detail_tooltip").css({left:d-3+"%",top:c-1+"%",right:"initial",bottom:"initial"}):"Right"===b&&$(".floor_detail_tooltip").css({left:d-1+"%",top:c-1+"%",right:"initial",bottom:"initial"}),$(".floor_detail_tooltip, .floor_tooltip").show(1),$(".position_"+b).css("visibility","visible")},a.expandTour=function(c,d,e,f,g){if(e&&"Balcony"!=g){f?e=e+"?q="+f:e+="?q=",c=c?c:b.projId;var h=K(),j=M(a.ptslides[0].mainTitle)+", "+d+" "+M(a.ptslides[0].locality+", "+a.ptslides[0].city),k=$(window).height()-41,l=$(window).width();i.open({template:'<div class="threeDcaro-close-btn" ng-click="cancel()"><i class="pt pt-icon-times"></i></div><div class="threeDBottomText">This virtual tour is an artistic impression of the apartment. It may not be exact representation.</div><div class="threeDcaro-exit-tour"><button class="btn-action" ng-click="cancel()">Exit Tour</button></div><div><div class="threeD-buil-text-info">'+j+'</div><iframe id="iframe" src='+e+' height="'+k+'" width="'+l+'"></iframe></div>',windowClass:"threeDModalGallery",controller:["$scope","$modalInstance",function(a,b){a.cancel=function(){var a=K(),c=L(h,a);c.seconds,b.dismiss("cancel")}}]})}},a.closeFullView=function(){a.height100Proc&&a.collapse()},$(window).bind("resize",function(){a.$apply(function(){O()})});var O=function(){if(s(),J(),a.settings&&(a.options=$.extend(a.options,a.settings)),a.options.responsiveRelativeToBrowser)var b=$(window).width(),c=$(window).height();a.options.width100Proc&&(a.options.width=b),a.options.height100Proc?(a.options.height=c-a.options.thumbnailHeight-40,a.options.divHeight=c-a.options.thumbnailHeight-40):a.options.divHeight=a.calHeight+10,"inherit"===a.calWidth&&(a.options.divWidth=a.width+10),a.options.divWidth=a.calWidth+10,k=0,l=1,a.leftScrollClass="carouselLeftNavDisabled",a.totalImages=a.ptslides.length,D(a.ptslides[a.currentIndex]),I(),E(),a.index>=0?a.SetImage(a.index,!0):a.ispropertypage&&a.floorPlanStartingIndex&&a.SetImage(a.floorPlanStartingIndex,!0)};a.imageLoaded=function(){a.isloadervisible=!1},a.set3DimageFloorSize=function(c,d){var e=v();if(d!==!0)if(b.floorImageType3dImg===!0&&c.floor3dImage||b.floorImageTypeWT===!0&&c.walkThrough){var f=w();a.calWidth=f.floorwidth,a.calHeight=f.floorheight}else a.calWidth=e.width,a.calHeight=e.height;else{var f=w();a.calWidth=f.floorwidth,a.calHeight=f.floorheight}},a.setImageFloorType=function(c,d,e){if(a.isZoomOut="disabled",a.isZoomIn="",a.zoomLevel=1,a.leadData?a.leadData.projectId:b.projId,"3D"===c&&"undefined"!=typeof _taq&&window._taq.events.push(["3DButtonClickedInGallery"+b.CURRENT_ACTIVE_PAGE,{url:window.location.href}]),b.floorImageTypeImg="2D"===c?!0:!1,b.floorImageType3dImg="3D"===c?!0:!1,b.floorImageTypeWT="WT"===c?!0:!1,b.userChoice="2D"===c?"largeImage":"3D"===c?"floor3dImage":"walkThrough",u(),a.currentIconIndex!==d){a.currentIconIndex=d;for(var f=0;f<a.iconClassIndex.length;f++)a.iconClassIndex[f]="";a.iconClassIndex[a.currentIconIndex]="active3DIcon"}a.set3DimageFloorSize(q)},a.Set3DImageForFirstClick=function(){for(var c=[],d=0,e=0,f=0;f<a.images.length;f++)if("Project & Floor Plans"===a.images[f].index){for(var g=0;f>g;g++)e+=a.images[g].data.length;for(var h=0;h<a.images[f].data.length;h++)a.images[f].data[h].floor3dImage&&c.push(h)}d=e+c[0],a.SetImage(d),a.ptslides[a.currentIndex]&&(b.userChoice="floor3dImage",A()),a.set3DimageFloorSize(q,!0)},a.$watch("images",function(b,c){if(a.isloadervisible=!0,b){a.instanceData=angular.copy(b),n=[];var d=a.instanceData;if(d.length>0){a.currentImageObject=d,$.each(a.currentImageObject,function(a,b){$.each(b.data,function(a,c){c.type=b.index,c.text?c.displayAltText=g.ucword(c.text):c.displayAltText=c.displayName,n.push(c)})}),a.ptslides=n;var e=j.getpropertyConfig(a.ptslides);a.constructionDetail=j.getconstructionConfig(a.ptslides),a.neighbourDetail=j.getneighbourConfig(a.ptslides,a.landmarkcount),a.overlayConfig=e.config,a.floorPlanStartingIndex=e.startIdx,a.iconClassIndex=new Array(a.overlayConfig.length),a.selectedRow=new Array(a.overlayConfig.length),a.totalImages=n.length,a.currentIndex=0,k=0,O()}else a.ptslides=[],a.showImage=!1,a.noImage=!0,a.noImageText="No Images for this project !"}else a.ptslides=[],a.showImage=!1,a.noImage=!0;a.$watch("floorplanlisting",function(b,c){b&&a.Set3DImageForFirstClick()})})}]}}]),a.directive("bnLoad",function(){function a(a,b,c){function d(){a.$eval(c.bnLoad)}function e(){a.$apply(function(){d()})}b[0].src&&b[0].complete?d():b.on("load.bnLoad",e),a.$on("$destroy",function(){b.off("load.bnLoad")})}return{link:a,restrict:"A"}})}),define("directives/common/pt-carouselFullScreen",["app","directives/common/pt-carousel"],function(a){a.directive("ptCarouselfullscreen",[function(){return{restrict:"A",scope:{images:"=",settings:"=",imagesfullview:"=",index:"=",unique:"=",leadData:"=",has3dimages:"=",floorplanlisting:"=",landmarkcount:"="},template:'<div pt-imagecarousel unique="unique" settings="settings" index="index" images="images" imagesfullview="images" lead-Data="leadData" has3dimages="has3dimages" floorplanlisting="floorplanlisting" landmarkcount="landmarkcount"></div>',controller:["$scope","$element",function(a,b){a.$on("$destroy",function(){b.remove()})}]}}])}),define("services/fullScreenService",["app","controllers/common/commonFullScreenCtrl","directives/common/pt-carouselFullScreen"],function(a){a.factory("FullScreenService",["$location","$modal","$timeout","$rootScope",function(a,b,c,d){var e,f=function(f,g,i,j,k,l,m){var n,o;return g>=0&&(n=g),f.data&&(f=f.data),o=b.open({template:'<div><div pt-carouselfullscreen has3dimages="has3dimages" floorplanlisting="setFloorPlanFromListing" unique="unique" settings="optionsFullView" index="index" images="images" imagesfullview="images" lead-data="leadData" landmarkcount="landmarkCount"></div></div><div data-ng-click="collapse()" class="caro-close-btn"><i class="pt pt-icon-times"></i></div></div>',controller:"commonfullscreenctrl",keyboard:!0,windowClass:"photoModalGallery",backdrop:!0,resolve:{images:function(){return f},index:function(){return n},unique:function(){return i},leadData:function(){return j},has3dimages:function(){return k},setFloorPlanFromListing:function(){return l},landmarkCount:function(){return m}}}),o.result.then(h,h),o.opened.then(function(){var b=a.hash(),c=b?"&":"";if(b.indexOf("openGallery")<0){var e=b+c+"openGallery";d.selfStateChange=!1,a.hash(e)}}),c(function(){e&&e.close()},1e3),o},g=function(){e=b.open({template:"<div></div>",keyboard:!0,windowClass:"photoModalGallery",backdrop:!0})},h=function(){d.selfStateChange||history.back()};return{openGallery:f,initGallery:g}}])}),define("services/neighbourhoodService",["app","services/globalService"],function(a){a.config(["$httpProvider",function(a){delete a.defaults.headers.common["X-Requested-With"]}]).factory("NeighbourhoodService",["GlobalService",function(a){var b=4,c=function(a){var b="app/v1/amenity?latitude="+a.latitude+"&longitude="+a.longitude+"&distance="+a.distance+"&amenityName="+a.amenityType+"&start=0&rows="+a.count+'&selector={"sort":{"field":"'+a.sorting+'","sortOrder":"DESC"}}';return b},d=function(b,c){return a.makeCompositeCall(b).then(function(a){return c&&c(a),a})},e=function(a,b,c,d){return"https://maps.googleapis.com/maps/api/staticmap?key=AIzaSyCrc5noA_4nPK4fpPEjn1Vzm8MvCPjIHgM&center="+a+","+b+"&size=700x734&scale=1&style=saturation:-20&lightness:10&hue:0xffcc00&markers=color:0xf39c13|label:"+d+"|"+a+","+b+c},f=function(a){var b="",c=0;for(var d in a.data)a.data.hasOwnProperty(d)&&(b+="&markers=icon:"+a.mapProtocal+"/styles/images/marker"+(c+1)+".png|"+a.data[d].latitude+","+a.data[d].longitude),c++;var f=e(a.latitude,a.longitude,b,a.firstChar);return f};return{projectDetailsNeighbourhoodRadius:b,findAmenitiesNearByProject:c,getAmenitiesOfProject:d,getImageOfAmenities:f,drawAmenitiesNearByProject:e}}])}),define("text!views/directives/common/pt-rating.html",[],function(){return'<div class="rating-wrapper">\n    <span class="avg-rating">{{ratings.averageRating | roundSingleDecimal}}</span>\n    <span class="total-rating"><span>{{ratings.ratingsCount}}</span> ratings </span>\n    <div class="rating-overlay">\n         <div class="row">\n             <div class="col-lg-6 col-md-6 col-sm-6">\n                <div class="total-perf-text paddingT15"> {{avgRatingLabel}}</div>\n                <div class="text-center row-full">\n                    <div class="total-avg-rating text-center">{{ratings.averageRating | roundSingleDecimal}}<span class="total-avg-text">/ 10</span></div>\n                </div>\n            </div>\n         \n             <div class="col-lg-6 col-md-6 col-sm-6 border-Left paddingL10">\n                <div class="total-rating-head-info"> Total Ratings {{ratings.ratingsCount}}</div>\n                <div class="paddingT10 row-full">\n                    <div class="row total-rating-cont-info">\n\n                        <span class="col-lg-5 col-md-5 col-sm-5">Excellent </span>\n                        <rating class="col-lg-5 col-md-5 col-sm-5 total-rating-box" value="excellentPercent" max="max" readonly="true" state-on="\'exce-rating\'" state-off="\'blank-rating\'"></rating>\n                        <span class="col-lg-2 col-md-2 col-sm-2 font-weight total-rating-cont-text">{{excellent}}</span>\n                    </div>\n                    <div class="row total-rating-cont-info">\n                        <span class="col-lg-5 col-md-5 col-sm-5">Good</span>\n                        <rating class="col-lg-5 col-md-5 col-sm-5  total-rating-box" value="goodPercent" max="max" readonly="true" state-on="\'good-rating\'" state-off="\'blank-rating\'"></rating>\n                        <span class="col-lg-2 col-md-2 col-sm-2 font-weight total-rating-cont-text">{{good}}</span>\n                    </div>\n                    <div class="row total-rating-cont-info">\n                        <span class="col-lg-5 col-md-5 col-sm-5">Average</span>\n                        <rating class="col-lg-5 col-md-5 col-sm-5  total-rating-box" value="averagePercent" max="max" readonly="true" state-on="\'aver-rating\'" state-off="\'blank-rating\'"></rating>\n                        <span class="col-lg-2 col-md-2 col-sm-2 font-weight total-rating-cont-text">{{average}}</span>\n                    </div>\n                    <div class="row total-rating-cont-info">\n                        <span class="col-lg-5 col-md-5 col-sm-5">Below Avg</span>\n                        <rating class="col-lg-5 col-md-5 col-sm-5 total-rating-box" value="belowaveragePercent" max="max" readonly="true" state-on="\'belowAvg-rating\'" state-off="\'blank-rating\'"></rating>\n                        <span class="col-lg-2 col-md-2 col-sm-2 font-weight total-rating-cont-text">{{belowaverage}}</span>\n                    </div>\n                    <div class="row total-rating-cont-info">\n                        <span class="col-lg-5 col-md-5 col-sm-5">Poor</span>\n                        <rating class="col-lg-5 col-md-5 col-sm-5  total-rating-box" value="poorPercent" max="max" readonly="true" state-on="\'poor-rating\'" state-off="\'blank-rating\'"></rating>\n                        <span class="col-lg-2 col-md-2 col-sm-2 font-weight total-rating-cont-text">{{poor}}</span>\n                    </div>\n                </div>\n            </div>\n         </div> \n    </div>\n</div>\n'}),define("directives/common/pt-rating",["app","text!views/directives/common/pt-rating.html"],function(a,b){a.directive("ptRating",[function(){return{restrict:"A",scope:{ratings:"="},template:b,controller:["$scope",function(a){a.$on("ratingChanged",function(b,c){a.ratings=c}),a.$watch("ratings",function(b){var c=0;if(a.ratings&&a.ratings.numberOfUsersByRating){var d,e={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0};for(d in e){var f=a.ratings.numberOfUsersByRating[parseFloat(d).toFixed(1)];f&&(c+=f,e[d]=f)}a.excellent=e[9]+e[10],a.good=e[7]+e[8],a.average=e[5]+e[6],a.belowaverage=e[3]+e[4],a.poor=e[1]+e[2]}if(_.each(["excellent","good","average","belowaverage","poor"],function(b){a[b]&&c?a[b+"Percent"]=100*a[b]/c:(a[b]=0,a[b+"Percent"]=0),a[b+"Percent"]=Math.ceil(a[b+"Percent"]/10)}),a.ratings&&a.ratings.averageRating){var g=0;switch(Math.ceil(a.ratings.averageRating)){case 10:case 9:g="excellent";break;case 8:case 7:g="good";break;case 6:case 5:g="average";break;case 4:case 3:g="below avg";break;case 2:case 1:case 0:g="poor"}a.avgRatingLabel=g,a.ratings.ratingsCount||(a.ratings.ratingsCount=c)}else a.avgRatingLabel="poor",a.ratings&&(a.ratings.averageRating=0)}),a.max=10}]}}])}),define("text!views/directives/common/pt-disclaimer.html",[],function(){return'<div class="discla-info overlay-modal">\n    <span class="dropdown-toggle" data-ng-click="showDisclaimerBox()">Disclaimer</span>\n    <div class="overlay-Wrapper padding10 content-info" data-ng-if="showDisclaimer">\n        <div class="discla-list bdr-bottom">\n            <div class="discla-sub-head">Area</div>\n            <ul>\n                <li>Sizes shown are super built up area unless specified otherwise.</li>\n            </ul>\n        </div>\n        <div class="discla-list">\n            <div class="discla-sub-head">Price</div>\n            <ul>\n                <li>Builder prices shown are basic sales price (BSP) and do not include other cost items such as clubhouse membership, preferred location charges, parking charges etc.</li>\n            </ul>\n        </div>\n        <div class="discla-list">\n            <ul>\n                <li>Resale prices shown is price of the lowest cost unit available in the project. Actual price will vary as per the unit purchased by the buyer.</li>\n            </ul>\n        </div>\n    </div>\n</div>'}),define("directives/common/pt-disclaimer",["app","text!views/directives/common/pt-disclaimer.html"],function(a,b){a.directive("ptDisclaimer",[function(a){return{restrict:"A",template:b,controller:["$scope","$rootScope",function(a,b){a.showDisclaimer=!1,a.showDisclaimerBox=function(){
a.showDisclaimer=!0}}]}}])}),define("text!views/directives/maps/pt-nearby-amenities.html",[],function(){return'<div class="nearby-amenities">\n    <div class="neighbour-col">\n        <ul>\n            <li class="heading">Neighbourhood</li>\n\n			<li><a class="school first" data-ng-click="itemClicked($event, \'school\', \'school\')" data-type="school"  name="school"><i class="fs0 pt pt-icon-school"></i> Schools<span data-ng-if="neighbourhoodValue.school !== \'\'">({{neighbourhoodValue.school}})</span></a></li>\n            <li><a class="restaurants" data-ng-click="itemClicked($event, \'restaurant\', \'restaurant\')" data-type="restaurant" name="restaurant"><i class="fs0 pt pt-icon-restaurant"></i> Restaurants<span data-ng-if="neighbourhoodValue.restaurant !== \'\'">({{neighbourhoodValue.restaurant}})</span></a></li>\n            <li><a class="hospitals" data-ng-click="itemClicked($event, \'hospital\', \'hospital\')" data-type="hospital" name="hospital"><i class="fs0 pt pt-icon-hospital"></i> Hospitals<span data-ng-if="neighbourhoodValue.hospital !== \'\'">({{neighbourhoodValue.hospital}})</span></a></li>\n            <li><a class="gas_station" data-ng-click="itemClicked($event, \'gas_station\', \'petrol-station\')" data-type="gas_station" name="gas_station"><i class="fs0 pt pt-icon-petrol-station"></i> Petrol Pumps<span data-ng-if="neighbourhoodValue.gas_station !== \'\'">({{neighbourhoodValue.gas_station}})</span></a></li>\n            <li><a class="atm" data-ng-click="itemClicked($event, \'bank\', \'bank\')" data-type="bank" name="bank"><i class="fs0 pt pt-icon-bank"></i> ATM/Banks<span data-ng-if="neighbourhoodValue.bank !== \'\'">({{neighbourhoodValue.bank}})</span></a></li>\n		</ul>\n\n    </div>\n    <div class="connectivity-col">\n        <ul>\n            <li class="heading">Connectivity</li>\n			<li><a data-ng-click="itemClicked($event, \'bus_station\', \'bus-stop\')" class="" data-type="bus_station" name="bus_station"><i class="fs0 pt pt-icon-bus-stop"></i> Bus Stop<span data-ng-if="neighbourhoodValue.bus_station !== \'\'">({{neighbourhoodValue.bus_station}})</span></a></li>\n            <li><a data-ng-click="itemClicked($event, \'train_station\', \'train-station\')" class="" data-type="train_station" name="train_station"><i class="fs0 pt pt-icon-train-station"></i> Train Station<span data-ng-if="neighbourhoodValue.train_station !== \'\'">({{neighbourhoodValue.train_station}})</span></a></li>\n            <li><a data-ng-click="itemClicked($event, \'airport\', \'airport\')" class="" data-type="airport" name="airport"><i class="fs0 pt pt-icon-airport"></i> Airport<span data-ng-if="neighbourhoodValue.airport !== \'\'">({{neighbourhoodValue.airport}})</span></a></li>\n		</ul>\n\n    </div>\n    <div class="clearfix"></div>   \n</div>      '}),define("directives/maps/pt-nearby-amenities",["app","text!views/directives/maps/pt-nearby-amenities.html","services/localityService","services/neighbourhoodService","services/constants"],function(a,b){a.directive("ptNearbyAmenities",["$rootScope","LocalityService","NeighbourhoodService","Constants",function(a,c,d,e){return{restrict:"A",scope:{sharedObj:"=",directivePlace:"@"},template:b,link:function(b,f){b.neighbourhoodValue={school:0,restaurant:0,hospital:0,gas_station:0,bank:0,airport:0,train_station:0,bus_station:0},b.pageType=e.GLOBAL.PAGE_TYPES.MAP+"-"+e.GLOBAL.PAGE_TYPES.PROJECTDETAIL;var g={},h=angular.copy(b.neighbourhoodValue),i=d.projectDetailsNeighbourhoodRadius||4;b.$on("showNearbyAmenities",function(a,c){if(g=c,b.neighbourhoodValue=angular.copy(h),g.latitude&&g.longitude){var d={lat:g.latitude,lng:g.longitude};i=g&&g.radius?g.radius:i,j(i,d)}}),b.$on("activateFirstAmenity",function(a){f.find(".neighbour-col a.first").click()});var j=function(d,e){c.getNeighbourhood(e,d,"",function(c){var d=[];if(""!==c){for(var e=0,f=c.length;f>e;e++)d=c[e],b.neighbourhoodValue[d.localityAmenityTypes.name]+=1;var g=[];a.selectedCity.amenities&&(g=_.filter(a.selectedCity.amenities,function(a){return a.localityAmenityTypes?"airport"===a.localityAmenityTypes.name:!1})),b.neighbourhoodValue.airport=g.length}})},k={school:"Schools",restaurant:"Restaurants",hospital:"Hospitals",gas_station:"Petrol Pumps",bank:"ATM/Banks",bus_station:"Bus Stop",train_station:"Train Station",airport:"Airport"};b.itemClicked=function(c,d,e,h){if(g.latitude&&g.longitude){var j={lat:g.latitude,lng:g.longitude};b.sharedObj={name:k[d],tab:"neighbourhood",type:d,icon:e,amenityCount:b.neighbourhoodValue[d]||0};var l=!0,m=angular.element(c.currentTarget),n="";m.hasClass("active-neighbour")?(m.removeClass("active-neighbour"),b.sharedObj={type:"neighbourhood"},a.$broadcast("amenityClicked",{type:d.split(","),level:"project"})):($(".active-neighbour").each(function(b,c){n=$(this),n.removeClass("active-neighbour"),a.$broadcast("amenityClicked",{type:n.attr("data-type").split(","),level:"project"})}),m.addClass("active-neighbour"),a.$broadcast("amenityClickedComplete",{type:d.split(","),level:"project",position:j,projectLatLng:{latitude:g.latitude,longitude:g.longitude},radius:i,direction:l}));for(var o=[],p=["bus_station","train_station","airport"],q=[],r="",s=f.find("a.active-neighbour"),t=0;t<s.length;t++)~$.inArray(s[t].name,p)?q.push(s[t].name):-1==$.inArray(s[t].name,p)&&o.push(s[t].name);if(r=q.length>0?q.join(","):o.join(",")){var u=(b.directivePlace?b.directivePlace:"map",{});u["Project "+h+" Name"]=r,u["Project ID"]=g.projectId,u["Page Name"]=b.pageType}}}}}}])}),define("directives/b2b/maps/pt-b2b-projectdetail",["app","text!views/directives/b2b/maps/pt-b2b-projectdetail.html","parsers/imageParser","services/notificationService","services/fullScreenService","services/localityService","services/projectService","services/userService","services/maps/mapConfig","services/neighbourhoodService","services/constants","parsers/projectParser","directives/common/pt-rating","directives/common/pt-carousel","directives/common/pt-disclaimer","directives/common/pt-loading-block","directives/maps/pt-nearby-amenities"],function(a,b){a.directive("ptB2bProjectdetail",["$rootScope","$location","$timeout","ProjectParser","LocalityService","ProjectService","NeighbourhoodService","PtMapsConfig",function(a,c,d,e,f,g,h,i){return{restrict:"A",scope:{},template:b,link:function(b,f){b.map=i.mapConfig,b.data={},b.showDetailFlag=!1,b.data.projectId=null,b.projectSelected=!0,b.$on("openProjectDetailCard",function(a,b){j(b.projId,b.callback)}),b.$on("closeProjectDetailCard",function(){k()});var h=function(a){var b,c=[],d=[],e=0;if(a&&a.length){for(var f=0,g=a.length;g>f;f++){var h=a[f];"Oth"===h.amenityMaster.abbreviation||e>=12?(d.push(h.amenityDisplayName),b=h,b.amenityMaster.abbreviation="Oth"):(c.push(h),e++)}d.length&&(b.amenityDisplayName=d.join(", "),c.push(b))}return c},j=function(f,i){b.data={},b.showDetailFlag=!1;var j=c.search().projectIds||"";j.indexOf(f.toString())>=0?b.projectSelected=!1:b.projectSelected=!0,$("#projectLoader, .pro_loader_image").show(),g.getProjectDetail(f,function(c){$("#projectLoader, .pro_loader_image").hide(),d(function(){$("#project-details a").click()},0),c&&c.data&&(b.showDetailFlag=!0,b.data=e.parseProject(c.data,!0),a.$broadcast("showNearbyAmenities",{latitude:b.data.latitude,longitude:b.data.longitude,projectId:b.data.projectId}),a.$broadcast("projectDetailCardOpened",b.data),b.data.amenities&&(b.data.amenities=h(b.data.amenities)),i&&i(b.data))})},k=function(){$(".proj-card-wrap").animate({opacity:"1",height:"0px"}),b.showDetailFlag=!1,a.$broadcast("projectDetailsClosed",b.data)};b.close=function(){a.$broadcast("closeProjectDetailCard")};var l={gallery:"overview",price:"price"};b.tabSwitch=function(c,d){if(b.data.projectId&&({lat:b.data.latitude,lng:b.data.longitude},"neighbourhood"!=c&&(b.data.item={type:c,tab:l[c]}),a.$broadcast("projectDetailsTabClicked",{type:c,projectId:b.data.projectId,latitude:b.data.latitude,longitude:b.data.longitude}),"neighbourhood"===c)){var e="#project_"+b.data.projectId;$(e).show(function(){a.$broadcast("activateFirstAmenity")})}},b.selectProject=function(){a.$broadcast("projectTicked",b.data)},b.$on("projectTickedCompleted",function(a,c){c.projectId===b.data.projectId&&(b.projectSelected=c.selected)})}}}])}),define("text!views/directives/maps/pt-map-svg-tooltip.html",[],function(){return' <div class="svg-info-bubble legend-tooltip-txt" data-ng-show="showTooltip">\n 	<!-- timesense-tooltip-txt is the class built for localitycard, we need to maintain seperate class for it while writing css for the same -->\n    <div ng-if="svgHovered">\n    	<div class="locality-name">\n    		<div class="pull-left" ng-if="iconType">\n    			<i class="pt pt-icon-{{iconType}}"></i>\n    		</div>\n    		<div class="pull-left paddingL5 area-name">\n    			<strong> {{areaName}}</strong>\n    		</div>\n    	</div>\n    </div>\n    <div ng-if="svgClicked">\n    	Clicked\n    	<div class="locality-name"><strong>{{areaName}}</strong></div>\n    </div>\n</div>\n'}),define("directives/maps/pt-map-svg-tooltip",["app","text!views/directives/maps/pt-map-svg-tooltip.html"],function(a,b){a.directive("ptMapSvgTooltip",["$rootScope","$timeout",function(a,c){return{restrict:"A",scope:{},template:b,link:function(a,b,d){var e=[];a.$on("$destroy",function(){for(var a in e)e[a]()});var f=a.$on("showSvgHoverTooltip",function(b,c,d){a.svgHovered=!0,a.svgClicked=!1,j(c,d)});e.push(f);var g=a.$on("showSvgClickTooltip",function(b,c,d){a.svgHovered=!1,a.svgClicked=!0,j(c,d)});e.push(g);var h=a.$on("hideSvgTooltip",function(a){i()});e.push(h);var i=function(){a.showTooltip=!1,a.svgHovered=!1,a.svgClicked=!1,c(function(){a.$apply()},0)},j=function(b,d){var e=0,f=0;d.clientX&&d.clientY&&(e=d.clientX,f=d.clientY),a.areaName=b.name,"road"==b.type?a.iconType="car":"train"==b.type?a.iconType="metrostation":a.iconType=void 0,$(".svg-info-bubble").css("top",f-145+"px").css("left",e-85+"px"),a.showTooltip=!0,c(function(){a.$apply()},0)}}}}])}),define("controllers/b2b/catchmentCreation.3fee3b9e",["app","controllers/common/mapBaseCtrl","directives/common/b2b-listingfilter","directives/common/pt-cityDropdown","directives/b2b/builderSearch/grid-head","directives/b2b/maps/alvLocalities","directives/b2b/maps/alvProjects","directives/b2b/maps/b2b-markers","services/catchmentService","directives/b2b/maps/downloadAlvData","services/b2b/DownloadService","directives/b2b/maps/pt-b2b-projectdetail","directives/maps/pt-map-svg-tooltip","directives/maps/pt-svg-legends"],function(a){a.controller("catchmentCreationCtrl",["$rootScope","$scope","$timeout","$location","$controller","$state","Constants","pageSettings","markerFactory","ProjectService","NotificationService","ProjectParser","LocalityParser","FilterService","Flags","CatchmentService","PtMapsConfig","DownloadService","Formatter","GlobalService","GoogleAnalyticsService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){e("mapBaseCtrl",{$scope:b});var v=[],w={maxNumberOfProjects:150},x=q.projectDetailCardConfig;b.alvVisibleList=[],b.currentProjects;var y=function(){var e=b.$on("drawingModeSwitched",function(d,e){a.$broadcast("removeMeasleUpdateListener"),b.currentDrawingMode=e,a.$broadcast("showMarkers",!1),c(function(){a.$broadcast("alvProjects",[])},10),b.alvVisibleList=[],b.selection_map={},j.abortProjectList(),k.removeNotification(),e?(a.$broadcast("showProjectMarkers",!1),a.$broadcast("activateDrawing")):(a.$broadcast("removePolygon"),a.$broadcast("removeCurrentPolygonReference"),a.$broadcast("showPolygonFilter",!1)),a.$broadcast("exitNeighbourhood-dd"),a.$broadcast("showMapFilter",!(e||b.isBuilderCitySearchActive)&&"project"===b.alvDisplayType)});v.push(e);var f=b.$on("alvListFilteredArray",function(e,f){c(function(){a.$broadcast("alvProjects",f.alvListArray)},10);var g=d.search().projectIds||"",h=!1,i=[],j=d.search().projectId;b.alvVisibleList=f.alvListArray,b.selection_map={},f.alvListArray&&f.alvListArray.length||!b.currentDrawingMode?b.showErrorMsgForShape=!1:(a.$broadcast("showProjectmarkers",!1),b.showErrorMsgForShape=!0),angular.forEach(b.alvVisibleList,function(a,c){a.authorized&&(b.selection_map[a.projectId]=!0),g.indexOf(a.projectId.toString())>=0&&a.authorized&&(b.selection_map[a.projectId]=!1)}),_.each(b.selection_map,function(a,b){a||i.push(parseInt(b)),j&&j===b&&(h=!0)}),i.length?d.search("projectIds",i.join(",")):d.search("projectIds",null),h||d.search("projectId",null)});v.push(f);var g=b.$watch("selectedCity",function(a,b){if(a&&a!=b){var c={filters:{and:[{equal:{cityLabel:a.label}}]}};n.fetchStats(c),o.set("cityMapSupport",a),o.broadcast("cityMapSupport")}});v.push(g);var h=b.$on("projectClicked",function(a,b){C(b)});v.push(h);var i=b.$on("viewProjects",function(a,b){D(b)});v.push(i);var l=b.$on("projectTicked",function(a,b){F(b)});v.push(l);var m=b.$on("projectDetailsTabClicked",function(c,d){if(a.$broadcast("showProjectMarkers","neighbourhood"!==d.type),x.currentActiveTab=d.type,"neighbourhood"!==d.type){if(b.removeNeighbourhood(null,"project",function(){$(".proj-card-wrap .neighbour-col,.proj-card-wrap .connectivity-col").find("li a").removeClass("active-neighbour")}),d.latitude&&d.longitude&&b.map.services.state.isMapStateSaved()){var e=b.map.services.state.restoreMapState()||b.map.state;a.$broadcast("updateZoom",e.zoom),a.$broadcast("updateCenter",e.center)}a.$broadcast("showMapFilter",!(b.currentDrawingMode||b.isBuilderCitySearchActive)),a.$broadcast("showPolygonFilter",b.currentDrawingMode&&!b.isBuilderCitySearchActive)}else a.$broadcast("showMapFilter",!1),a.$broadcast("showPolygonFilter",!1),b.map.services.state.isMapStateSaved()||b.map.services.state.saveMapState(b.map.state.zoom,b.map.state.center)});v.push(m);var p=b.$on("projectDetailsClosed",function(c,e){if(a.$broadcast("showMapFilter",!(b.currentDrawingMode||b.isBuilderCitySearchActive)),a.$broadcast("showPolygonFilter",b.currentDrawingMode&&!b.isBuilderCitySearchActive),a.$broadcast("removeAllProjectPopup"),x.currentActiveTab=!1,b.map.services.state.isMapStateSaved()){var f=b.map.services.state.restoreMapState()||b.map.state;b.map.services.state.zoom=f.zoom,b.map.services.state.center=f.center,a.$broadcast("updateZoom",f.zoom),a.$broadcast("updateCenter",f.center)}K(!0),d.search("projectId",null),b.searchProjectId=void 0});v.push(p);var q=b.$on("mapMarkerAdd",function(){if("project"===b.alvDisplayType){var e=d.search().projectId;e&&c(function(){a.$broadcast("markerClicked",{data:{projectId:e}})},10)}});v.push(q);var r=b.$on("masterPlanSvgAdded",function(c,d){d&&a.$broadcast("addSvgLegend",{svgType:d,viewLevel:b.requestType})});v.push(r);var s=b.$on("masterPlanActive",function(d,e){a.$broadcast("showLocalityMarkers",!e),e&&"project"==b.requestType&&"timeSense"==x.currentActiveTab&&c(function(){$("#gallery a").trigger("click")},0)});v.push(s);var t=b.$on("zoomUpdated",function(b,c){a.$broadcast("updateSvgStroke",c)});v.push(t)};y(),b.hideReset=!0;var z=b.$on("alvDownloadDataValid",function(c,d){var e=b.selection_map,f=[],g=_.filter(e,function(a){return a===!0}).length;return g?g>w.maxNumberOfProjects?void a.$broadcast("alvDownloadDataValidationError","You've selected "+g+" projects. Please select a maximum of "+w.maxNumberOfProjects+" projects."):(_.each(e,function(a,b){a&&f.push(b)}),d.projectIds=f,a.$broadcast("disableDownloadButton",!0),void r.getCatchmentInfoFileName(d).then(function(b){var b=b.data;return b&&b.statusCode&&"2"===b.statusCode.substring(0,1)?(r.getCatchmentInfoFile(b.data),void a.$broadcast("dismissAlvDownloadDataModal")):void(b&&b.statusCode&&"5"!==b.statusCode.substring(0,1)&&b.error&&b.error.msg?a.$broadcast("alvDownloadDataValidationError",b.error.msg):a.$broadcast("alvDownloadDataValidationError","There was an error while processing your request. Please try again later."))})):void a.$broadcast("alvDownloadDataValidationError","Please select projects for download")});v.push(z),b.displaySettings=h.displaySettings,b.selection_map={},a.currentCatchment||(a.currentCatchment={name:"New Catchment",id:null,state:"new",projIds:[],status:"Inactive",attr:""});var A=function(a,b){b&&b()};b.$on("$destroy",function(){k.removeNotification(),$.each(v,A)});var B=function(b){u.gaEventClickMap(b),a.$broadcast("b2bLocalityClicked",b)};b._saveCatchment=function(b,c,e,f){a.currentCatchment.projIds=c,a.currentCatchment.attr={url:d.url()},p.updateCatchment(null,b,c,e,f,function(a){"2XX"===a.data.statusCode?J(a.data.data.id):"499"===a.data.statusCode?console.log(a.data.error.msg):console.log("Unknown error while catchment creation. Status : ",a.data.statusCode)})},b.selectDefaultCity=function(a){var b,c,e,f=t.getHomeCity();c=_.filter(a,function(a){return a.authorized}),b=c[0],f?(e=_.find(c,function(a){return a.label.toLowerCase()===f.label.toLowerCase()}),e&&(b=e)):b&&t.setHomeCity(b.id,b.label),f?d.path("/maps/projects-in-"+f.label.toLowerCase()):d.path("/maps/projects-in-"+b.label.toLowerCase())};var C=function(b){var e=d.search().projectId;e==b.projectId?(d.search("projectId",null),a.$broadcast("closeProjectDetailCard"),c(angular.noop,0)):(d.search("projectId",b.projectId),a.$broadcast("markerClicked",{type:"project",data:b}),a.$broadcast("showNeighbourhood",!1),a.$broadcast("openProjectDetailCard",{projId:b.projectId}),c(function(){$("#gallery a").click()},0)),a.$broadcast("openProjectsALV",!1)},D=function(e){b.requestType="project",a.currentLocality=e;var f=e.url,g=d.path();-1!=g.indexOf("filters")&&(f+="/filters"),d.path("/maps/"+f),c(function(){b.$digest()},10)},E=function(a){var b,c=[],e=d.search().projectIds;return e&&(c=e.split(",")),a?(b=c.indexOf(a.toString()),b>=0?c.splice(b,1):c.push(a),void(c.length?d.search("projectIds",c.join(",")):d.search("projectIds",null))):c},F=function(c){var d=$("#"+c.selector),e=_.find(b.alvVisibleList,function(a){return a.projectId===c.projectId});d.hasClass("selected")?(b.selection_map[c.projectId]=!1,d.removeClass("selected"),e&&(e.projectSelected=!1),a.$broadcast("projectTickedCompleted",{projectId:c.projectId,selected:!1})):(b.selection_map[c.projectId]=!0,d.addClass("selected"),e&&(e.projectSelected=!0),a.$broadcast("projectTickedCompleted",{projectId:c.projectId,selected:!0})),E(c.projectId)};b._handleProjectSearch=function(e,g){var h=d.path(),i="/maps/"+e.localityURL,j=0;b.searchProjectId=e.id.replace("TYPEAHEAD-PROJECT-","");var k=b.map.state.filter.state,l={projectId:b.searchProjectId};if(l.unitType=a.userDetails.preference.preference.unitType.join(","),e.latitude&&e.longitude){var m=k.minDistance||3,n={distance:m.toFixed(2)/1,lat:e.latitude.toFixed(4)/1,lon:e.longitude.toFixed(4)/1};n=[n.distance,n.lat,n.lon].join(","),l.geo=n}if(j=q.distanceBetweenPoints({lat:k.position.lat,lng:k.position.lng},{lat:e.latitude,lng:e.longitude}),!g&&j<=k.distance){b.projectListingCallBackProjectId=b.searchProjectId;var o=d.search().geo,p={};a.$broadcast("changeShowNeighbourhood-dd",!1),a.$broadcast("showNeighbourhood",!1),o&&(p.geo=o),p.projectId=b.searchProjectId,p.unitType=a.userDetails.preference.preference.unitType.join(","),d.search(p),a.$broadcast("openProjectDetailCard",{projId:b.searchProjectId,callback:function(c){a.$broadcast("markerClicked",{type:"project",data:{projectId:b.searchProjectId}}),a.$broadcast("panToCenter",{position:{lat:e.latitude,lng:e.longitude}}),b.searchProjectId=void 0}})}else h==i?(b.projectListingCallBackProjectId=b.searchProjectId,d.path(i).search(l),c(function(){f.go(f.current,{},{reload:!0,inherit:!0,location:!1,notify:!0})},10)):d.path(i).search(l)};var G=function(c,d){K(!1),a.$broadcast("showNeighbourhood",!1),a.$broadcast("openProjectDetailCard",{projId:c,callback:d}),b.searchProjectId=void 0},H=function(c,d){return a.$broadcast("removeMeasleUpdateListener"),a.$broadcast("openLocalitiesALV",!1),a.$broadcast("openProjectsALV",!1),b.alvVisibleList=[],b.selection_map={},200===c?(b.showErrorMsg=!1,d&&d.totalCount&&_.keys(d).length&&d.data?!0:(b.showErrorMsg=!0,a.$broadcast("showMarkers",!1),b.alvVisibleList=[],a.$broadcast("alvProjects",b.alvVisibleList),a.$broadcast("alvLocalities",b.alvVisibleList),b.showErrorMsgForShape=b.currentDrawingMode,!1)):(500===c&&k.setNotification({msg:"Oops! Something went wrong. Revive the map ?",type:"error",onYes:function(){a.$broadcast("backToCity")},onNo:function(){}}),!1)},I=function(a){var a=a.toLowerCase();return!a||"bangalore"!=a&&"noida"!=a&&"pune"!=a?!1:!0};b.prepareExistingCityLink=function(b,c,e,f){for(var g,h,i='<h6 class="marginB20 modal-head">Choose one of the following options to see projects by builder <b>'+e+'</b></h6><ul class="row-full">',j=!1,k=0;k<c.length;k++){if(h=c[k],g=s.ucword(h.label),a.selectedCity&&a.selectedCity.authorized&&b.indexOf(a.selectedCity.label)>-1)return d.path("/maps/"+a.selectedCity.label.toLowerCase()+"/"+f),j=!0,"";h.authorized&&b.indexOf(g)>-1&&(j=!0,i+=' <li class="row-two-column pull-left"><a href="/maps/'+h.label.toLowerCase()+"/"+f+'" data-ng-click="closeBuilderCitiesModal()">'+e+" projects in "+h.label+"</a></li>")}return i+="</ul>",j||(i='<h6 class="marginB20 modal-head">You do not have authorization to access '+e+". Please upgrade your plan to view "+e+"'s details.</h6>"),i},b.refreshLocalityList=function(e){var f,g=e.data,h=e.status;if(b.alvDisplayType="locality",K(!1),a.$broadcast("closeProjectDetailCard"),a.$broadcast("showMapFilter",!1),a.$broadcast("showPolygonFilter",!1),a.$broadcast("changeDrawButtonStatus",!1),a.$broadcast("showDrawingOption",!1),d.search("_keys",null),I(a.selectedCity.label)){var j=a.selectedCity.label;a.$broadcast("addSvgOverlay",{svgName:"landusage",city:j}),a.$broadcast("addSvgOverlay",{svgName:"drains_electric",city:j,zIndex:"1"}),a.$broadcast("addSvgOverlay",{svgName:"train",city:j,zIndex:"2"}),a.$broadcast("addSvgOverlay",{svgName:"roads",city:j,zIndex:"3"}),a.$broadcast("showSvgLegends",!0),c(function(){a.$broadcast("decideMasterPlanHelpScreen")},1e3)}else a.$broadcast("showDisabledSvgLegends",!0);if(H(h,g)){var k=[],l=0,n={},o=null,p=0;for(l=0,p=g.data.length;p>l;l++)n=g.data[l],n.latitude&&n.longitude&&(f=g.data[l].cityId,m.parseLocalityList(n),n.markerWidth=n.projectCount.toString().length,o=new i.marker("b2b_locality",n),o.click(B),k.push(o),b.alvVisibleList.push(o));c(function(){a.$broadcast("alvLocalities",b.alvVisibleList)},0),a.$broadcast("drawMarkers",{markers:k,type:"locality"}),a.$broadcast("markerDisplayType","type"),a.$broadcast("showBackToCity",!1)}},b._toggleMappedProject=angular.noop,b.saveCatchment=function(){var c=b.selection_map,e=[];_.each(c,function(a,b){a&&e.push(parseInt(b))});var f=d.url().split("?"),g=d.search();if(!g.geo&&!g._keys){var h=b.map.state.filter.state,i={distance:h.distance.toFixed(2)/1,lat:h.position.lat.toFixed(4)/1,lon:h.position.lng.toFixed(4)/1};f[1]?f[1]+="&geo="+[i.distance,i.lat,i.lon].join(","):f[1]="geo="+[i.distance,i.lat,i.lon].join(",")}a.currentCatchment.state="new",a.currentCatchment.projIds=e,a.currentCatchment.attr={url:f.join("?")},a.$broadcast("saveCatchment")},b.onAnalysisClicked=function(){var c=b.selection_map,e=[];_.each(c,function(a,b){a&&e.push(parseInt(b))}),a.currentCatchment.id?0!==_.difference(a.currentCatchment.projIds,e).length||0!==_.difference(e,a.currentCatchment.projIds).length?k.setNotification({msg:"Your catchment is modified. Analyse which one?",type:"alert",isConfirm:!0,confirmText:"New Catchment",onYes:function(){b._saveCatchment("myCatchment-"+(new Date).getTime(),e,"Inactive",{url:d.url()})},cancelText:"Saved Catchment",onNo:function(){J(a.currentCatchment.id)}}):J(a.currentCatchment.id):b._saveCatchment("myCatchment-"+(new Date).getTime(),e,"Inactive",{url:d.url()})};var J=function(a){d.path("/analysis/catchment/"+a).search({})};b.refreshProjectsList=function(e,f){var g,h=b.map.state.filter.state,j=[];if(b.isPartialRefresh)e.data.data.items=e.data.data.items.concat(b.currentProjects.data.data.items),g=e.data,b.isPartialRefresh=!1;else if(!b.isBuilderCitySearchActive&&!b.currentDrawingMode&&h.distance<=h.maxStoredDistance){g={data:{items:e.data.data.items},statusCode:e.data.statusCode,totalCount:e.data.totalCount};for(var k=0,m=g.data.items.length;m>k;k++)q.distanceBetweenPoints({lat:h.position.lat,lng:h.position.lng},{lat:g.data.items[k].latitude,lng:g.data.items[k].longitude})<=h.distance&&j.push(g.data.items[k]);g.data.items=j,g.totalCount=j.length}else g=e.data;var n=e.status;b.currentProjects=e,b.isBuilderCitySearchActive||a.$broadcast("project-listing"),a.$broadcast("showDrawingOption",!b.isBuilderCitySearchActive),b.alvDisplayType="project",K(!0),a.$broadcast("closeProjectDetailCard"),b.SearchedProjectId&&(d.search("projectId",b.SearchedProjectId),a.$broadcast("openProjectDetailCard",{projId:b.SearchedProjectId,callback:function(){a.$broadcast("markerClicked",{type:"project",data:{projectId:b.SearchedProjectId}}),b.SearchedProjectId=void 0}}));var o=d.search()._keys;o||b.currentDrawingMode?(a.$broadcast("showMapFilter",!1),a.$broadcast("showPolygonFilter",!0)):(a.$broadcast("showMapFilter",!b.isBuilderCitySearchActive),a.$broadcast("showPolygonFilter",!1));var p=b.isBuilderCitySearchActive?"builderSearch":a.urlData.city;if(p=b.nearbyPlaceActive&&a.selectedCity?a.selectedCity.label:p,a.$broadcast("showBackToCity",p),I(a.selectedCity.label)){var r=a.selectedCity.label;a.$broadcast("addSvgOverlay",{svgName:"landusage",city:r}),a.$broadcast("addSvgOverlay",{svgName:"drains_electric",city:r,zIndex:"1"}),a.$broadcast("addSvgOverlay",{svgName:"train",city:r,zIndex:"2"}),a.$broadcast("addSvgOverlay",{svgName:"roads",city:r,zIndex:"3"}),a.$broadcast("showSvgLegends",!0),c(function(){a.$broadcast("decideMasterPlanHelpScreen")},1e3)}else a.$broadcast("showDisabledSvgLegends",!0);if(H(n,g)){var s,t,u=[],v=0,w=null,m=0,x={},y=b.map.state.filter,z=d.search().projectIds||"";b.isBuilderCitySearchActive||(x.action=y.action,b._updateMapFilter(x));var A=l.parseStats(g);for(v=0,m=g.data.items.length;m>v;v++)s=g.data.items[v],s.latitude&&s.longitude&&(t=l.parseProject(s,!1,A),t.authorized&&(t.projectSelected=!0),z.indexOf(s.projectId.toString())>=0&&t.authorized&&(t.projectSelected=!1),w=new i.marker("b2b_project",t),w.click(C),u.push(w),b.alvVisibleList.push(w));a.$broadcast("drawMarkers",{markers:u,type:"project",markersFitFlag:b.isBuilderCitySearchActive,refreshOnlyMarkers:f}),b.searchProjectId&&G(b.searchProjectId,function(a){})}};var K=function(c){b.removeNeighbourhood(null,"project",b._inactiveProjectNeighbourhood),a.$broadcast("showNeighbourhood",c),a.$broadcast("showProjectMarkers",!0)};!function(){a.$broadcast("showMapFilter",!1),b.requestType="locality",b.markerSettings=q.markerSettings}()}])});